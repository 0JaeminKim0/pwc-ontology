var ka=Object.defineProperty;var rr=e=>{throw TypeError(e)};var Ma=(e,t,r)=>t in e?ka(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var w=(e,t,r)=>Ma(e,typeof t!="symbol"?t+"":t,r),Et=(e,t,r)=>t.has(e)||rr("Cannot "+r);var u=(e,t,r)=>(Et(e,t,"read from private field"),r?r.call(e):t.get(e)),b=(e,t,r)=>t.has(e)?rr("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),x=(e,t,r,a)=>(Et(e,t,"write to private field"),a?a.call(e,r):t.set(e,r),r),S=(e,t,r)=>(Et(e,t,"access private method"),r);var ar=(e,t,r,a)=>({set _(s){x(e,t,s,r)},get _(){return u(e,t,a)}});import{existsSync as Wt,readFileSync as Gt,lstatSync as Oa,createReadStream as sr}from"fs";import{join as He}from"path";import{createServer as ja}from"http";import{Http2ServerRequest as ot}from"http2";import{Readable as nr}from"stream";import $a from"crypto";var Lr={Stringify:1},L=(e,t)=>{const r=new String(e);return r.isEscaped=!0,r.callbacks=t,r},Da=/[&<>'"]/,zr=async(e,t)=>{let r="";t||(t=[]);const a=await Promise.all(e);for(let s=a.length-1;r+=a[s],s--,!(s<0);s--){let n=a[s];typeof n=="object"&&t.push(...n.callbacks||[]);const i=n.isEscaped;if(n=await(typeof n=="object"?n.toString():n),typeof n=="object"&&t.push(...n.callbacks||[]),n.isEscaped??i)r+=n;else{const l=[r];ie(n,l),r=l[0]}}return L(r,t)},ie=(e,t)=>{const r=e.search(Da);if(r===-1){t[0]+=e;return}let a,s,n=0;for(s=r;s<e.length;s++){switch(e.charCodeAt(s)){case 34:a="&quot;";break;case 39:a="&#39;";break;case 38:a="&amp;";break;case 60:a="&lt;";break;case 62:a="&gt;";break;default:continue}t[0]+=e.substring(n,s)+a,n=s+1}t[0]+=e.substring(n,s)},Hr=e=>{const t=e.callbacks;if(!(t!=null&&t.length))return e;const r=[e],a={};return t.forEach(s=>s({phase:Lr.Stringify,buffer:r,context:a})),r[0]},qr=async(e,t,r,a,s)=>{typeof e=="object"&&!(e instanceof String)&&(e instanceof Promise||(e=e.toString()),e instanceof Promise&&(e=await e));const n=e.callbacks;return n!=null&&n.length?(s?s[0]+=e:s=[e],Promise.all(n.map(l=>l({phase:t,buffer:s,context:a}))).then(l=>Promise.all(l.filter(Boolean).map(o=>qr(o,t,!1,a,s))).then(()=>s[0]))):Promise.resolve(e)},Na=(e,...t)=>{const r=[""];for(let a=0,s=e.length-1;a<s;a++){r[0]+=e[a];const n=Array.isArray(t[a])?t[a].flat(1/0):[t[a]];for(let i=0,l=n.length;i<l;i++){const o=n[i];if(typeof o=="string")ie(o,r);else if(typeof o=="number")r[0]+=o;else{if(typeof o=="boolean"||o===null||o===void 0)continue;if(typeof o=="object"&&o.isEscaped)if(o.callbacks)r.unshift("",o);else{const c=o.toString();c instanceof Promise?r.unshift("",c):r[0]+=c}else o instanceof Promise?r.unshift("",o):ie(o.toString(),r)}}}return r[0]+=e.at(-1),r.length===1?"callbacks"in r?L(Hr(L(r[0],r.callbacks))):L(r[0]):zr(r,r.callbacks)},Kt=Symbol("RENDERER"),_t=Symbol("ERROR_HANDLER"),I=Symbol("STASH"),Fr=Symbol("INTERNAL"),_a=Symbol("MEMO"),mt=Symbol("PERMALINK"),ir=e=>(e[Fr]=!0,e),Ur=e=>({value:t,children:r})=>{if(!r)return;const a={children:[{tag:ir(()=>{e.push(t)}),props:{}}]};Array.isArray(r)?a.children.push(...r.flat()):a.children.push(r),a.children.push({tag:ir(()=>{e.pop()}),props:{}});const s={tag:"",props:a,type:""};return s[_t]=n=>{throw e.pop(),n},s},Br=e=>{const t=[e],r=Ur(t);return r.values=t,r.Provider=r,ke.push(r),r},ke=[],Vt=e=>{const t=[e],r=a=>{t.push(a.value);let s;try{s=a.children?(Array.isArray(a.children)?new Vr("",{},a.children):a.children).toString():""}finally{t.pop()}return s instanceof Promise?s.then(n=>L(n,n.callbacks)):L(s)};return r.values=t,r.Provider=r,r[Kt]=Ur(t),ke.push(r),r},$e=e=>e.values.at(-1),lt={title:[],script:["src"],style:["data-href"],link:["href"],meta:["name","httpEquiv","charset","itemProp"]},Lt={},ct="data-precedence",Je=e=>Array.isArray(e)?e:[e],or=new WeakMap,lr=(e,t,r,a)=>({buffer:s,context:n})=>{if(!s)return;const i=or.get(n)||{};or.set(n,i);const l=i[e]||(i[e]=[]);let o=!1;const c=lt[e];if(c.length>0){e:for(const[,d]of l)for(const h of c)if(((d==null?void 0:d[h])??null)===(r==null?void 0:r[h])){o=!0;break e}}if(o?s[0]=s[0].replaceAll(t,""):c.length>0?l.push([t,r,a]):l.unshift([t,r,a]),s[0].indexOf("</head>")!==-1){let d;if(a===void 0)d=l.map(([h])=>h);else{const h=[];d=l.map(([f,,g])=>{let m=h.indexOf(g);return m===-1&&(h.push(g),m=h.length-1),[f,m]}).sort((f,g)=>f[1]-g[1]).map(([f])=>f)}d.forEach(h=>{s[0]=s[0].replaceAll(h,"")}),s[0]=s[0].replace(/(?=<\/head>)/,d.join(""))}},Qe=(e,t,r)=>L(new F(e,r,Je(t??[])).toString()),et=(e,t,r,a)=>{if("itemProp"in r)return Qe(e,t,r);let{precedence:s,blocking:n,...i}=r;s=a?s??"":void 0,a&&(i[ct]=s);const l=new F(e,i,Je(t||[])).toString();return l instanceof Promise?l.then(o=>L(l,[...o.callbacks||[],lr(e,o,i,s)])):L(l,[lr(e,l,i,s)])},La=({children:e,...t})=>{const r=Xt();if(r){const a=$e(r);if(a==="svg"||a==="head")return new F("title",t,Je(e??[]))}return et("title",e,t,!1)},za=({children:e,...t})=>{const r=Xt();return["src","async"].some(a=>!t[a])||r&&$e(r)==="head"?Qe("script",e,t):et("script",e,t,!1)},Ha=({children:e,...t})=>["href","precedence"].every(r=>r in t)?(t["data-href"]=t.href,delete t.href,et("style",e,t,!0)):Qe("style",e,t),qa=({children:e,...t})=>["onLoad","onError"].some(r=>r in t)||t.rel==="stylesheet"&&(!("precedence"in t)||"disabled"in t)?Qe("link",e,t):et("link",e,t,"precedence"in t),Fa=({children:e,...t})=>{const r=Xt();return r&&$e(r)==="head"?Qe("meta",e,t):et("meta",e,t,!1)},Wr=(e,{children:t,...r})=>new F(e,r,Je(t??[])),Ua=e=>(typeof e.action=="function"&&(e.action=mt in e.action?e.action[mt]:void 0),Wr("form",e)),Gr=(e,t)=>(typeof t.formAction=="function"&&(t.formAction=mt in t.formAction?t.formAction[mt]:void 0),Wr(e,t)),Ba=e=>Gr("input",e),Wa=e=>Gr("button",e);const St=Object.freeze(Object.defineProperty({__proto__:null,button:Wa,form:Ua,input:Ba,link:qa,meta:Fa,script:za,style:Ha,title:La},Symbol.toStringTag,{value:"Module"}));var Ga=new Map([["className","class"],["htmlFor","for"],["crossOrigin","crossorigin"],["httpEquiv","http-equiv"],["itemProp","itemprop"],["fetchPriority","fetchpriority"],["noModule","nomodule"],["formAction","formaction"]]),vt=e=>Ga.get(e)||e,Kr=(e,t)=>{for(const[r,a]of Object.entries(e)){const s=r[0]==="-"||!/[A-Z]/.test(r)?r:r.replace(/[A-Z]/g,n=>`-${n.toLowerCase()}`);t(s,a==null?null:typeof a=="number"?s.match(/^(?:a|border-im|column(?:-c|s)|flex(?:$|-[^b])|grid-(?:ar|[^a])|font-w|li|or|sca|st|ta|wido|z)|ty$/)?`${a}`:`${a}px`:a)}},qe=void 0,Xt=()=>qe,Ka=e=>/[A-Z]/.test(e)&&e.match(/^(?:al|basel|clip(?:Path|Rule)$|co|do|fill|fl|fo|gl|let|lig|i|marker[EMS]|o|pai|pointe|sh|st[or]|text[^L]|tr|u|ve|w)/)?e.replace(/([A-Z])/g,"-$1").toLowerCase():e,Va=["area","base","br","col","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],Xa=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","defer","disabled","download","formnovalidate","hidden","inert","ismap","itemscope","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"],Yt=(e,t)=>{for(let r=0,a=e.length;r<a;r++){const s=e[r];if(typeof s=="string")ie(s,t);else{if(typeof s=="boolean"||s===null||s===void 0)continue;s instanceof F?s.toStringToBuffer(t):typeof s=="number"||s.isEscaped?t[0]+=s:s instanceof Promise?t.unshift("",s):Yt(s,t)}}},F=class{constructor(e,t,r){w(this,"tag");w(this,"props");w(this,"key");w(this,"children");w(this,"isEscaped",!0);w(this,"localContexts");this.tag=e,this.props=t,this.children=r}get type(){return this.tag}get ref(){return this.props.ref||null}toString(){var t,r;const e=[""];(t=this.localContexts)==null||t.forEach(([a,s])=>{a.values.push(s)});try{this.toStringToBuffer(e)}finally{(r=this.localContexts)==null||r.forEach(([a])=>{a.values.pop()})}return e.length===1?"callbacks"in e?Hr(L(e[0],e.callbacks)).toString():e[0]:zr(e,e.callbacks)}toStringToBuffer(e){const t=this.tag,r=this.props;let{children:a}=this;e[0]+=`<${t}`;const s=qe&&$e(qe)==="svg"?n=>Ka(vt(n)):n=>vt(n);for(let[n,i]of Object.entries(r))if(n=s(n),n!=="children"){if(n==="style"&&typeof i=="object"){let l="";Kr(i,(o,c)=>{c!=null&&(l+=`${l?";":""}${o}:${c}`)}),e[0]+=' style="',ie(l,e),e[0]+='"'}else if(typeof i=="string")e[0]+=` ${n}="`,ie(i,e),e[0]+='"';else if(i!=null)if(typeof i=="number"||i.isEscaped)e[0]+=` ${n}="${i}"`;else if(typeof i=="boolean"&&Xa.includes(n))i&&(e[0]+=` ${n}=""`);else if(n==="dangerouslySetInnerHTML"){if(a.length>0)throw new Error("Can only set one of `children` or `props.dangerouslySetInnerHTML`.");a=[L(i.__html)]}else if(i instanceof Promise)e[0]+=` ${n}="`,e.unshift('"',i);else if(typeof i=="function"){if(!n.startsWith("on")&&n!=="ref")throw new Error(`Invalid prop '${n}' of type 'function' supplied to '${t}'.`)}else e[0]+=` ${n}="`,ie(i.toString(),e),e[0]+='"'}if(Va.includes(t)&&a.length===0){e[0]+="/>";return}e[0]+=">",Yt(a,e),e[0]+=`</${t}>`}},Ct=class extends F{toStringToBuffer(e){const{children:t}=this,r=this.tag.call(null,{...this.props,children:t.length<=1?t[0]:t});if(!(typeof r=="boolean"||r==null))if(r instanceof Promise)if(ke.length===0)e.unshift("",r);else{const a=ke.map(s=>[s,s.values.at(-1)]);e.unshift("",r.then(s=>(s instanceof F&&(s.localContexts=a),s)))}else r instanceof F?r.toStringToBuffer(e):typeof r=="number"||r.isEscaped?(e[0]+=r,r.callbacks&&(e.callbacks||(e.callbacks=[]),e.callbacks.push(...r.callbacks))):ie(r,e)}},Vr=class extends F{toStringToBuffer(e){Yt(this.children,e)}},cr=(e,t,...r)=>{t??(t={}),r.length&&(t.children=r.length===1?r[0]:r);const a=t.key;delete t.key;const s=dt(e,t,r);return s.key=a,s},dr=!1,dt=(e,t,r)=>{if(!dr){for(const a in Lt)St[a][Kt]=Lt[a];dr=!0}return typeof e=="function"?new Ct(e,t,r):St[e]?new Ct(St[e],t,r):e==="svg"||e==="head"?(qe||(qe=Vt("")),new F(e,t,[new Ct(qe,{value:e},r)])):new F(e,t,r)},Ya=({children:e})=>new Vr("",{children:e},Array.isArray(e)?e:e?[e]:[]);function M(e,t,r){let a;if(!t||!("children"in t))a=dt(e,t,[]);else{const s=t.children;a=Array.isArray(s)?dt(e,t,s):dt(e,t,[s])}return a.key=r,a}var fr=(e,t,r)=>(a,s)=>{let n=-1;return i(0);async function i(l){if(l<=n)throw new Error("next() called multiple times");n=l;let o,c=!1,d;if(e[l]?(d=e[l][0][0],a.req.routeIndex=l):d=l===e.length&&s||void 0,d)try{o=await d(a,()=>i(l+1))}catch(h){if(h instanceof Error&&t)a.error=h,o=await t(h,a),c=!0;else throw h}else a.finalized===!1&&r&&(o=await r(a));return o&&(a.finalized===!1||c)&&(a.res=o),a}},Za=Symbol(),Ja=async(e,t=Object.create(null))=>{const{all:r=!1,dot:a=!1}=t,n=(e instanceof ea?e.raw.headers:e.headers).get("Content-Type");return n!=null&&n.startsWith("multipart/form-data")||n!=null&&n.startsWith("application/x-www-form-urlencoded")?Qa(e,{all:r,dot:a}):{}};async function Qa(e,t){const r=await e.formData();return r?es(r,t):{}}function es(e,t){const r=Object.create(null);return e.forEach((a,s)=>{t.all||s.endsWith("[]")?ts(r,s,a):r[s]=a}),t.dot&&Object.entries(r).forEach(([a,s])=>{a.includes(".")&&(rs(r,a,s),delete r[a])}),r}var ts=(e,t,r)=>{e[t]!==void 0?Array.isArray(e[t])?e[t].push(r):e[t]=[e[t],r]:t.endsWith("[]")?e[t]=[r]:e[t]=r},rs=(e,t,r)=>{let a=e;const s=t.split(".");s.forEach((n,i)=>{i===s.length-1?a[n]=r:((!a[n]||typeof a[n]!="object"||Array.isArray(a[n])||a[n]instanceof File)&&(a[n]=Object.create(null)),a=a[n])})},Xr=e=>{const t=e.split("/");return t[0]===""&&t.shift(),t},as=e=>{const{groups:t,path:r}=ss(e),a=Xr(r);return ns(a,t)},ss=e=>{const t=[];return e=e.replace(/\{[^}]+\}/g,(r,a)=>{const s=`@${a}`;return t.push([s,r]),s}),{groups:t,path:e}},ns=(e,t)=>{for(let r=t.length-1;r>=0;r--){const[a]=t[r];for(let s=e.length-1;s>=0;s--)if(e[s].includes(a)){e[s]=e[s].replace(a,t[r][1]);break}}return e},st={},is=(e,t)=>{if(e==="*")return"*";const r=e.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/);if(r){const a=`${e}#${t}`;return st[a]||(r[2]?st[a]=t&&t[0]!==":"&&t[0]!=="*"?[a,r[1],new RegExp(`^${r[2]}(?=/${t})`)]:[e,r[1],new RegExp(`^${r[2]}$`)]:st[a]=[e,r[1],!0]),st[a]}return null},Zt=(e,t)=>{try{return t(e)}catch{return e.replace(/(?:%[0-9A-Fa-f]{2})+/g,r=>{try{return t(r)}catch{return r}})}},os=e=>Zt(e,decodeURI),Yr=e=>{const t=e.url,r=t.indexOf("/",t.indexOf(":")+4);let a=r;for(;a<t.length;a++){const s=t.charCodeAt(a);if(s===37){const n=t.indexOf("?",a),i=t.slice(r,n===-1?void 0:n);return os(i.includes("%25")?i.replace(/%25/g,"%2525"):i)}else if(s===63)break}return t.slice(r,a)},ls=e=>{const t=Yr(e);return t.length>1&&t.at(-1)==="/"?t.slice(0,-1):t},xe=(e,t,...r)=>(r.length&&(t=xe(t,...r)),`${(e==null?void 0:e[0])==="/"?"":"/"}${e}${t==="/"?"":`${(e==null?void 0:e.at(-1))==="/"?"":"/"}${(t==null?void 0:t[0])==="/"?t.slice(1):t}`}`),Zr=e=>{if(e.charCodeAt(e.length-1)!==63||!e.includes(":"))return null;const t=e.split("/"),r=[];let a="";return t.forEach(s=>{if(s!==""&&!/\:/.test(s))a+="/"+s;else if(/\:/.test(s))if(/\?/.test(s)){r.length===0&&a===""?r.push("/"):r.push(a);const n=s.replace("?","");a+="/"+n,r.push(a)}else a+="/"+s}),r.filter((s,n,i)=>i.indexOf(s)===n)},Pt=e=>/[%+]/.test(e)?(e.indexOf("+")!==-1&&(e=e.replace(/\+/g," ")),e.indexOf("%")!==-1?Zt(e,Qr):e):e,Jr=(e,t,r)=>{let a;if(!r&&t&&!/[%+]/.test(t)){let i=e.indexOf(`?${t}`,8);for(i===-1&&(i=e.indexOf(`&${t}`,8));i!==-1;){const l=e.charCodeAt(i+t.length+1);if(l===61){const o=i+t.length+2,c=e.indexOf("&",o);return Pt(e.slice(o,c===-1?void 0:c))}else if(l==38||isNaN(l))return"";i=e.indexOf(`&${t}`,i+1)}if(a=/[%+]/.test(e),!a)return}const s={};a??(a=/[%+]/.test(e));let n=e.indexOf("?",8);for(;n!==-1;){const i=e.indexOf("&",n+1);let l=e.indexOf("=",n);l>i&&i!==-1&&(l=-1);let o=e.slice(n+1,l===-1?i===-1?void 0:i:l);if(a&&(o=Pt(o)),n=i,o==="")continue;let c;l===-1?c="":(c=e.slice(l+1,i===-1?void 0:i),a&&(c=Pt(c))),r?(s[o]&&Array.isArray(s[o])||(s[o]=[]),s[o].push(c)):s[o]??(s[o]=c)}return t?s[t]:s},cs=Jr,ds=(e,t)=>Jr(e,t,!0),Qr=decodeURIComponent,ur=e=>Zt(e,Qr),Ee,_,Z,ta,ra,zt,ee,Tr,ea=(Tr=class{constructor(e,t="/",r=[[]]){b(this,Z);w(this,"raw");b(this,Ee);b(this,_);w(this,"routeIndex",0);w(this,"path");w(this,"bodyCache",{});b(this,ee,e=>{const{bodyCache:t,raw:r}=this,a=t[e];if(a)return a;const s=Object.keys(t)[0];return s?t[s].then(n=>(s==="json"&&(n=JSON.stringify(n)),new Response(n)[e]())):t[e]=r[e]()});this.raw=e,this.path=t,x(this,_,r),x(this,Ee,{})}param(e){return e?S(this,Z,ta).call(this,e):S(this,Z,ra).call(this)}query(e){return cs(this.url,e)}queries(e){return ds(this.url,e)}header(e){if(e)return this.raw.headers.get(e)??void 0;const t={};return this.raw.headers.forEach((r,a)=>{t[a]=r}),t}async parseBody(e){var t;return(t=this.bodyCache).parsedBody??(t.parsedBody=await Ja(this,e))}json(){return u(this,ee).call(this,"text").then(e=>JSON.parse(e))}text(){return u(this,ee).call(this,"text")}arrayBuffer(){return u(this,ee).call(this,"arrayBuffer")}blob(){return u(this,ee).call(this,"blob")}formData(){return u(this,ee).call(this,"formData")}addValidatedData(e,t){u(this,Ee)[e]=t}valid(e){return u(this,Ee)[e]}get url(){return this.raw.url}get method(){return this.raw.method}get[Za](){return u(this,_)}get matchedRoutes(){return u(this,_)[0].map(([[,e]])=>e)}get routePath(){return u(this,_)[0].map(([[,e]])=>e)[this.routeIndex].path}},Ee=new WeakMap,_=new WeakMap,Z=new WeakSet,ta=function(e){const t=u(this,_)[0][this.routeIndex][1][e],r=S(this,Z,zt).call(this,t);return r?/\%/.test(r)?ur(r):r:void 0},ra=function(){const e={},t=Object.keys(u(this,_)[0][this.routeIndex][1]);for(const r of t){const a=S(this,Z,zt).call(this,u(this,_)[0][this.routeIndex][1][r]);a&&typeof a=="string"&&(e[r]=/\%/.test(a)?ur(a):a)}return e},zt=function(e){return u(this,_)[1]?u(this,_)[1][e]:e},ee=new WeakMap,Tr),fs="text/plain; charset=UTF-8",It=(e,t)=>({"Content-Type":e,...t}),We,Ge,G,Se,K,D,Ke,Ce,Pe,he,Ve,Xe,te,be,kr,us=(kr=class{constructor(e,t){b(this,te);b(this,We);b(this,Ge);w(this,"env",{});b(this,G);w(this,"finalized",!1);w(this,"error");b(this,Se);b(this,K);b(this,D);b(this,Ke);b(this,Ce);b(this,Pe);b(this,he);b(this,Ve);b(this,Xe);w(this,"render",(...e)=>(u(this,Ce)??x(this,Ce,t=>this.html(t)),u(this,Ce).call(this,...e)));w(this,"setLayout",e=>x(this,Ke,e));w(this,"getLayout",()=>u(this,Ke));w(this,"setRenderer",e=>{x(this,Ce,e)});w(this,"header",(e,t,r)=>{this.finalized&&x(this,D,new Response(u(this,D).body,u(this,D)));const a=u(this,D)?u(this,D).headers:u(this,he)??x(this,he,new Headers);t===void 0?a.delete(e):r!=null&&r.append?a.append(e,t):a.set(e,t)});w(this,"status",e=>{x(this,Se,e)});w(this,"set",(e,t)=>{u(this,G)??x(this,G,new Map),u(this,G).set(e,t)});w(this,"get",e=>u(this,G)?u(this,G).get(e):void 0);w(this,"newResponse",(...e)=>S(this,te,be).call(this,...e));w(this,"body",(e,t,r)=>S(this,te,be).call(this,e,t,r));w(this,"text",(e,t,r)=>!u(this,he)&&!u(this,Se)&&!t&&!r&&!this.finalized?new Response(e):S(this,te,be).call(this,e,t,It(fs,r)));w(this,"json",(e,t,r)=>S(this,te,be).call(this,JSON.stringify(e),t,It("application/json",r)));w(this,"html",(e,t,r)=>{const a=s=>S(this,te,be).call(this,s,t,It("text/html; charset=UTF-8",r));return typeof e=="object"?qr(e,Lr.Stringify,!1,{}).then(a):a(e)});w(this,"redirect",(e,t)=>{const r=String(e);return this.header("Location",/[^\x00-\xFF]/.test(r)?encodeURI(r):r),this.newResponse(null,t??302)});w(this,"notFound",()=>(u(this,Pe)??x(this,Pe,()=>new Response),u(this,Pe).call(this,this)));x(this,We,e),t&&(x(this,K,t.executionCtx),this.env=t.env,x(this,Pe,t.notFoundHandler),x(this,Xe,t.path),x(this,Ve,t.matchResult))}get req(){return u(this,Ge)??x(this,Ge,new ea(u(this,We),u(this,Xe),u(this,Ve))),u(this,Ge)}get event(){if(u(this,K)&&"respondWith"in u(this,K))return u(this,K);throw Error("This context has no FetchEvent")}get executionCtx(){if(u(this,K))return u(this,K);throw Error("This context has no ExecutionContext")}get res(){return u(this,D)||x(this,D,new Response(null,{headers:u(this,he)??x(this,he,new Headers)}))}set res(e){if(u(this,D)&&e){e=new Response(e.body,e);for(const[t,r]of u(this,D).headers.entries())if(t!=="content-type")if(t==="set-cookie"){const a=u(this,D).headers.getSetCookie();e.headers.delete("set-cookie");for(const s of a)e.headers.append("set-cookie",s)}else e.headers.set(t,r)}x(this,D,e),this.finalized=!0}get var(){return u(this,G)?Object.fromEntries(u(this,G)):{}}},We=new WeakMap,Ge=new WeakMap,G=new WeakMap,Se=new WeakMap,K=new WeakMap,D=new WeakMap,Ke=new WeakMap,Ce=new WeakMap,Pe=new WeakMap,he=new WeakMap,Ve=new WeakMap,Xe=new WeakMap,te=new WeakSet,be=function(e,t,r){const a=u(this,D)?new Headers(u(this,D).headers):u(this,he)??new Headers;if(typeof t=="object"&&"headers"in t){const n=t.headers instanceof Headers?t.headers:new Headers(t.headers);for(const[i,l]of n)i.toLowerCase()==="set-cookie"?a.append(i,l):a.set(i,l)}if(r)for(const[n,i]of Object.entries(r))if(typeof i=="string")a.set(n,i);else{a.delete(n);for(const l of i)a.append(n,l)}const s=typeof t=="number"?t:(t==null?void 0:t.status)??u(this,Se);return new Response(e,{status:s,headers:a})},kr),T="ALL",hs="all",ps=["get","post","put","delete","options","patch"],aa="Can not add a route since the matcher is already built.",sa=class extends Error{},gs="__COMPOSED_HANDLER",ys=e=>e.text("404 Not Found",404),hr=(e,t)=>{if("getResponse"in e){const r=e.getResponse();return t.newResponse(r.body,r)}return console.error(e),t.text("Internal Server Error",500)},z,k,ia,H,ce,ft,ut,Mr,na=(Mr=class{constructor(t={}){b(this,k);w(this,"get");w(this,"post");w(this,"put");w(this,"delete");w(this,"options");w(this,"patch");w(this,"all");w(this,"on");w(this,"use");w(this,"router");w(this,"getPath");w(this,"_basePath","/");b(this,z,"/");w(this,"routes",[]);b(this,H,ys);w(this,"errorHandler",hr);w(this,"onError",t=>(this.errorHandler=t,this));w(this,"notFound",t=>(x(this,H,t),this));w(this,"fetch",(t,...r)=>S(this,k,ut).call(this,t,r[1],r[0],t.method));w(this,"request",(t,r,a,s)=>t instanceof Request?this.fetch(r?new Request(t,r):t,a,s):(t=t.toString(),this.fetch(new Request(/^https?:\/\//.test(t)?t:`http://localhost${xe("/",t)}`,r),a,s)));w(this,"fire",()=>{addEventListener("fetch",t=>{t.respondWith(S(this,k,ut).call(this,t.request,t,void 0,t.request.method))})});[...ps,hs].forEach(n=>{this[n]=(i,...l)=>(typeof i=="string"?x(this,z,i):S(this,k,ce).call(this,n,u(this,z),i),l.forEach(o=>{S(this,k,ce).call(this,n,u(this,z),o)}),this)}),this.on=(n,i,...l)=>{for(const o of[i].flat()){x(this,z,o);for(const c of[n].flat())l.map(d=>{S(this,k,ce).call(this,c.toUpperCase(),u(this,z),d)})}return this},this.use=(n,...i)=>(typeof n=="string"?x(this,z,n):(x(this,z,"*"),i.unshift(n)),i.forEach(l=>{S(this,k,ce).call(this,T,u(this,z),l)}),this);const{strict:a,...s}=t;Object.assign(this,s),this.getPath=a??!0?t.getPath??Yr:ls}route(t,r){const a=this.basePath(t);return r.routes.map(s=>{var i;let n;r.errorHandler===hr?n=s.handler:(n=async(l,o)=>(await fr([],r.errorHandler)(l,()=>s.handler(l,o))).res,n[gs]=s.handler),S(i=a,k,ce).call(i,s.method,s.path,n)}),this}basePath(t){const r=S(this,k,ia).call(this);return r._basePath=xe(this._basePath,t),r}mount(t,r,a){let s,n;a&&(typeof a=="function"?n=a:(n=a.optionHandler,a.replaceRequest===!1?s=o=>o:s=a.replaceRequest));const i=n?o=>{const c=n(o);return Array.isArray(c)?c:[c]}:o=>{let c;try{c=o.executionCtx}catch{}return[o.env,c]};s||(s=(()=>{const o=xe(this._basePath,t),c=o==="/"?0:o.length;return d=>{const h=new URL(d.url);return h.pathname=h.pathname.slice(c)||"/",new Request(h,d)}})());const l=async(o,c)=>{const d=await r(s(o.req.raw),...i(o));if(d)return d;await c()};return S(this,k,ce).call(this,T,xe(t,"*"),l),this}},z=new WeakMap,k=new WeakSet,ia=function(){const t=new na({router:this.router,getPath:this.getPath});return t.errorHandler=this.errorHandler,x(t,H,u(this,H)),t.routes=this.routes,t},H=new WeakMap,ce=function(t,r,a){t=t.toUpperCase(),r=xe(this._basePath,r);const s={basePath:this._basePath,path:r,method:t,handler:a};this.router.add(t,r,[a,s]),this.routes.push(s)},ft=function(t,r){if(t instanceof Error)return this.errorHandler(t,r);throw t},ut=function(t,r,a,s){if(s==="HEAD")return(async()=>new Response(null,await S(this,k,ut).call(this,t,r,a,"GET")))();const n=this.getPath(t,{env:a}),i=this.router.match(s,n),l=new us(t,{path:n,matchResult:i,env:a,executionCtx:r,notFoundHandler:u(this,H)});if(i[0].length===1){let c;try{c=i[0][0][0][0](l,async()=>{l.res=await u(this,H).call(this,l)})}catch(d){return S(this,k,ft).call(this,d,l)}return c instanceof Promise?c.then(d=>d||(l.finalized?l.res:u(this,H).call(this,l))).catch(d=>S(this,k,ft).call(this,d,l)):c??u(this,H).call(this,l)}const o=fr(i[0],this.errorHandler,u(this,H));return(async()=>{try{const c=await o(l);if(!c.finalized)throw new Error("Context is not finalized. Did you forget to return a Response object or `await next()`?");return c.res}catch(c){return S(this,k,ft).call(this,c,l)}})()},Mr),wt="[^/]+",Le=".*",ze="(?:|/.*)",Ae=Symbol(),ms=new Set(".\\+*[^]$()");function vs(e,t){return e.length===1?t.length===1?e<t?-1:1:-1:t.length===1||e===Le||e===ze?1:t===Le||t===ze?-1:e===wt?1:t===wt?-1:e.length===t.length?e<t?-1:1:t.length-e.length}var pe,ge,q,Or,Ht=(Or=class{constructor(){b(this,pe);b(this,ge);b(this,q,Object.create(null))}insert(t,r,a,s,n){if(t.length===0){if(u(this,pe)!==void 0)throw Ae;if(n)return;x(this,pe,r);return}const[i,...l]=t,o=i==="*"?l.length===0?["","",Le]:["","",wt]:i==="/*"?["","",ze]:i.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/);let c;if(o){const d=o[1];let h=o[2]||wt;if(d&&o[2]&&(h===".*"||(h=h.replace(/^\((?!\?:)(?=[^)]+\)$)/,"(?:"),/\((?!\?:)/.test(h))))throw Ae;if(c=u(this,q)[h],!c){if(Object.keys(u(this,q)).some(f=>f!==Le&&f!==ze))throw Ae;if(n)return;c=u(this,q)[h]=new Ht,d!==""&&x(c,ge,s.varIndex++)}!n&&d!==""&&a.push([d,u(c,ge)])}else if(c=u(this,q)[i],!c){if(Object.keys(u(this,q)).some(d=>d.length>1&&d!==Le&&d!==ze))throw Ae;if(n)return;c=u(this,q)[i]=new Ht}c.insert(l,r,a,s,n)}buildRegExpStr(){const r=Object.keys(u(this,q)).sort(vs).map(a=>{const s=u(this,q)[a];return(typeof u(s,ge)=="number"?`(${a})@${u(s,ge)}`:ms.has(a)?`\\${a}`:a)+s.buildRegExpStr()});return typeof u(this,pe)=="number"&&r.unshift(`#${u(this,pe)}`),r.length===0?"":r.length===1?r[0]:"(?:"+r.join("|")+")"}},pe=new WeakMap,ge=new WeakMap,q=new WeakMap,Or),bt,Ye,jr,ws=(jr=class{constructor(){b(this,bt,{varIndex:0});b(this,Ye,new Ht)}insert(e,t,r){const a=[],s=[];for(let i=0;;){let l=!1;if(e=e.replace(/\{[^}]+\}/g,o=>{const c=`@\\${i}`;return s[i]=[c,o],i++,l=!0,c}),!l)break}const n=e.match(/(?::[^\/]+)|(?:\/\*$)|./g)||[];for(let i=s.length-1;i>=0;i--){const[l]=s[i];for(let o=n.length-1;o>=0;o--)if(n[o].indexOf(l)!==-1){n[o]=n[o].replace(l,s[i][1]);break}}return u(this,Ye).insert(n,t,a,u(this,bt),r),a}buildRegExp(){let e=u(this,Ye).buildRegExpStr();if(e==="")return[/^$/,[],[]];let t=0;const r=[],a=[];return e=e.replace(/#(\d+)|@(\d+)|\.\*\$/g,(s,n,i)=>n!==void 0?(r[++t]=Number(n),"$()"):(i!==void 0&&(a[Number(i)]=++t),"")),[new RegExp(`^${e}`),r,a]}},bt=new WeakMap,Ye=new WeakMap,jr),oa=[],xs=[/^$/,[],Object.create(null)],ht=Object.create(null);function la(e){return ht[e]??(ht[e]=new RegExp(e==="*"?"":`^${e.replace(/\/\*$|([.\\+*[^\]$()])/g,(t,r)=>r?`\\${r}`:"(?:|/.*)")}$`))}function bs(){ht=Object.create(null)}function As(e){var c;const t=new ws,r=[];if(e.length===0)return xs;const a=e.map(d=>[!/\*|\/:/.test(d[0]),...d]).sort(([d,h],[f,g])=>d?1:f?-1:h.length-g.length),s=Object.create(null);for(let d=0,h=-1,f=a.length;d<f;d++){const[g,m,y]=a[d];g?s[m]=[y.map(([v])=>[v,Object.create(null)]),oa]:h++;let p;try{p=t.insert(m,h,g)}catch(v){throw v===Ae?new sa(m):v}g||(r[h]=y.map(([v,A])=>{const E=Object.create(null);for(A-=1;A>=0;A--){const[R,C]=p[A];E[R]=C}return[v,E]}))}const[n,i,l]=t.buildRegExp();for(let d=0,h=r.length;d<h;d++)for(let f=0,g=r[d].length;f<g;f++){const m=(c=r[d][f])==null?void 0:c[1];if(!m)continue;const y=Object.keys(m);for(let p=0,v=y.length;p<v;p++)m[y[p]]=l[m[y[p]]]}const o=[];for(const d in i)o[d]=r[i[d]];return[n,o,s]}function ve(e,t){if(e){for(const r of Object.keys(e).sort((a,s)=>s.length-a.length))if(la(r).test(t))return[...e[r]]}}var re,ae,je,ca,da,$r,Rs=($r=class{constructor(){b(this,je);w(this,"name","RegExpRouter");b(this,re);b(this,ae);x(this,re,{[T]:Object.create(null)}),x(this,ae,{[T]:Object.create(null)})}add(e,t,r){var l;const a=u(this,re),s=u(this,ae);if(!a||!s)throw new Error(aa);a[e]||[a,s].forEach(o=>{o[e]=Object.create(null),Object.keys(o[T]).forEach(c=>{o[e][c]=[...o[T][c]]})}),t==="/*"&&(t="*");const n=(t.match(/\/:/g)||[]).length;if(/\*$/.test(t)){const o=la(t);e===T?Object.keys(a).forEach(c=>{var d;(d=a[c])[t]||(d[t]=ve(a[c],t)||ve(a[T],t)||[])}):(l=a[e])[t]||(l[t]=ve(a[e],t)||ve(a[T],t)||[]),Object.keys(a).forEach(c=>{(e===T||e===c)&&Object.keys(a[c]).forEach(d=>{o.test(d)&&a[c][d].push([r,n])})}),Object.keys(s).forEach(c=>{(e===T||e===c)&&Object.keys(s[c]).forEach(d=>o.test(d)&&s[c][d].push([r,n]))});return}const i=Zr(t)||[t];for(let o=0,c=i.length;o<c;o++){const d=i[o];Object.keys(s).forEach(h=>{var f;(e===T||e===h)&&((f=s[h])[d]||(f[d]=[...ve(a[h],d)||ve(a[T],d)||[]]),s[h][d].push([r,n-c+o+1]))})}}match(e,t){bs();const r=S(this,je,ca).call(this);return this.match=(a,s)=>{const n=r[a]||r[T],i=n[2][s];if(i)return i;const l=s.match(n[0]);if(!l)return[[],oa];const o=l.indexOf("",1);return[n[1][o],l]},this.match(e,t)}},re=new WeakMap,ae=new WeakMap,je=new WeakSet,ca=function(){const e=Object.create(null);return Object.keys(u(this,ae)).concat(Object.keys(u(this,re))).forEach(t=>{e[t]||(e[t]=S(this,je,da).call(this,t))}),x(this,re,x(this,ae,void 0)),e},da=function(e){const t=[];let r=e===T;return[u(this,re),u(this,ae)].forEach(a=>{const s=a[e]?Object.keys(a[e]).map(n=>[n,a[e][n]]):[];s.length!==0?(r||(r=!0),t.push(...s)):e!==T&&t.push(...Object.keys(a[T]).map(n=>[n,a[T][n]]))}),r?As(t):null},$r),se,V,Dr,Es=(Dr=class{constructor(e){w(this,"name","SmartRouter");b(this,se,[]);b(this,V,[]);x(this,se,e.routers)}add(e,t,r){if(!u(this,V))throw new Error(aa);u(this,V).push([e,t,r])}match(e,t){if(!u(this,V))throw new Error("Fatal error");const r=u(this,se),a=u(this,V),s=r.length;let n=0,i;for(;n<s;n++){const l=r[n];try{for(let o=0,c=a.length;o<c;o++)l.add(...a[o]);i=l.match(e,t)}catch(o){if(o instanceof sa)continue;throw o}this.match=l.match.bind(l),x(this,se,[l]),x(this,V,void 0);break}if(n===s)throw new Error("Fatal error");return this.name=`SmartRouter + ${this.activeRouter.name}`,i}get activeRouter(){if(u(this,V)||u(this,se).length!==1)throw new Error("No active router has been determined yet.");return u(this,se)[0]}},se=new WeakMap,V=new WeakMap,Dr),De=Object.create(null),ne,$,ye,Ie,j,X,de,Nr,fa=(Nr=class{constructor(e,t,r){b(this,X);b(this,ne);b(this,$);b(this,ye);b(this,Ie,0);b(this,j,De);if(x(this,$,r||Object.create(null)),x(this,ne,[]),e&&t){const a=Object.create(null);a[e]={handler:t,possibleKeys:[],score:0},x(this,ne,[a])}x(this,ye,[])}insert(e,t,r){x(this,Ie,++ar(this,Ie)._);let a=this;const s=as(t),n=[];for(let i=0,l=s.length;i<l;i++){const o=s[i],c=s[i+1],d=is(o,c),h=Array.isArray(d)?d[0]:o;if(h in u(a,$)){a=u(a,$)[h],d&&n.push(d[1]);continue}u(a,$)[h]=new fa,d&&(u(a,ye).push(d),n.push(d[1])),a=u(a,$)[h]}return u(a,ne).push({[e]:{handler:r,possibleKeys:n.filter((i,l,o)=>o.indexOf(i)===l),score:u(this,Ie)}}),a}search(e,t){var l;const r=[];x(this,j,De);let s=[this];const n=Xr(t),i=[];for(let o=0,c=n.length;o<c;o++){const d=n[o],h=o===c-1,f=[];for(let g=0,m=s.length;g<m;g++){const y=s[g],p=u(y,$)[d];p&&(x(p,j,u(y,j)),h?(u(p,$)["*"]&&r.push(...S(this,X,de).call(this,u(p,$)["*"],e,u(y,j))),r.push(...S(this,X,de).call(this,p,e,u(y,j)))):f.push(p));for(let v=0,A=u(y,ye).length;v<A;v++){const E=u(y,ye)[v],R=u(y,j)===De?{}:{...u(y,j)};if(E==="*"){const J=u(y,$)["*"];J&&(r.push(...S(this,X,de).call(this,J,e,u(y,j))),x(J,j,R),f.push(J));continue}const[C,U,le]=E;if(!d&&!(le instanceof RegExp))continue;const B=u(y,$)[C],Ta=n.slice(o).join("/");if(le instanceof RegExp){const J=le.exec(Ta);if(J){if(R[U]=J[0],r.push(...S(this,X,de).call(this,B,e,u(y,j),R)),Object.keys(u(B,$)).length){x(B,j,R);const Rt=((l=J[0].match(/\//))==null?void 0:l.length)??0;(i[Rt]||(i[Rt]=[])).push(B)}continue}}(le===!0||le.test(d))&&(R[U]=d,h?(r.push(...S(this,X,de).call(this,B,e,R,u(y,j))),u(B,$)["*"]&&r.push(...S(this,X,de).call(this,u(B,$)["*"],e,R,u(y,j)))):(x(B,j,R),f.push(B)))}}s=f.concat(i.shift()??[])}return r.length>1&&r.sort((o,c)=>o.score-c.score),[r.map(({handler:o,params:c})=>[o,c])]}},ne=new WeakMap,$=new WeakMap,ye=new WeakMap,Ie=new WeakMap,j=new WeakMap,X=new WeakSet,de=function(e,t,r,a){const s=[];for(let n=0,i=u(e,ne).length;n<i;n++){const l=u(e,ne)[n],o=l[t]||l[T],c={};if(o!==void 0&&(o.params=Object.create(null),s.push(o),r!==De||a&&a!==De))for(let d=0,h=o.possibleKeys.length;d<h;d++){const f=o.possibleKeys[d],g=c[o.score];o.params[f]=a!=null&&a[f]&&!g?a[f]:r[f]??(a==null?void 0:a[f]),c[o.score]=!0}}return s},Nr),me,_r,Ss=(_r=class{constructor(){w(this,"name","TrieRouter");b(this,me);x(this,me,new fa)}add(e,t,r){const a=Zr(t);if(a){for(let s=0,n=a.length;s<n;s++)u(this,me).insert(e,a[s],r);return}u(this,me).insert(e,t,r)}match(e,t){return u(this,me).search(e,t)}},me=new WeakMap,_r),ua=class extends na{constructor(e={}){super(e),this.router=e.router??new Es({routers:[new Rs,new Ss]})}},Cs=e=>{const r={...{origin:"*",allowMethods:["GET","HEAD","PUT","POST","DELETE","PATCH"],allowHeaders:[],exposeHeaders:[]},...e},a=(n=>typeof n=="string"?n==="*"?()=>n:i=>n===i?i:null:typeof n=="function"?n:i=>n.includes(i)?i:null)(r.origin),s=(n=>typeof n=="function"?n:Array.isArray(n)?()=>n:()=>[])(r.allowMethods);return async function(i,l){var d;function o(h,f){i.res.headers.set(h,f)}const c=await a(i.req.header("origin")||"",i);if(c&&o("Access-Control-Allow-Origin",c),r.origin!=="*"){const h=i.req.header("Vary");h?o("Vary",h):o("Vary","Origin")}if(r.credentials&&o("Access-Control-Allow-Credentials","true"),(d=r.exposeHeaders)!=null&&d.length&&o("Access-Control-Expose-Headers",r.exposeHeaders.join(",")),i.req.method==="OPTIONS"){r.maxAge!=null&&o("Access-Control-Max-Age",r.maxAge.toString());const h=await s(i.req.header("origin")||"",i);h.length&&o("Access-Control-Allow-Methods",h.join(","));let f=r.allowHeaders;if(!(f!=null&&f.length)){const g=i.req.header("Access-Control-Request-Headers");g&&(f=g.split(/\s*,\s*/))}return f!=null&&f.length&&(o("Access-Control-Allow-Headers",f.join(",")),i.res.headers.append("Vary","Access-Control-Request-Headers")),i.res.headers.delete("Content-Length"),i.res.headers.delete("Content-Type"),new Response(null,{headers:i.res.headers,status:204,statusText:"No Content"})}await l()}},Fe="_hp",Ps={Change:"Input",DoubleClick:"DblClick"},Is={svg:"2000/svg",math:"1998/Math/MathML"},Ue=[],qt=new WeakMap,Me=void 0,Ts=()=>Me,W=e=>"t"in e,Tt={onClick:["click",!1]},pr=e=>{if(!e.startsWith("on"))return;if(Tt[e])return Tt[e];const t=e.match(/^on([A-Z][a-zA-Z]+?(?:PointerCapture)?)(Capture)?$/);if(t){const[,r,a]=t;return Tt[e]=[(Ps[r]||r).toLowerCase(),!!a]}},gr=(e,t)=>Me&&e instanceof SVGElement&&/[A-Z]/.test(t)&&(t in e.style||t.match(/^(?:o|pai|str|u|ve)/))?t.replace(/([A-Z])/g,"-$1").toLowerCase():t,ks=(e,t,r)=>{var a;t||(t={});for(let s in t){const n=t[s];if(s!=="children"&&(!r||r[s]!==n)){s=vt(s);const i=pr(s);if(i){if((r==null?void 0:r[s])!==n&&(r&&e.removeEventListener(i[0],r[s],i[1]),n!=null)){if(typeof n!="function")throw new Error(`Event handler for "${s}" is not a function`);e.addEventListener(i[0],n,i[1])}}else if(s==="dangerouslySetInnerHTML"&&n)e.innerHTML=n.__html;else if(s==="ref"){let l;typeof n=="function"?l=n(e)||(()=>n(null)):n&&"current"in n&&(n.current=e,l=()=>n.current=null),qt.set(e,l)}else if(s==="style"){const l=e.style;typeof n=="string"?l.cssText=n:(l.cssText="",n!=null&&Kr(n,l.setProperty.bind(l)))}else{if(s==="value"){const o=e.nodeName;if(o==="INPUT"||o==="TEXTAREA"||o==="SELECT"){if(e.value=n==null||n===!1?null:n,o==="TEXTAREA"){e.textContent=n;continue}else if(o==="SELECT"){e.selectedIndex===-1&&(e.selectedIndex=0);continue}}}else(s==="checked"&&e.nodeName==="INPUT"||s==="selected"&&e.nodeName==="OPTION")&&(e[s]=n);const l=gr(e,s);n==null||n===!1?e.removeAttribute(l):n===!0?e.setAttribute(l,""):typeof n=="string"||typeof n=="number"?e.setAttribute(l,n):e.setAttribute(l,n.toString())}}}if(r)for(let s in r){const n=r[s];if(s!=="children"&&!(s in t)){s=vt(s);const i=pr(s);i?e.removeEventListener(i[0],n,i[1]):s==="ref"?(a=qt.get(e))==null||a():e.removeAttribute(gr(e,s))}}},Ms=(e,t)=>{t[I][0]=0,Ue.push([e,t]);const r=t.tag[Kt]||t.tag,a=r.defaultProps?{...r.defaultProps,...t.props}:t.props;try{return[r.call(null,a)]}finally{Ue.pop()}},ha=(e,t,r,a,s)=>{var n,i;(n=e.vR)!=null&&n.length&&(a.push(...e.vR),delete e.vR),typeof e.tag=="function"&&((i=e[I][1][ma])==null||i.forEach(l=>s.push(l))),e.vC.forEach(l=>{var o;if(W(l))r.push(l);else if(typeof l.tag=="function"||l.tag===""){l.c=t;const c=r.length;if(ha(l,t,r,a,s),l.s){for(let d=c;d<r.length;d++)r[d].s=!0;l.s=!1}}else r.push(l),(o=l.vR)!=null&&o.length&&(a.push(...l.vR),delete l.vR)})},Os=e=>{for(;;e=e.tag===Fe||!e.vC||!e.pP?e.nN:e.vC[0]){if(!e)return null;if(e.tag!==Fe&&e.e)return e.e}},pa=e=>{var t,r,a,s,n,i;W(e)||((r=(t=e[I])==null?void 0:t[1][ma])==null||r.forEach(l=>{var o;return(o=l[2])==null?void 0:o.call(l)}),(a=qt.get(e.e))==null||a(),e.p===2&&((s=e.vC)==null||s.forEach(l=>l.p=2)),(n=e.vC)==null||n.forEach(pa)),e.p||((i=e.e)==null||i.remove(),delete e.e),typeof e.tag=="function"&&(_e.delete(e),pt.delete(e),delete e[I][3],e.a=!0)},ga=(e,t,r)=>{e.c=t,ya(e,t,r)},yr=(e,t)=>{if(t){for(let r=0,a=e.length;r<a;r++)if(e[r]===t)return r}},mr=Symbol(),ya=(e,t,r)=>{var c;const a=[],s=[],n=[];ha(e,t,a,s,n),s.forEach(pa);const i=r?void 0:t.childNodes;let l,o=null;if(r)l=-1;else if(!i.length)l=0;else{const d=yr(i,Os(e.nN));d!==void 0?(o=i[d],l=d):l=yr(i,(c=a.find(h=>h.tag!==Fe&&h.e))==null?void 0:c.e)??-1,l===-1&&(r=!0)}for(let d=0,h=a.length;d<h;d++,l++){const f=a[d];let g;if(f.s&&f.e)g=f.e,f.s=!1;else{const m=r||!f.e;W(f)?(f.e&&f.d&&(f.e.textContent=f.t),f.d=!1,g=f.e||(f.e=document.createTextNode(f.t))):(g=f.e||(f.e=f.n?document.createElementNS(f.n,f.tag):document.createElement(f.tag)),ks(g,f.props,f.pP),ya(f,g,m))}f.tag===Fe?l--:r?g.parentNode||t.appendChild(g):i[l]!==g&&i[l-1]!==g&&(i[l+1]===g?t.appendChild(i[l]):t.insertBefore(g,o||i[l]||null))}if(e.pP&&delete e.pP,n.length){const d=[],h=[];n.forEach(([,f,,g,m])=>{f&&d.push(f),g&&h.push(g),m==null||m()}),d.forEach(f=>f()),h.length&&requestAnimationFrame(()=>{h.forEach(f=>f())})}},js=(e,t)=>!!(e&&e.length===t.length&&e.every((r,a)=>r[1]===t[a][1])),pt=new WeakMap,Ft=(e,t,r)=>{var n,i,l,o,c,d;const a=!r&&t.pC;r&&(t.pC||(t.pC=t.vC));let s;try{r||(r=typeof t.tag=="function"?Ms(e,t):Je(t.props.children)),((n=r[0])==null?void 0:n.tag)===""&&r[0][_t]&&(s=r[0][_t],e[5].push([e,s,t]));const h=a?[...t.pC]:t.vC?[...t.vC]:void 0,f=[];let g;for(let m=0;m<r.length;m++){Array.isArray(r[m])&&r.splice(m,1,...r[m].flat());let y=$s(r[m]);if(y){typeof y.tag=="function"&&!y.tag[Fr]&&(ke.length>0&&(y[I][2]=ke.map(v=>[v,v.values.at(-1)])),(i=e[5])!=null&&i.length&&(y[I][3]=e[5].at(-1)));let p;if(h&&h.length){const v=h.findIndex(W(y)?A=>W(A):y.key!==void 0?A=>A.key===y.key&&A.tag===y.tag:A=>A.tag===y.tag);v!==-1&&(p=h[v],h.splice(v,1))}if(p)if(W(y))p.t!==y.t&&(p.t=y.t,p.d=!0),y=p;else{const v=p.pP=p.props;if(p.props=y.props,p.f||(p.f=y.f||t.f),typeof y.tag=="function"){const A=p[I][2];p[I][2]=y[I][2]||[],p[I][3]=y[I][3],!p.f&&((p.o||p)===y.o||(o=(l=p.tag)[_a])!=null&&o.call(l,v,p.props))&&js(A,p[I][2])&&(p.s=!0)}y=p}else if(!W(y)&&Me){const v=$e(Me);v&&(y.n=v)}if(!W(y)&&!y.s&&(Ft(e,y),delete y.f),f.push(y),g&&!g.s&&!y.s)for(let v=g;v&&!W(v);v=(c=v.vC)==null?void 0:c.at(-1))v.nN=y;g=y}}t.vR=a?[...t.vC,...h||[]]:h||[],t.vC=f,a&&delete t.pC}catch(h){if(t.f=!0,h===mr){if(s)return;throw h}const[f,g,m]=((d=t[I])==null?void 0:d[3])||[];if(g){const y=()=>gt([0,!1,e[2]],m),p=pt.get(m)||[];p.push(y),pt.set(m,p);const v=g(h,()=>{const A=pt.get(m);if(A){const E=A.indexOf(y);if(E!==-1)return A.splice(E,1),y()}});if(v){if(e[0]===1)e[1]=!0;else if(Ft(e,m,[v]),(g.length===1||e!==f)&&m.c){ga(m,m.c,!1);return}throw mr}}throw h}finally{s&&e[5].pop()}},$s=e=>{if(!(e==null||typeof e=="boolean")){if(typeof e=="string"||typeof e=="number")return{t:e.toString(),d:!0};if("vR"in e&&(e={tag:e.tag,props:e.props,key:e.key,f:e.f,type:e.tag,ref:e.props.ref,o:e.o||e}),typeof e.tag=="function")e[I]=[0,[]];else{const t=Is[e.tag];t&&(Me||(Me=Br("")),e.props.children=[{tag:Me,props:{value:e.n=`http://www.w3.org/${t}`,children:e.props.children}}])}return e}},vr=(e,t)=>{var r,a;(r=t[I][2])==null||r.forEach(([s,n])=>{s.values.push(n)});try{Ft(e,t,void 0)}catch{return}if(t.a){delete t.a;return}(a=t[I][2])==null||a.forEach(([s])=>{s.values.pop()}),(e[0]!==1||!e[1])&&ga(t,t.c,!1)},_e=new WeakMap,wr=[],gt=async(e,t)=>{e[5]||(e[5]=[]);const r=_e.get(t);r&&r[0](void 0);let a;const s=new Promise(n=>a=n);if(_e.set(t,[a,()=>{e[2]?e[2](e,t,n=>{vr(n,t)}).then(()=>a(t)):(vr(e,t),a(t))}]),wr.length)wr.at(-1).add(t);else{await Promise.resolve();const n=_e.get(t);n&&(_e.delete(t),n[1]())}return s},Ds=(e,t,r)=>({tag:Fe,props:{children:e},key:r,e:t,p:1}),kt=0,ma=1,Mt=2,Ot=3,jt=new WeakMap,va=(e,t)=>!e||!t||e.length!==t.length||t.some((r,a)=>r!==e[a]),Ns=void 0,xr=[],_s=e=>{var i;const t=()=>typeof e=="function"?e():e,r=Ue.at(-1);if(!r)return[t(),()=>{}];const[,a]=r,s=(i=a[I][1])[kt]||(i[kt]=[]),n=a[I][0]++;return s[n]||(s[n]=[t(),l=>{const o=Ns,c=s[n];if(typeof l=="function"&&(l=l(c[0])),!Object.is(l,c[0]))if(c[0]=l,xr.length){const[d,h]=xr.at(-1);Promise.all([d===3?a:gt([d,!1,o],a),h]).then(([f])=>{if(!f||!(d===2||d===3))return;const g=f.vC;requestAnimationFrame(()=>{setTimeout(()=>{g===f.vC&&gt([d===3?1:0,!1,o],f)})})})}else gt([0,!1,o],a)}])},Jt=(e,t)=>{var l;const r=Ue.at(-1);if(!r)return e;const[,a]=r,s=(l=a[I][1])[Mt]||(l[Mt]=[]),n=a[I][0]++,i=s[n];return va(i==null?void 0:i[1],t)?s[n]=[e,t]:e=s[n][0],e},Ls=e=>{const t=jt.get(e);if(t){if(t.length===2)throw t[1];return t[0]}throw e.then(r=>jt.set(e,[r]),r=>jt.set(e,[void 0,r])),e},zs=(e,t)=>{var l;const r=Ue.at(-1);if(!r)return e();const[,a]=r,s=(l=a[I][1])[Ot]||(l[Ot]=[]),n=a[I][0]++,i=s[n];return va(i==null?void 0:i[1],t)&&(s[n]=[e(),t]),s[n][0]},Hs=Br({pending:!1,data:null,method:null,action:null}),br=new Set,qs=e=>{br.add(e),e.finally(()=>br.delete(e))},Qt=(e,t)=>zs(()=>r=>{let a;e&&(typeof e=="function"?a=e(r)||(()=>{e(null)}):e&&"current"in e&&(e.current=r,a=()=>{e.current=null}));const s=t(r);return()=>{s==null||s(),a==null||a()}},[e]),we=Object.create(null),nt=Object.create(null),tt=(e,t,r,a,s)=>{if(t!=null&&t.itemProp)return{tag:e,props:t,type:e,ref:t.ref};const n=document.head;let{onLoad:i,onError:l,precedence:o,blocking:c,...d}=t,h=null,f=!1;const g=lt[e];let m;if(g.length>0){const A=n.querySelectorAll(e);e:for(const E of A)for(const R of lt[e])if(E.getAttribute(R)===t[R]){h=E;break e}if(!h){const E=g.reduce((R,C)=>t[C]===void 0?R:`${R}-${C}-${t[C]}`,e);f=!nt[E],h=nt[E]||(nt[E]=(()=>{const R=document.createElement(e);for(const C of g)t[C]!==void 0&&R.setAttribute(C,t[C]),t.rel&&R.setAttribute("rel",t.rel);return R})())}}else m=n.querySelectorAll(e);o=a?o??"":void 0,a&&(d[ct]=o);const y=Jt(A=>{if(g.length>0){let E=!1;for(const R of n.querySelectorAll(e)){if(E&&R.getAttribute(ct)!==o){n.insertBefore(A,R);return}R.getAttribute(ct)===o&&(E=!0)}n.appendChild(A)}else if(m){let E=!1;for(const R of m)if(R===A){E=!0;break}E||n.insertBefore(A,n.contains(m[0])?m[0]:n.querySelector(e)),m=void 0}},[o]),p=Qt(t.ref,A=>{var C;const E=g[0];if(r===2&&(A.innerHTML=""),(f||m)&&y(A),!l&&!i)return;let R=we[C=A.getAttribute(E)]||(we[C]=new Promise((U,le)=>{A.addEventListener("load",U),A.addEventListener("error",le)}));i&&(R=R.then(i)),l&&(R=R.catch(l)),R.catch(()=>{})});if(s&&c==="render"){const A=lt[e][0];if(t[A]){const E=t[A],R=we[E]||(we[E]=new Promise((C,U)=>{y(h),h.addEventListener("load",C),h.addEventListener("error",U)}));Ls(R)}}const v={tag:e,type:e,props:{...d,ref:p},ref:p};return v.p=r,h&&(v.e=h),Ds(v,n)},Fs=e=>{const t=Ts(),r=t&&$e(t);return r!=null&&r.endsWith("svg")?{tag:"title",props:e,type:"title",ref:e.ref}:tt("title",e,void 0,!1,!1)},Us=e=>!e||["src","async"].some(t=>!e[t])?{tag:"script",props:e,type:"script",ref:e.ref}:tt("script",e,1,!1,!0),Bs=e=>!e||!["href","precedence"].every(t=>t in e)?{tag:"style",props:e,type:"style",ref:e.ref}:(e["data-href"]=e.href,delete e.href,tt("style",e,2,!0,!0)),Ws=e=>!e||["onLoad","onError"].some(t=>t in e)||e.rel==="stylesheet"&&(!("precedence"in e)||"disabled"in e)?{tag:"link",props:e,type:"link",ref:e.ref}:tt("link",e,1,"precedence"in e,!0),Gs=e=>tt("meta",e,void 0,!1,!1),wa=Symbol(),Ks=e=>{const{action:t,...r}=e;typeof t!="function"&&(r.action=t);const[a,s]=_s([null,!1]),n=Jt(async c=>{const d=c.isTrusted?t:c.detail[wa];if(typeof d!="function")return;c.preventDefault();const h=new FormData(c.target);s([h,!0]);const f=d(h);f instanceof Promise&&(qs(f),await f),s([null,!0])},[]),i=Qt(e.ref,c=>(c.addEventListener("submit",n),()=>{c.removeEventListener("submit",n)})),[l,o]=a;return a[1]=!1,{tag:Hs,props:{value:{pending:l!==null,data:l,method:l?"post":null,action:l?t:null},children:{tag:"form",props:{...r,ref:i},type:"form",ref:i}},f:o}},xa=(e,{formAction:t,...r})=>{if(typeof t=="function"){const a=Jt(s=>{s.preventDefault(),s.currentTarget.form.dispatchEvent(new CustomEvent("submit",{detail:{[wa]:t}}))},[]);r.ref=Qt(r.ref,s=>(s.addEventListener("click",a),()=>{s.removeEventListener("click",a)}))}return{tag:e,props:r,type:e,ref:r.ref}},Vs=e=>xa("input",e),Xs=e=>xa("button",e);Object.assign(Lt,{title:Fs,script:Us,style:Bs,link:Ws,meta:Gs,form:Ks,input:Vs,button:Xs});Vt(null);new TextEncoder;var Ys=Vt(null),Zs=(e,t,r,a)=>(s,n)=>{const i="<!DOCTYPE html>",l=r?cr(c=>r(c,e),{Layout:t,...n},s):s,o=Na`${L(i)}${cr(Ys.Provider,{value:e},l)}`;return e.html(o)},Js=(e,t)=>function(a,s){const n=a.getLayout()??Ya;return e&&a.setLayout(i=>e({...i,Layout:n},a)),a.setRenderer(Zs(a,n,e)),s()};const Qs=Js(({children:e})=>M("html",{lang:"ko",children:[M("head",{children:[M("meta",{charset:"UTF-8"}),M("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0"}),M("title",{children:"PwC 온톨로지 자동 구축 서비스"}),M("script",{src:"https://cdn.tailwindcss.com"}),M("link",{href:"https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css",rel:"stylesheet"}),M("script",{crossorigin:!0,src:"https://unpkg.com/react@18/umd/react.development.js"}),M("script",{crossorigin:!0,src:"https://unpkg.com/react-dom@18/umd/react-dom.development.js"}),M("script",{src:"https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"}),M("script",{src:"https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"}),M("script",{src:"https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"}),M("style",{children:`
          /* PwC 온톨로지 서비스 - 추가 스타일 */
          .graph-container { cursor: grab; user-select: none; }
          .graph-container:active { cursor: grabbing; }
          
          /* 제어판 스타일 개선 */
          .control-panel { animation: fadeInLeft 0.6s ease-out; }
          @keyframes fadeInLeft { from { opacity: 0; transform: translateX(-30px); } to { opacity: 1; transform: translateX(0); } }
          
          /* 인사이트 패널 스타일 개선 */
          .insight-panel { animation: fadeInRight 0.6s ease-out; }
          @keyframes fadeInRight { from { opacity: 0; transform: translateX(30px); } to { opacity: 1; transform: translateX(0); } }
          
          /* 버튼 호버 효과 개선 */
          button { transition: all 0.3s ease; }
          button:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2); }
          
          /* PwC 브랜드 컬러 */
          .pwc-red { color: #e74c3c; }
          .pwc-blue { color: #3498db; }
          .pwc-orange { color: #e67e22; }
          
          /* 로딩 스피너 */
          .spinner { display: inline-block; width: 16px; height: 16px; border: 2px solid #f3f3f3; border-top: 2px solid #3498db; border-radius: 50%; animation: spin 1s linear infinite; }
          @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
          
          /* 상태바 개선 */
          .status-bar { backdrop-filter: blur(10px); animation: fadeInUp 0.8s ease-out; }
          @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
          
          /* 반응형 디자인 */
          @media (max-width: 768px) {
            .control-panel, .insight-panel { position: relative; top: auto; left: auto; right: auto; width: 100%; margin: 10px 0; max-height: none; }
            .graph-container { height: 50vh; }
          }
        `}),M("style",{children:`
          body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            overflow: hidden;
          }
          
          .graph-container {
            width: 100vw;
            height: 100vh;
            position: relative;
            background: linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 50%, #16213e 100%);
          }
          
          .control-panel {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
            min-width: 300px;
          }
          
          .insight-panel {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
            min-width: 280px;
            max-height: 60vh;
            overflow-y: auto;
          }
          
          .status-bar {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 10px;
          }
          
          .pulse {
            animation: pulse 2s infinite;
          }
          
          @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
          }
          
          .glow {
            animation: glow 2s ease-in-out infinite alternate;
          }
          
          @keyframes glow {
            from { box-shadow: 0 0 5px #e74c3c; }
            to { box-shadow: 0 0 20px #e74c3c, 0 0 30px #e74c3c; }
          }
          
          .slide-in {
            animation: slideIn 0.5s ease-out;
          }
          
          @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
          }
        `})]}),M("body",{children:[e,M("script",{src:"/static/app.js"})]})]})),en=[{id:"pwc-global",label:"PwC Global",type:"organization",category:"global"},{id:"pwc-korea",label:"PwC Korea",type:"organization",category:"country"},{id:"advisory",label:"Advisory",type:"division",category:"business-unit",aliases:["어드바이저리","자문"]},{id:"assurance",label:"Assurance",type:"division",category:"business-unit",aliases:["어슈어런스","보증"]},{id:"tax",label:"Tax & Legal",type:"division",category:"business-unit",aliases:["세무","택스"]},{id:"consulting",label:"Consulting",type:"division",category:"business-unit",aliases:["컨설팅"]},{id:"deals",label:"Deals",type:"practice",category:"service-line",aliases:["딜스","M&A","인수합병"]},{id:"risk",label:"Risk Assurance",type:"practice",category:"service-line",aliases:["리스크","위험관리"]},{id:"forensics",label:"Forensics",type:"practice",category:"service-line",aliases:["포렌식","수사"]},{id:"strategy",label:"Strategy&",type:"practice",category:"service-line",aliases:["전략","스트래티지"]},{id:"technology",label:"Technology Consulting",type:"practice",category:"service-line",aliases:["기술컨설팅","IT컨설팅"]},{id:"operations",label:"Operations",type:"practice",category:"service-line",aliases:["운영","오퍼레이션"]},{id:"people-org",label:"People & Organisation",type:"practice",category:"service-line",aliases:["인사조직","HR"]}],tn=[{id:"financial-services",label:"Financial Services",type:"industry",category:"sector",aliases:["금융","FS","은행","보험","증권"]},{id:"manufacturing",label:"Manufacturing",type:"industry",category:"sector",aliases:["제조업","제조","생산"]},{id:"retail-consumer",label:"Retail & Consumer",type:"industry",category:"sector",aliases:["소매","유통","소비재","CPG"]},{id:"healthcare",label:"Healthcare",type:"industry",category:"sector",aliases:["헬스케어","의료","제약","바이오"]},{id:"energy",label:"Energy, Utilities & Resources",type:"industry",category:"sector",aliases:["에너지","유틸리티","자원","전력","가스"]},{id:"tmt",label:"Technology, Media & Telecommunications",type:"industry",category:"sector",aliases:["TMT","기술","미디어","통신","IT","테크"]},{id:"automotive",label:"Automotive",type:"industry",category:"sector",aliases:["자동차","모빌리티","완성차","부품"]},{id:"aerospace",label:"Aerospace & Defence",type:"industry",category:"sector",aliases:["항공우주","방산","국방"]},{id:"samsung",label:"Samsung",type:"client",category:"enterprise",aliases:["삼성","삼성그룹"]},{id:"lg",label:"LG",type:"client",category:"enterprise",aliases:["엘지","LG그룹"]},{id:"sk",label:"SK",type:"client",category:"enterprise",aliases:["SK그룹"]},{id:"hyundai",label:"Hyundai Motor",type:"client",category:"enterprise",aliases:["현대자동차","현대차"]}],rn=[{id:"digital-transformation",label:"Digital Transformation",type:"capability",category:"digital",aliases:["디지털전환","DX","디지털혁신"]},{id:"ai-analytics",label:"AI & Analytics",type:"capability",category:"digital",aliases:["AI","인공지능","애널리틱스","데이터분석","ML","머신러닝"]},{id:"cloud",label:"Cloud",type:"capability",category:"digital",aliases:["클라우드","클라우드전환"]},{id:"cybersecurity",label:"Cybersecurity",type:"capability",category:"digital",aliases:["사이버보안","보안","정보보호"]},{id:"corporate-strategy",label:"Corporate Strategy",type:"capability",category:"strategy",aliases:["기업전략","전사전략"]},{id:"digital-strategy",label:"Digital Strategy",type:"capability",category:"strategy",aliases:["디지털전략"]},{id:"innovation",label:"Innovation",type:"capability",category:"strategy",aliases:["혁신","이노베이션"]},{id:"supply-chain",label:"Supply Chain",type:"capability",category:"operations",aliases:["공급망","SCM","S&OP"]},{id:"process-optimization",label:"Process Optimization",type:"capability",category:"operations",aliases:["프로세스최적화","업무개선","BPR"]},{id:"cost-reduction",label:"Cost Reduction",type:"capability",category:"operations",aliases:["비용절감","원가절감"]},{id:"sap",label:"SAP",type:"technology",category:"platform",aliases:["SAP","ERP"]},{id:"salesforce",label:"Salesforce",type:"technology",category:"platform",aliases:["세일즈포스","CRM"]},{id:"palantir",label:"Palantir",type:"technology",category:"platform",aliases:["팔란티어","데이터플랫폼"]},{id:"alteryx",label:"Alteryx",type:"technology",category:"platform",aliases:["알테릭스","데이터분석툴"]}],an=[{id:"proposal",label:"Proposal",type:"deliverable",category:"document",aliases:["제안서","프로포절","RFP응답"]},{id:"final-report",label:"Final Report",type:"deliverable",category:"document",aliases:["최종보고서","결과보고서"]},{id:"executive-summary",label:"Executive Summary",type:"deliverable",category:"document",aliases:["경영진요약","임원요약","ExSum"]},{id:"business-case",label:"Business Case",type:"deliverable",category:"document",aliases:["사업타당성","비즈니스케이스"]},{id:"operating-model",label:"Operating Model",type:"deliverable",category:"framework",aliases:["운영모델","조직모델"]},{id:"roadmap",label:"Roadmap",type:"deliverable",category:"framework",aliases:["로드맵","실행계획"]},{id:"kpi-dashboard",label:"KPI Dashboard",type:"deliverable",category:"framework",aliases:["KPI","성과지표","대시보드"]},{id:"data-platform",label:"Data Platform",type:"deliverable",category:"system",aliases:["데이터플랫폼","데이터레이크"]},{id:"analytics-model",label:"Analytics Model",type:"deliverable",category:"system",aliases:["분석모델","예측모델"]}],sn=[{id:"roi",label:"ROI",type:"kpi",category:"financial",aliases:["투자수익률","Return on Investment"]},{id:"cost-saving",label:"Cost Saving",type:"kpi",category:"financial",aliases:["비용절감","원가절감액"]},{id:"revenue-growth",label:"Revenue Growth",type:"kpi",category:"financial",aliases:["매출성장률","수익증가"]},{id:"efficiency",label:"Efficiency",type:"kpi",category:"operational",aliases:["효율성","생산성"]},{id:"time-to-market",label:"Time to Market",type:"kpi",category:"operational",aliases:["출시시간","TTM"]},{id:"customer-satisfaction",label:"Customer Satisfaction",type:"kpi",category:"operational",aliases:["고객만족도","CSAT","NPS"]},{id:"digital-adoption",label:"Digital Adoption",type:"kpi",category:"digital",aliases:["디지털도입률","디지털활용률"]},{id:"automation-rate",label:"Automation Rate",type:"kpi",category:"digital",aliases:["자동화율","RPA효과"]}],nn=[{source:"pwc-global",target:"pwc-korea",type:"contains",weight:1},{source:"pwc-korea",target:"advisory",type:"contains",weight:1},{source:"pwc-korea",target:"assurance",type:"contains",weight:1},{source:"pwc-korea",target:"tax",type:"contains",weight:1},{source:"pwc-korea",target:"consulting",type:"contains",weight:1},{source:"advisory",target:"deals",type:"contains",weight:1},{source:"advisory",target:"risk",type:"contains",weight:1},{source:"advisory",target:"forensics",type:"contains",weight:1},{source:"consulting",target:"strategy",type:"contains",weight:1},{source:"consulting",target:"technology",type:"contains",weight:1},{source:"consulting",target:"operations",type:"contains",weight:1},{source:"consulting",target:"people-org",type:"contains",weight:1},{source:"technology",target:"digital-transformation",type:"provides",weight:.9},{source:"technology",target:"ai-analytics",type:"provides",weight:.9},{source:"technology",target:"cloud",type:"provides",weight:.8},{source:"technology",target:"cybersecurity",type:"provides",weight:.7},{source:"strategy",target:"corporate-strategy",type:"provides",weight:.9},{source:"strategy",target:"digital-strategy",type:"provides",weight:.8},{source:"strategy",target:"innovation",type:"provides",weight:.7},{source:"operations",target:"supply-chain",type:"provides",weight:.9},{source:"operations",target:"process-optimization",type:"provides",weight:.8},{source:"operations",target:"cost-reduction",type:"provides",weight:.8},{source:"ai-analytics",target:"palantir",type:"uses",weight:.8},{source:"ai-analytics",target:"alteryx",type:"uses",weight:.7},{source:"digital-transformation",target:"sap",type:"uses",weight:.7},{source:"digital-transformation",target:"salesforce",type:"uses",weight:.6},{source:"tmt",target:"samsung",type:"includes",weight:.9},{source:"tmt",target:"lg",type:"includes",weight:.8},{source:"automotive",target:"hyundai",type:"includes",weight:.9},{source:"energy",target:"sk",type:"includes",weight:.8},{source:"corporate-strategy",target:"business-case",type:"generates",weight:.8},{source:"digital-strategy",target:"roadmap",type:"generates",weight:.8},{source:"ai-analytics",target:"data-platform",type:"generates",weight:.8},{source:"ai-analytics",target:"analytics-model",type:"generates",weight:.9},{source:"process-optimization",target:"operating-model",type:"generates",weight:.7},{source:"cost-reduction",target:"cost-saving",type:"measures",weight:.9},{source:"digital-transformation",target:"digital-adoption",type:"measures",weight:.8},{source:"process-optimization",target:"efficiency",type:"measures",weight:.8},{source:"ai-analytics",target:"automation-rate",type:"measures",weight:.7},{source:"samsung",target:"digital-transformation",type:"requests",weight:.8},{source:"samsung",target:"supply-chain",type:"requests",weight:.7},{source:"hyundai",target:"ai-analytics",type:"requests",weight:.8},{source:"lg",target:"cloud",type:"requests",weight:.7}],Ar={entities:[...en,...tn,...rn,...an,...sn],relationships:nn};function on(){const e=Ar.entities.map((r,a)=>({id:r.id,label:r.label,type:r.type,category:r.category,x:a%10*80-400,y:Math.floor(a/10)*80-200,z:a%3*50,color:ln(r.type),aliases:r.aliases||[],metadata:r.metadata||{}})),t=Ar.relationships.map(r=>({source:r.source,target:r.target,type:r.type,strength:r.weight}));return{nodes:e,links:t}}function ln(e){return{organization:"#e74c3c",division:"#c0392b",practice:"#e67e22",industry:"#3498db",client:"#2980b9",capability:"#2ecc71",technology:"#9b59b6",deliverable:"#f39c12",kpi:"#1abc9c",document:"#95a5a6"}[e]||"#34495e"}const O=new ua;O.use("/api/*",Cs());O.get("/static/*",async e=>{const t=e.req.path.replace("/static/",""),r=He(process.cwd(),"public","static",t);if(console.log(`[Static] Requested: ${e.req.path} -> ${r}`),!Wt(r))return console.log(`[Static] File not found: ${r}`),e.text("File not found",404);try{const a=Gt(r),s=cn(t);return e.body(a,200,{"Content-Type":s,"Cache-Control":"public, max-age=3600"})}catch(a){return console.error(`[Static] Error reading ${r}:`,a),e.text("Error reading file",500)}});O.get("/favicon.ico",async e=>{const t=He(process.cwd(),"public","favicon.ico");if(!Wt(t))return e.body(new Uint8Array([0]),200,{"Content-Type":"image/x-icon"});try{const r=Gt(t);return e.body(r,200,{"Content-Type":"image/x-icon"})}catch(r){return console.error("Error serving favicon:",r),e.body(new Uint8Array([0]),200,{"Content-Type":"image/x-icon"})}});function cn(e){var r;switch((r=e.split(".").pop())==null?void 0:r.toLowerCase()){case"js":return"application/javascript";case"css":return"text/css";case"html":return"text/html";case"json":return"application/json";case"png":return"image/png";case"jpg":case"jpeg":return"image/jpeg";case"ico":return"image/x-icon";default:return"text/plain"}}O.use(Qs);O.get("/inline",async e=>{try{const t=Gt(He(process.cwd(),"dist/inline.html"),"utf8");return e.html(t)}catch(t){return console.error("인라인 HTML 로드 실패:",t),e.text("인라인 HTML을 로드할 수 없습니다",500)}});O.get("/api/health",e=>e.json({status:"healthy",timestamp:new Date().toISOString()}));let P=[],N=[];const ba=()=>{const{nodes:e,links:t}=on();return{seedNodes:e,seedLinks:t}};O.get("/api/ontology/nodes",e=>e.json(P));O.get("/api/ontology/links",e=>e.json(N));O.post("/api/ontology/reset",async e=>{const t=await e.req.json().catch(()=>({})),{loadSeed:r=!1}=t;if(r){const{seedNodes:a,seedLinks:s}=ba();return P=[...a],N=[...s],e.json({success:!0,message:"PwC 시드 온톨로지로 리셋되었습니다.",nodeCount:P.length,linkCount:N.length})}else return P=[],N=[],e.json({success:!0,message:"빈 그래프로 리셋되었습니다.",nodeCount:0,linkCount:0})});O.get("/api/ontology/status",e=>{const{seedNodes:t,seedLinks:r}=ba();return e.json({totalNodes:P.length,totalLinks:N.length,seedNodes:t.length,seedLinks:r.length,addedNodes:Math.max(0,P.length-(P.length>0?t.length:0)),addedLinks:Math.max(0,N.length-(N.length>0?r.length:0)),categories:{organization:P.filter(a=>a.type==="organization").length,industry:P.filter(a=>a.type==="industry").length,capability:P.filter(a=>a.type==="capability").length,technology:P.filter(a=>a.type==="technology").length,deliverable:P.filter(a=>a.type==="deliverable").length,kpi:P.filter(a=>a.type==="kpi").length,pdf_page:P.filter(a=>a.type==="pdf_page").length,pdf_page_image:P.filter(a=>a.type==="pdf_page_image").length}})});O.post("/api/search",async e=>{const{query:t}=await e.req.json(),r={nodes:[{id:"digital",score:.95},{id:"ai",score:.8},{id:"analytics",score:.7}],path:["digital","analytics","ai"],insights:["Found 3 related capabilities","Strong connection between Digital Services and AI","Recommended next step: Explore AI use cases"]};return e.json(r)});O.post("/api/documents/upload",async e=>{var t;try{const r=await e.req.json(),{fileName:a,fileContent:s,fileSize:n,processingMode:i="unified"}=r,l=a.toLowerCase().endsWith(".pdf");if(l&&i==="unified"){const o=Date.now(),c=await Er(a,s),d=await Pr(c),h=await Cr(a,n),f=await Sr(a,n),g=[],m=[];d.autoApproved.forEach(p=>{if(p.type==="entity"){const v={id:p.data.id,label:p.data.text,type:p.data.type,category:p.data.category,x:Math.random()*400-200,y:Math.random()*400-200,z:Math.random()*200-100,color:Rr(p.data.type),isNew:!0,confidence:p.data.confidence,source:c.id,processingType:"ontology"};P.push(v),g.push(v)}else if(p.type==="relationship"){const v={source:p.data.source,target:p.data.target,type:p.data.type,strength:p.data.confidence,evidence:p.data.evidence,source_doc:c.id,processingType:"ontology"};N.push(v),m.push(v)}}),h.pageNodes.forEach(p=>{const v={...p,processingType:"pages",isNew:!0};P.push(v),g.push(v)}),f.pageImages.forEach(p=>{const v={...p,processingType:"images",isNew:!0};P.push(v),g.push(v)}),h.pageRelationships.forEach(p=>{const v={source:p.source,target:p.target,type:p.type,strength:p.strength,evidence:p.evidence,processingType:"pages"};N.push(v),m.push(v)}),f.pageRelationships.forEach(p=>{const v={source:p.source,target:p.target,type:p.type,strength:p.strength,evidence:p.evidence,processingType:"images"};N.push(v),m.push(v)});const y=Date.now()-o;return e.json({success:!0,processingMode:"unified",processedDocument:{id:c.id,filename:a,title:h.title||c.title,totalPages:h.totalPages,mainTopics:[...new Set([...h.mainTopics,...f.mainTopics])],summary:`통합 처리: ${h.documentSummary}`,aiKeywordCount:f.aiKeywordCount||0,consultingInsightCount:f.consultingInsightCount||0},ontologyAnalysis:{entities:d.autoApproved.filter(p=>p.type==="entity").length,relationships:d.autoApproved.filter(p=>p.type==="relationship").length,needsReview:d.needsReview.length,processingTime:((t=c.metadata)==null?void 0:t.processingTime)||0},pdfAnalysis:{pages:h.totalPages,pageNodes:h.pageNodes.length,pageRelationships:h.pageRelationships.length,mainTopics:h.mainTopics,processingTime:h.metadata.processingTime},pdfImageAnalysis:{pages:f.totalPages,pageImages:f.pageImages.length,pageRelationships:f.pageRelationships.length,mainTopics:f.mainTopics,processingTime:f.metadata.processingTime},needsReview:{count:d.needsReview.length,topCandidates:d.needsReview.slice(0,5).map(p=>({type:p.type,text:p.data.text||`${p.data.source} → ${p.data.target}`,confidence:p.data.confidence,reason:p.reason}))},newNodes:g,newLinks:m,message:`📊 통합 처리 완료!
🧠 온톨로지: ${d.autoApproved.length}개 엔티티/관계
📄 페이지 텍스트: ${h.totalPages}개 페이지
🖼️ 페이지 이미지: ${f.totalPages}개 이미지
⏱️ 총 처리시간: ${y}ms`,totalProcessingTime:y})}else if(l&&i==="pages"){const o=await Cr(a,n);return o.pageNodes.forEach(c=>{P.push(c)}),o.pageRelationships.forEach(c=>{N.push({source:c.source,target:c.target,type:c.type,strength:c.strength,evidence:c.evidence})}),e.json({success:!0,processingMode:"pages",processedDocument:{id:o.id,filename:o.filename,title:o.title,totalPages:o.totalPages,mainTopics:o.mainTopics,summary:o.documentSummary},pdfAnalysis:{pages:o.totalPages,pageNodes:o.pageNodes.length,pageRelationships:o.pageRelationships.length,mainTopics:o.mainTopics,processingTime:o.metadata.processingTime},newNodes:o.pageNodes.map(c=>({...c,isNew:!0})),newLinks:o.pageRelationships,message:`PDF 페이지별 분석 완료: ${o.totalPages}개 페이지, ${o.pageRelationships.length}개 관계 생성`})}else if(l&&i==="images"){const o=await Sr(a,n);return o.pageImages.forEach(c=>{P.push(c)}),o.pageRelationships.forEach(c=>{N.push({source:c.source,target:c.target,type:c.type,strength:c.strength,evidence:c.evidence})}),e.json({success:!0,processingMode:"images",processedDocument:{id:o.id,filename:o.filename,title:o.title,totalPages:o.totalPages,mainTopics:o.mainTopics,summary:o.documentSummary},pdfImageAnalysis:{pages:o.totalPages,pageImages:o.pageImages.length,pageRelationships:o.pageRelationships.length,mainTopics:o.mainTopics,processingTime:o.metadata.processingTime},newNodes:o.pageImages.map(c=>({...c,isNew:!0})),newLinks:o.pageRelationships,message:`PDF 이미지 변환 완료: ${o.totalPages}개 페이지 이미지, ${o.pageRelationships.length}개 관계 생성`})}else{const o=await Er(a,s),c=await Pr(o),d=[],h=[];return c.autoApproved.forEach(f=>{if(f.type==="entity"){const g={id:f.data.id,label:f.data.text,type:f.data.type,category:f.data.category,x:Math.random()*400-200,y:Math.random()*400-200,z:Math.random()*200-100,color:Rr(f.data.type),isNew:!0,confidence:f.data.confidence,source:o.id};P.push(g),d.push(g)}else if(f.type==="relationship"){const g={source:f.data.source,target:f.data.target,type:f.data.type,strength:f.data.confidence,evidence:f.data.evidence,source_doc:o.id};N.push(g),h.push(g)}}),e.json({success:!0,processingMode:"ontology",processedDocument:{id:o.id,filename:o.filename,confidence:o.confidence,documentType:o.metadata.documentType,client:o.metadata.client,tags:o.metadata.tags},autoApproved:{entities:c.autoApproved.filter(f=>f.type==="entity").length,relationships:c.autoApproved.filter(f=>f.type==="relationship").length},needsReview:{count:c.needsReview.length,topCandidates:c.needsReview.slice(0,5).map(f=>({type:f.type,text:f.data.text||`${f.data.source} → ${f.data.target}`,confidence:f.data.confidence,reason:f.reason}))},newNodes:d,newLinks:h,message:`문서 처리 완료: ${c.autoApproved.length}개 자동 승인, ${c.needsReview.length}개 검토 필요`})}}catch{return e.json({success:!1,error:"문서 처리 중 오류 발생"},500)}});O.get("/api/pdf/page/:pageId",e=>{const t=e.req.param("pageId"),r=P.find(a=>a.id===t&&a.type==="pdf_page");return r?e.json({page:r,relatedPages:N.filter(a=>a.source===t||a.target===t).map(a=>({relationshipType:a.type,relatedPageId:a.source===t?a.target:a.source,strength:a.strength,evidence:a.evidence}))}):e.json({error:"페이지를 찾을 수 없습니다"},404)});O.get("/api/pdf/document/:docId/pages",e=>{const t=e.req.param("docId"),r=P.filter(a=>a.type==="pdf_page"&&a.documentId===t).sort((a,s)=>a.pageNumber-s.pageNumber);return e.json({documentId:t,totalPages:r.length,pages:r.map(a=>{var s,n;return{id:a.id,pageNumber:a.pageNumber,title:a.title,summary:a.summary,keywords:a.keywords,wordCount:a.wordCount,imageCount:((s=a.images)==null?void 0:s.length)||0,tableCount:((n=a.tables)==null?void 0:n.length)||0}})})});O.get("/api/review/pending",e=>{const t=[{id:"review-1",type:"entity",text:"Quantum Computing",confidence:.65,context:"차세대 컴퓨팅 기술인 Quantum Computing을 활용한...",suggestedType:"technology",reason:"새로운 기술 용어, 확신도 검증 필요"},{id:"review-2",type:"relationship",text:"AI → 자동화율",confidence:.58,evidence:"AI 도입으로 자동화율이 90% 향상되었다",suggestedType:"improves",reason:"관계 강도 불분명"}];return e.json(t)});O.post("/api/review/:id/decision",async e=>{const t=e.req.param("id"),{decision:r,feedback:a}=await e.req.json();return e.json({success:!0,reviewId:t,decision:r,feedback:a,message:r==="approve"?"승인되어 온톨로지에 추가되었습니다":"거절되었습니다",learningUpdate:"피드백이 학습 모델에 반영되어 다음 처리 정확도가 향상됩니다"})});function Rr(e){return{organization:"#e74c3c",division:"#c0392b",practice:"#e67e22",industry:"#3498db",client:"#2980b9",capability:"#2ecc71",technology:"#9b59b6",deliverable:"#f39c12",kpi:"#1abc9c",document:"#95a5a6",pdf_page_image:"#ffffff",ai_keyword:"#e74c3c",consulting_insight:"#f39c12",pdf_page:"#3498db"}[e]||"#34495e"}async function Er(e,t){return{id:`doc-${Date.now()}`,filename:e,title:"삼성DS S&OP 최적화 프로젝트",confidence:.87,metadata:{documentType:"proposal",client:"samsung",tags:["digital","ai","supply-chain"],uploadTime:new Date().toISOString()},extractedEntities:[{id:"extracted-entity-1",text:"Quantum Computing",type:"technology",category:"discovered",confidence:.65},{id:"extracted-entity-2",text:"Edge Computing",type:"technology",category:"discovered",confidence:.82}],extractedRelationships:[{id:"extracted-rel-1",source:"samsung",target:"extracted-entity-2",type:"adopts",confidence:.78,evidence:"삼성은 Edge Computing 기술을 적극 도입하고 있다"}]}}async function Sr(e,t){const r=Date.now(),a=[{id:`page-img-${Date.now()}-1`,documentId:`pdf-doc-${Date.now()}`,pageNumber:1,imageDataUrl:Ne(1),width:1920,height:1080,aspectRatio:1920/1080,type:"pdf_page_image",category:"document_page_image",x:Math.cos(0)*400,y:Math.sin(0)*400,z:0,color:"#ffffff",label:"제안서 표지",pageTitle:"삼성전자 DX SCM 생성형 AI 제안서",isNew:!0,metadata:{pageNumber:1,title:"삼성전자 DX SCM 생성형 AI 기반 SCM 데이터 조회 MVP 구축",extractedText:"삼성전자 DX SCM 생성형 AI 기반 SCM 데이터 조회 MVP 구축 Workflow 기반 활용 방안 수립",wordCount:32,hasTitle:!0,hasImages:!0,hasTables:!1,hasCharts:!1,pageType:"cover",keywords:["삼성전자","DX","SCM","생성형 AI","MVP","Workflow","PwC"],summary:"PwC의 삼성전자 DX SCM 생성형 AI 기반 데이터 조회 서비스 PoC 제안서 표지",aiKeywords:["Generative AI","SCM","Data Analytics","Digital Transformation"],consultingInsights:["PoC 구축","업무 프로세스 최적화","AI 도입 전략","사용성 제고"],fonts:[{family:"Arial",sizes:[24,36,48],usage:1}],colors:[{hex:"#0066cc",rgb:[0,102,204],usage:.4,role:"primary"},{hex:"#2c3e50",rgb:[44,62,80],usage:.4,role:"text"},{hex:"#ffffff",rgb:[255,255,255],usage:.2,role:"background"}],textBlocks:[],images:[{id:"img-1-1",type:"logo",description:"PwC 로고"}],confidence:.98}},{id:`page-img-${Date.now()}-2`,documentId:`pdf-doc-${Date.now()}`,pageNumber:2,imageDataUrl:Ne(2),width:1920,height:1080,aspectRatio:1920/1080,type:"pdf_page_image",category:"document_page_image",x:Math.cos(1/5*2*Math.PI)*400,y:Math.sin(1/5*2*Math.PI)*400,z:20,color:"#ffffff",label:"Agenda",pageTitle:"Agenda",isNew:!0,metadata:{pageNumber:2,title:"Agenda",extractedText:"I. 제안 개요 II. 수행 범위 III. 사업 관리 IV. 제안사 소개",wordCount:18,hasTitle:!0,hasImages:!1,hasTables:!1,hasCharts:!1,pageType:"agenda",keywords:["제안개요","수행범위","사업관리","제안사소개","Agenda"],summary:"제안서의 전체 구성과 진행 순서를 나타내는 아젠다 페이지",aiKeywords:["Project Scope","Service Delivery","Implementation"],consultingInsights:["프로젝트 구조화","단계별 접근법","체계적 제안"],fonts:[{family:"Arial",sizes:[16,24,36],usage:1}],colors:[{hex:"#0066cc",rgb:[0,102,204],usage:.4,role:"accent"},{hex:"#2c3e50",rgb:[44,62,80],usage:.5,role:"text"}],confidence:.95}},{id:`page-img-${Date.now()}-3`,documentId:`pdf-doc-${Date.now()}`,pageNumber:3,imageDataUrl:Ne(3),width:1920,height:1080,aspectRatio:1920/1080,type:"pdf_page_image",category:"document_page_image",x:Math.cos(2/5*2*Math.PI)*400,y:Math.sin(2/5*2*Math.PI)*400,z:40,color:"#ffffff",label:"프로젝트 추진 목표",pageTitle:"I. 제안 개요 - 프로젝트 추진 목표",isNew:!0,metadata:{pageNumber:3,title:"Gen AI 기반 내/외부 데이터 활용 추진 방향성",extractedText:"Gen AI 기반 내/외부 데이터의 업무 활용을 극대화하여 NSCM 시스템의 사용성 제고를 목표로 함. SCM 통합 AI Orchestrator를 통한 Multi Agent 시스템 구축",wordCount:62,hasTitle:!0,hasImages:!0,hasTables:!1,hasCharts:!0,pageType:"strategy",keywords:["Gen AI","NSCM","AI Orchestrator","Multi Agent","SCM","데이터 활용"],summary:"생성형 AI를 활용한 SCM 데이터 조회 서비스의 핵심 목표와 추진 방향성",aiKeywords:["Generative AI","Multi-Agent System","AI Orchestration","Natural Language Processing"],consultingInsights:["시스템 통합 전략","AI 활용 극대화","사용성 중심 설계","업무 효율성 향상"],fonts:[{family:"Arial",sizes:[16,24,36],usage:1}],colors:[{hex:"#2ecc71",rgb:[46,204,113],usage:.3,role:"accent"},{hex:"#3498db",rgb:[52,152,219],usage:.3,role:"primary"},{hex:"#9b59b6",rgb:[155,89,182],usage:.2,role:"accent"}],confidence:.97}},{id:`page-img-${Date.now()}-4`,documentId:`pdf-doc-${Date.now()}`,pageNumber:4,imageDataUrl:Ne(4),width:1920,height:1080,aspectRatio:1920/1080,type:"pdf_page_image",category:"document_page_image",x:Math.cos(3/5*2*Math.PI)*400,y:Math.sin(3/5*2*Math.PI)*400,z:60,color:"#ffffff",label:"구현 계획",pageTitle:"구현 계획",isNew:!0,metadata:{pageNumber:4,title:"구현 계획",extractedText:"3. 구현 계획 Phase 1 데이터 플랫폼 Phase 2 AI 모델 Phase 3 전사 적용",wordCount:52,hasTitle:!0,hasImages:!1,hasTables:!0,hasCharts:!1,pageType:"content",keywords:["구현계획","Phase","데이터플랫폼","AI모델","전사적용"],summary:"3단계 Phase별 구현 계획 및 일정",fonts:[{family:"Arial",sizes:[14,16,24],usage:1}],colors:[{hex:"#f39c12",rgb:[243,156,18],usage:.4,role:"accent"}],confidence:.9}},{id:`page-img-${Date.now()}-5`,documentId:`pdf-doc-${Date.now()}`,pageNumber:5,imageDataUrl:Ne(5),width:1920,height:1080,aspectRatio:1920/1080,type:"pdf_page_image",category:"document_page_image",x:Math.cos(4/5*2*Math.PI)*400,y:Math.sin(4/5*2*Math.PI)*400,z:80,color:"#ffffff",label:"기대 효과",pageTitle:"기대 효과",isNew:!0,metadata:{pageNumber:5,title:"기대 효과 및 ROI",extractedText:"4. 기대 효과 ROI 150% 연간 50억원 절감 1년차 120% 2년차 180%",wordCount:42,hasTitle:!0,hasImages:!0,hasTables:!0,hasCharts:!0,pageType:"chart",keywords:["ROI","150%","50억원","절감","기대효과"],summary:"ROI 150% 달성과 연간 50억원 절감 효과 분석",fonts:[{family:"Arial",sizes:[16,24,36],usage:1}],colors:[{hex:"#e74c3c",rgb:[231,76,60],usage:.3,role:"accent"},{hex:"#f39c12",rgb:[243,156,18],usage:.2,role:"accent"},{hex:"#2ecc71",rgb:[46,204,113],usage:.2,role:"accent"}],confidence:.96}}],s=[],n=[];a.forEach((c,d)=>{var f,g;const h=700+d*100;(f=c.metadata.aiKeywords)==null||f.forEach((m,y)=>{const p=(d*2+y*.5)*Math.PI/3;s.push({id:`ai-keyword-${Date.now()}-${d}-${y}`,label:m,type:"ai_keyword",category:"ai_concept",x:Math.cos(p)*h,y:Math.sin(p)*h,z:200+y*40,color:"#e74c3c",size:8,isNew:!0,sourcePageId:c.id,confidence:.9+Math.random()*.1,metadata:{keyword:m,category:"AI Technology",relevance:"High",extractedFrom:c.metadata.title}})}),(g=c.metadata.consultingInsights)==null||g.forEach((m,y)=>{const p=(d*2+y*.7+Math.PI)*Math.PI/3;n.push({id:`consulting-${Date.now()}-${d}-${y}`,label:m,type:"consulting_insight",category:"business_insight",x:Math.cos(p)*(h+160),y:Math.sin(p)*(h+160),z:160+y*50,color:"#f39c12",size:10,isNew:!0,sourcePageId:c.id,confidence:.85+Math.random()*.1,metadata:{insight:m,category:"Business Strategy",impact:"Medium",extractedFrom:c.metadata.title}})})});const i=[...a,...s,...n],l=[];for(let c=0;c<a.length-1;c++)l.push({source:a[c].id,target:a[c+1].id,type:"next_page",strength:1,evidence:"순차적 페이지"});s.forEach(c=>{l.push({source:c.sourcePageId,target:c.id,type:"contains_ai_concept",strength:.8,evidence:"AI 개념 추출"})}),n.forEach(c=>{l.push({source:c.sourcePageId,target:c.id,type:"generates_insight",strength:.7,evidence:"컨설팅 인사이트 도출"})}),a.length>=3&&l.push({source:a[1].id,target:a[2].id,type:"leads_to",strength:.9,evidence:"아젠다 → 제안 개요 연결"});const o=Date.now()-r;return{id:`pdf-doc-${Date.now()}`,filename:e,title:e.replace(".pdf",""),totalPages:a.length,pageImages:i,pageRelationships:l,documentSummary:`삼성전자 DX SCM 생성형 AI 제안서: ${a.length}개 페이지, ${s.length}개 AI 키워드, ${n.length}개 컨설팅 인사이트`,mainTopics:["Gen AI","SCM","Multi Agent","NSCM","AI Orchestrator","Digital Transformation"],aiKeywordCount:s.length,consultingInsightCount:n.length,metadata:{fileSize:t,processingTime:o,createdDate:new Date().toISOString(),aiKeywordCount:s.length,consultingInsightCount:n.length}}}function Ne(e){const t={1:`data:image/svg+xml;charset=utf-8,${encodeURIComponent(`
      <svg width="400" height="300" xmlns="http://www.w3.org/2000/svg">
        <rect width="400" height="300" fill="white" stroke="#ddd" stroke-width="2"/>
        <rect x="20" y="20" width="60" height="25" fill="#0066cc"/>
        <text x="50" y="37" fill="white" font-family="Arial" font-size="11" text-anchor="middle" font-weight="bold">PwC</text>
        <rect x="320" y="20" width="60" height="25" fill="#1f4e79"/>
        <text x="350" y="37" fill="white" font-family="Arial" font-size="8" text-anchor="middle">삼성전자</text>
        <text x="200" y="80" fill="#0066cc" font-family="Arial" font-size="14" text-anchor="middle" font-weight="bold">추가 Proposal</text>
        <text x="200" y="130" fill="#2c3e50" font-family="Arial" font-size="12" text-anchor="middle" font-weight="bold">삼성전자 DX SCM</text>
        <text x="200" y="150" fill="#2c3e50" font-family="Arial" font-size="12" text-anchor="middle" font-weight="bold">생성형 AI 기반 SCM 데이터 조회</text>
        <text x="200" y="170" fill="#2c3e50" font-family="Arial" font-size="12" text-anchor="middle" font-weight="bold">MVP 구축 Workflow</text>
        <text x="200" y="210" fill="#e74c3c" font-family="Arial" font-size="10" text-anchor="middle">Confidential</text>
        <text x="200" y="260" fill="#7f8c8d" font-family="Arial" font-size="12" text-anchor="middle">2025.2</text>
      </svg>
    `)}`,2:`data:image/svg+xml;charset=utf-8,${encodeURIComponent(`
      <svg width="400" height="300" xmlns="http://www.w3.org/2000/svg">
        <rect width="400" height="300" fill="white" stroke="#ddd" stroke-width="2"/>
        <text x="200" y="40" fill="#0066cc" font-family="Arial" font-size="18" text-anchor="middle" font-weight="bold">Agenda</text>
        <line x1="50" y1="60" x2="350" y2="60" stroke="#0066cc" stroke-width="2"/>
        <circle cx="30" cy="90" r="4" fill="#2c3e50"/>
        <text x="50" y="95" fill="#2c3e50" font-family="Arial" font-size="14" font-weight="bold">I. 제안 개요</text>
        <circle cx="30" cy="130" r="4" fill="#2c3e50"/>
        <text x="50" y="135" fill="#2c3e50" font-family="Arial" font-size="14" font-weight="bold">II. 수행 범위</text>
        <circle cx="30" cy="170" r="4" fill="#2c3e50"/>
        <text x="50" y="175" fill="#2c3e50" font-family="Arial" font-size="14" font-weight="bold">III. 사업 관리</text>
        <circle cx="30" cy="210" r="4" fill="#2c3e50"/>
        <text x="50" y="215" fill="#2c3e50" font-family="Arial" font-size="14" font-weight="bold">IV. 제안사 소개</text>
        <rect x="300" y="250" width="80" height="30" fill="#0066cc" opacity="0.1"/>
        <text x="340" y="270" fill="#0066cc" font-family="Arial" font-size="10" text-anchor="middle">Structure</text>
      </svg>
    `)}`,3:`data:image/svg+xml;charset=utf-8,${encodeURIComponent(`
      <svg width="400" height="300" xmlns="http://www.w3.org/2000/svg">
        <rect width="400" height="300" fill="white" stroke="#ddd" stroke-width="2"/>
        <text x="20" y="30" fill="#0066cc" font-family="Arial" font-size="12" font-weight="bold">I. 제안 개요</text>
        <text x="20" y="50" fill="#2c3e50" font-family="Arial" font-size="14" font-weight="bold">프로젝트 추진 목표</text>
        <rect x="20" y="60" width="360" height="50" fill="#e8f4f8" stroke="#0066cc" stroke-width="1"/>
        <text x="200" y="80" fill="#2c3e50" font-family="Arial" font-size="10" text-anchor="middle">Gen AI 기반 내/외부 데이터의 업무 활용을 극대화하여</text>
        <text x="200" y="95" fill="#2c3e50" font-family="Arial" font-size="10" text-anchor="middle">NSCM 시스템의 사용성 제고를 목표로 함</text>
        <rect x="50" y="130" width="80" height="40" fill="#2ecc71" rx="5"/>
        <text x="90" y="145" fill="white" font-family="Arial" font-size="8" text-anchor="middle">내부 정형</text>
        <text x="90" y="157" fill="white" font-family="Arial" font-size="8" text-anchor="middle">Data Agent</text>
        <rect x="160" y="130" width="80" height="40" fill="#e74c3c" rx="5"/>
        <text x="200" y="145" fill="white" font-family="Arial" font-size="8" text-anchor="middle">외부 비정형</text>
        <text x="200" y="157" fill="white" font-family="Arial" font-size="8" text-anchor="middle">Data Agent</text>
        <rect x="270" y="130" width="80" height="40" fill="#9b59b6" rx="5"/>
        <text x="310" y="145" fill="white" font-family="Arial" font-size="8" text-anchor="middle">SCM Workflow</text>
        <text x="310" y="157" fill="white" font-family="Arial" font-size="8" text-anchor="middle">업무 Agent</text>
        <rect x="120" y="200" width="160" height="30" fill="#f39c12" rx="5"/>
        <text x="200" y="218" fill="white" font-family="Arial" font-size="10" text-anchor="middle" font-weight="bold">SCM 통합 AI Orchestrator</text>
        <text x="200" y="250" fill="#7f8c8d" font-family="Arial" font-size="8" text-anchor="middle">Multi Agent System</text>
      </svg>
    `)}`,4:`data:image/svg+xml;charset=utf-8,${encodeURIComponent(`
      <svg width="400" height="300" xmlns="http://www.w3.org/2000/svg">
        <rect width="400" height="300" fill="white" stroke="#ddd" stroke-width="2"/>
        <text x="20" y="40" fill="#2c3e50" font-family="Arial" font-size="16" font-weight="bold">3. 구현 계획</text>
        <line x1="50" y1="120" x2="350" y2="120" stroke="#f39c12" stroke-width="3"/>
        <circle cx="100" cy="120" r="8" fill="#f39c12"/>
        <circle cx="200" cy="120" r="8" fill="#f39c12"/>
        <circle cx="300" cy="120" r="8" fill="#f39c12"/>
        <text x="85" y="140" fill="#2c3e50" font-family="Arial" font-size="10">Phase 1</text>
        <text x="185" y="140" fill="#2c3e50" font-family="Arial" font-size="10">Phase 2</text>
        <text x="285" y="140" fill="#2c3e50" font-family="Arial" font-size="10">Phase 3</text>
        <text x="75" y="155" fill="#7f8c8d" font-family="Arial" font-size="8">1-3개월</text>
        <text x="175" y="155" fill="#7f8c8d" font-family="Arial" font-size="8">4-6개월</text>
        <text x="275" y="155" fill="#7f8c8d" font-family="Arial" font-size="8">7-9개월</text>
      </svg>
    `)}`,5:`data:image/svg+xml;charset=utf-8,${encodeURIComponent(`
      <svg width="400" height="300" xmlns="http://www.w3.org/2000/svg">
        <rect width="400" height="300" fill="white" stroke="#ddd" stroke-width="2"/>
        <text x="20" y="40" fill="#2c3e50" font-family="Arial" font-size="16" font-weight="bold">4. 기대 효과</text>
        <rect x="50" y="140" width="40" height="60" fill="#e74c3c"/>
        <rect x="130" y="120" width="40" height="80" fill="#f39c12"/>
        <rect x="210" y="100" width="40" height="100" fill="#2ecc71"/>
        <text x="65" y="215" fill="#2c3e50" font-family="Arial" font-size="10" text-anchor="middle">1년차</text>
        <text x="145" y="215" fill="#2c3e50" font-family="Arial" font-size="10" text-anchor="middle">2년차</text>
        <text x="225" y="215" fill="#2c3e50" font-family="Arial" font-size="10" text-anchor="middle">3년차</text>
        <text x="280" y="80" fill="#2c3e50" font-family="Arial" font-size="14" font-weight="bold">ROI: 150%</text>
        <text x="280" y="100" fill="#2c3e50" font-family="Arial" font-size="12">연간 50억원 절감</text>
      </svg>
    `)}`};return t[e]||t[1]}async function Cr(e,t){const r=Date.now(),a=[{id:`page-${Date.now()}-1`,documentId:`pdf-doc-${Date.now()}`,documentTitle:e.replace(".pdf",""),pageNumber:1,title:"삼성DS 사업부 S&OP 최적화 프로젝트 제안서",content:"Executive Summary 내용...",summary:"삼성 DS 사업부의 S&OP 프로세스 최적화를 통한 운영 효율성 증대 방안 제시",keywords:["삼성","DS","S&OP","최적화","Executive Summary"],images:[{id:"img-1-1",description:"PwC 로고",type:"logo"}],tables:[],type:"pdf_page",category:"document_page",x:Math.cos(0)*200,y:Math.sin(0)*200,z:0,color:"#e74c3c",wordCount:89,confidence:.9},{id:`page-${Date.now()}-2`,documentId:`pdf-doc-${Date.now()}`,documentTitle:e.replace(".pdf",""),pageNumber:2,title:"1. 현황 분석",content:"AS-IS 프로세스 분석 및 벤치마킹...",summary:"현재 S&OP 프로세스의 한계점 분석 및 글로벌 벤치마킹 결과",keywords:["현황분석","AS-IS","벤치마킹","한계점","프로세스"],images:[{id:"img-2-1",description:"AS-IS vs TO-BE 비교 차트",type:"chart"}],tables:[{id:"table-2-1",headers:["구분","AS-IS","TO-BE"],rows:[]}],type:"pdf_page",category:"document_page",x:Math.cos(1/5*2*Math.PI)*200,y:Math.sin(1/5*2*Math.PI)*200,z:20,color:"#3498db",wordCount:156,confidence:.9},{id:`page-${Date.now()}-3`,documentId:`pdf-doc-${Date.now()}`,documentTitle:e.replace(".pdf",""),pageNumber:3,title:"2. 제안 솔루션",content:"AI 기반 수요 예측 모델 및 Palantir 플랫폼...",summary:"AI 기반 수요 예측과 Palantir Foundry를 활용한 통합 플랫폼 솔루션",keywords:["AI","예측모델","Palantir","Foundry","솔루션"],images:[{id:"img-3-1",description:"AI 모델 아키텍처",type:"diagram"}],tables:[],type:"pdf_page",category:"document_page",x:Math.cos(2/5*2*Math.PI)*200,y:Math.sin(2/5*2*Math.PI)*200,z:40,color:"#2ecc71",wordCount:134,confidence:.9},{id:`page-${Date.now()}-4`,documentId:`pdf-doc-${Date.now()}`,documentTitle:e.replace(".pdf",""),pageNumber:4,title:"3. 구현 계획 및 일정",content:"3단계 Phase별 구현 계획...",summary:"데이터 플랫폼 구축부터 전사 적용까지 3단계 구현 로드맵",keywords:["구현계획","Phase","일정","로드맵","적용"],images:[],tables:[{id:"table-4-1",headers:["Phase","기간","주요활동"],rows:[]}],type:"pdf_page",category:"document_page",x:Math.cos(3/5*2*Math.PI)*200,y:Math.sin(3/5*2*Math.PI)*200,z:60,color:"#f39c12",wordCount:178,confidence:.9},{id:`page-${Date.now()}-5`,documentId:`pdf-doc-${Date.now()}`,documentTitle:e.replace(".pdf",""),pageNumber:5,title:"4. 기대 효과 및 ROI",content:"연간 50억원 비용 절감, ROI 150%...",summary:"정량적/정성적 효과 분석 및 3년간 ROI 150% 달성 계획",keywords:["ROI","비용절감","50억원","150%","기대효과"],images:[{id:"img-5-1",description:"ROI 추이 그래프",type:"chart"}],tables:[{id:"table-5-1",headers:["구분","1년차","2년차","3년차"],rows:[]}],type:"pdf_page",category:"document_page",x:Math.cos(4/5*2*Math.PI)*200,y:Math.sin(4/5*2*Math.PI)*200,z:80,color:"#9b59b6",wordCount:145,confidence:.9}],s=[];for(let i=0;i<a.length-1;i++)s.push({source:a[i].id,target:a[i+1].id,type:"next_page",strength:1,evidence:"순차적 페이지"});s.push({source:a[1].id,target:a[2].id,type:"similar_topic",strength:.8,evidence:"현황 분석 → 솔루션 연결"}),s.push({source:a[2].id,target:a[4].id,type:"similar_topic",strength:.7,evidence:"솔루션 → 효과 연결"});const n=Date.now()-r;return{id:`pdf-doc-${Date.now()}`,filename:e,title:e.replace(".pdf",""),totalPages:a.length,pageNodes:a,pageRelationships:s,documentSummary:`${a.length}페이지 제안서: S&OP 최적화를 통한 연간 50억원 절감 및 ROI 150% 달성 계획`,mainTopics:["S&OP","AI","Palantir","ROI","최적화"],metadata:{fileSize:t,processingTime:n,createdDate:new Date().toISOString()}}}async function Pr(e){const t=e.extractedEntities.filter(s=>s.confidence>=.75).map(s=>({type:"entity",data:s})),r=e.extractedRelationships.filter(s=>s.confidence>=.75).map(s=>({type:"relationship",data:s})),a=[...e.extractedEntities.filter(s=>s.confidence<.75&&s.confidence>=.5),...e.extractedRelationships.filter(s=>s.confidence<.75&&s.confidence>=.5)].map(s=>({type:s.source?"relationship":"entity",data:s,reason:`신뢰도 ${s.confidence.toFixed(2)} - 검토 필요`}));return{autoApproved:[...t,...r],needsReview:a,rejected:[]}}O.get("/",e=>e.render(M("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900",children:M("div",{id:"root"})})));var dn=(e,t=un)=>{const r=/\.([a-zA-Z0-9]+?)$/,a=e.match(r);if(!a)return;let s=t[a[1]];return s&&s.startsWith("text")&&(s+="; charset=utf-8"),s},fn={aac:"audio/aac",avi:"video/x-msvideo",avif:"image/avif",av1:"video/av1",bin:"application/octet-stream",bmp:"image/bmp",css:"text/css",csv:"text/csv",eot:"application/vnd.ms-fontobject",epub:"application/epub+zip",gif:"image/gif",gz:"application/gzip",htm:"text/html",html:"text/html",ico:"image/x-icon",ics:"text/calendar",jpeg:"image/jpeg",jpg:"image/jpeg",js:"text/javascript",json:"application/json",jsonld:"application/ld+json",map:"application/json",mid:"audio/x-midi",midi:"audio/x-midi",mjs:"text/javascript",mp3:"audio/mpeg",mp4:"video/mp4",mpeg:"video/mpeg",oga:"audio/ogg",ogv:"video/ogg",ogx:"application/ogg",opus:"audio/opus",otf:"font/otf",pdf:"application/pdf",png:"image/png",rtf:"application/rtf",svg:"image/svg+xml",tif:"image/tiff",tiff:"image/tiff",ts:"video/mp2t",ttf:"font/ttf",txt:"text/plain",wasm:"application/wasm",webm:"video/webm",weba:"audio/webm",webmanifest:"application/manifest+json",webp:"image/webp",woff:"font/woff",woff2:"font/woff2",xhtml:"application/xhtml+xml",xml:"application/xml",zip:"application/zip","3gp":"video/3gpp","3g2":"video/3gpp2",gltf:"model/gltf+json",glb:"model/gltf-binary"},un=fn,hn=/^\s*(?:text\/[^;\s]+|application\/(?:javascript|json|xml|xml-dtd|ecmascript|dart|postscript|rtf|tar|toml|vnd\.dart|vnd\.ms-fontobject|vnd\.ms-opentype|wasm|x-httpd-php|x-javascript|x-ns-proxy-autoconfig|x-sh|x-tar|x-virtualbox-hdd|x-virtualbox-ova|x-virtualbox-ovf|x-virtualbox-vbox|x-virtualbox-vdi|x-virtualbox-vhd|x-virtualbox-vmdk|x-www-form-urlencoded)|font\/(?:otf|ttf)|image\/(?:bmp|vnd\.adobe\.photoshop|vnd\.microsoft\.icon|vnd\.ms-dds|x-icon|x-ms-bmp)|message\/rfc822|model\/gltf-binary|x-shader\/x-fragment|x-shader\/x-vertex|[^;\s]+?\+(?:json|text|xml|yaml))(?:[;\s]|$)/i,Ut={br:".br",zstd:".zst",gzip:".gz"},pn=Object.keys(Ut),Ir=e=>new ReadableStream({start(r){e.on("data",a=>{r.enqueue(a)}),e.on("end",()=>{r.close()})},cancel(){e.destroy()}}),$t=e=>{let t;try{t=Oa(e)}catch{}return t},rt=(e={root:""})=>{const t=e.root||"",r=e.path;return t!==""&&!Wt(t)&&console.error(`serveStatic: root path '${t}' is not found, are you sure it's correct?`),async(a,s)=>{var p,v,A,E;if(a.finalized)return s();let n;if(r)n=r;else try{if(n=decodeURIComponent(a.req.path),/(?:^|[\/\\])\.\.(?:$|[\/\\])/.test(n))throw new Error}catch{return await((p=e.onNotFound)==null?void 0:p.call(e,a.req.path,a)),s()}let i=He(t,!r&&e.rewriteRequestPath?e.rewriteRequestPath(n,a):n),l=$t(i);if(l&&l.isDirectory()){const R=e.index??"index.html";i=He(i,R),l=$t(i)}if(!l)return await((v=e.onNotFound)==null?void 0:v.call(e,i,a)),s();await((A=e.onFound)==null?void 0:A.call(e,i,a));const o=dn(i);if(a.header("Content-Type",o||"application/octet-stream"),e.precompressed&&(!o||hn.test(o))){const R=new Set((E=a.req.header("Accept-Encoding"))==null?void 0:E.split(",").map(C=>C.trim()));for(const C of pn){if(!R.has(C))continue;const U=$t(i+Ut[C]);if(U){a.header("Content-Encoding",C),a.header("Vary","Accept-Encoding",{append:!0}),l=U,i=i+Ut[C];break}}}const c=l.size;if(a.req.method=="HEAD"||a.req.method=="OPTIONS")return a.header("Content-Length",c.toString()),a.status(200),a.body(null);const d=a.req.header("range")||"";if(!d)return a.header("Content-Length",c.toString()),a.body(Ir(sr(i)),200);a.header("Accept-Ranges","bytes"),a.header("Date",l.birthtime.toUTCString());const h=d.replace(/bytes=/,"").split("-",2),f=parseInt(h[0],10)||0;let g=parseInt(h[1],10)||c-1;c<g-f+1&&(g=c-1);const m=g-f+1,y=sr(i,{start:f,end:g});return a.header("Content-Length",m.toString()),a.header("Content-Range",`bytes ${f}-${g}/${l.size}`),a.body(Ir(y),206)}},fe=class extends Error{constructor(e,t){super(e,t),this.name="RequestError"}},gn=e=>e instanceof fe?e:new fe(e.message,{cause:e}),yn=global.Request,Be=class extends yn{constructor(t,r){var a;typeof t=="object"&&Oe in t&&(t=t[Oe]()),typeof((a=r==null?void 0:r.body)==null?void 0:a.getReader)<"u"&&(r.duplex??(r.duplex="half")),super(t,r)}},mn=e=>{const t=[],r=e.rawHeaders;for(let a=0;a<r.length;a+=2){const{[a]:s,[a+1]:n}=r;s.charCodeAt(0)!==58&&t.push([s,n])}return new Headers(t)},Aa=Symbol("wrapBodyStream"),vn=(e,t,r,a,s)=>{const n={method:e,headers:r,signal:s.signal};if(e==="TRACE"){n.method="GET";const i=new Be(t,n);return Object.defineProperty(i,"method",{get(){return"TRACE"}}),i}if(!(e==="GET"||e==="HEAD"))if("rawBody"in a&&a.rawBody instanceof Buffer)n.body=new ReadableStream({start(i){i.enqueue(a.rawBody),i.close()}});else if(a[Aa]){let i;n.body=new ReadableStream({async pull(l){try{i||(i=nr.toWeb(a).getReader());const{done:o,value:c}=await i.read();o?l.close():l.enqueue(c)}catch(o){l.error(o)}}})}else n.body=nr.toWeb(a);return new Be(t,n)},Oe=Symbol("getRequestCache"),Dt=Symbol("requestCache"),yt=Symbol("incomingKey"),xt=Symbol("urlKey"),Nt=Symbol("headersKey"),Q=Symbol("abortControllerKey"),wn=Symbol("getAbortController"),At={get method(){return this[yt].method||"GET"},get url(){return this[xt]},get headers(){return this[Nt]||(this[Nt]=mn(this[yt]))},[wn](){return this[Oe](),this[Q]},[Oe](){return this[Q]||(this[Q]=new AbortController),this[Dt]||(this[Dt]=vn(this.method,this[xt],this.headers,this[yt],this[Q]))}};["body","bodyUsed","cache","credentials","destination","integrity","mode","redirect","referrer","referrerPolicy","signal","keepalive"].forEach(e=>{Object.defineProperty(At,e,{get(){return this[Oe]()[e]}})});["arrayBuffer","blob","clone","formData","json","text"].forEach(e=>{Object.defineProperty(At,e,{value:function(){return this[Oe]()[e]()}})});Object.setPrototypeOf(At,Be.prototype);var xn=(e,t)=>{const r=Object.create(At);r[yt]=e;const a=e.url||"";if(a[0]!=="/"&&(a.startsWith("http://")||a.startsWith("https://"))){if(e instanceof ot)throw new fe("Absolute URL for :path is not allowed in HTTP/2");try{const l=new URL(a);r[xt]=l.href}catch(l){throw new fe("Invalid absolute URL",{cause:l})}return r}const s=(e instanceof ot?e.authority:e.headers.host)||t;if(!s)throw new fe("Missing host header");let n;if(e instanceof ot){if(n=e.scheme,!(n==="http"||n==="https"))throw new fe("Unsupported scheme")}else n=e.socket&&e.socket.encrypted?"https":"http";const i=new URL(`${n}://${s}${a}`);if(i.hostname.length!==s.length&&i.hostname!==s.replace(/:\d+$/,""))throw new fe("Invalid host header");return r[xt]=i.href,r},it=Symbol("responseCache"),Re=Symbol("getResponseCache"),ue=Symbol("cache"),er=global.Response,Ze,Y,Te,at=(Te=class{constructor(t,r){b(this,Ze);b(this,Y);let a;if(x(this,Ze,t),r instanceof Te){const s=r[it];if(s){x(this,Y,s),this[Re]();return}else x(this,Y,u(r,Y)),a=new Headers(u(r,Y).headers)}else x(this,Y,r);(typeof t=="string"||typeof(t==null?void 0:t.getReader)<"u"||t instanceof Blob||t instanceof Uint8Array)&&(a||(a=(r==null?void 0:r.headers)||{"content-type":"text/plain; charset=UTF-8"}),this[ue]=[(r==null?void 0:r.status)||200,t,a])}[Re](){return delete this[ue],this[it]||(this[it]=new er(u(this,Ze),u(this,Y)))}get headers(){const t=this[ue];return t?(t[2]instanceof Headers||(t[2]=new Headers(t[2])),t[2]):this[Re]().headers}get status(){var t;return((t=this[ue])==null?void 0:t[0])??this[Re]().status}get ok(){const t=this.status;return t>=200&&t<300}},Ze=new WeakMap,Y=new WeakMap,Te);["body","bodyUsed","redirected","statusText","trailers","type","url"].forEach(e=>{Object.defineProperty(at.prototype,e,{get(){return this[Re]()[e]}})});["arrayBuffer","blob","clone","formData","json","text"].forEach(e=>{Object.defineProperty(at.prototype,e,{value:function(){return this[Re]()[e]()}})});Object.setPrototypeOf(at,er);Object.setPrototypeOf(at.prototype,er.prototype);async function bn(e){return Promise.race([e,Promise.resolve().then(()=>Promise.resolve(void 0))])}function Ra(e,t,r){const a=()=>{};return t.on("error",a),(r??e.read()).then(i,s),e.closed.finally(()=>{t.off("error",a)});function s(l){l&&t.destroy(l)}function n(){e.read().then(i,s)}function i({done:l,value:o}){try{if(l)t.end();else if(!t.write(o))t.once("drain",n);else return e.read().then(i,s)}catch(c){s(c)}}}function An(e,t){if(e.locked)throw new TypeError("ReadableStream is locked.");return t.destroyed?void 0:Ra(e.getReader(),t)}var Ea=e=>{const t={};e instanceof Headers||(e=new Headers(e??void 0));const r=[];for(const[a,s]of e)a==="set-cookie"?r.push(s):t[a]=s;return r.length>0&&(t["set-cookie"]=r),t["content-type"]??(t["content-type"]="text/plain; charset=UTF-8"),t},Rn="x-hono-already-sent",En=global.fetch;typeof global.crypto>"u"&&(global.crypto=$a);global.fetch=(e,t)=>(t={compress:!1,...t},En(e,t));var tr=Symbol("outgoingEnded"),Sn=()=>new Response(null,{status:400}),Sa=e=>new Response(null,{status:e instanceof Error&&(e.name==="TimeoutError"||e.constructor.name==="TimeoutError")?504:500}),Bt=(e,t)=>{const r=e instanceof Error?e:new Error("unknown error",{cause:e});r.code==="ERR_STREAM_PREMATURE_CLOSE"?console.info("The user aborted a request."):(console.error(e),t.headersSent||t.writeHead(500,{"Content-Type":"text/plain"}),t.end(`Error: ${r.message}`),t.destroy(r))},Ca=e=>{"flushHeaders"in e&&e.writable&&e.flushHeaders()},Pa=async(e,t)=>{var n,i;let[r,a,s]=e[ue];s instanceof Headers&&(s=Ea(s)),typeof a=="string"?s["Content-Length"]=Buffer.byteLength(a):a instanceof Uint8Array?s["Content-Length"]=a.byteLength:a instanceof Blob&&(s["Content-Length"]=a.size),t.writeHead(r,s),typeof a=="string"||a instanceof Uint8Array?t.end(a):a instanceof Blob?t.end(new Uint8Array(await a.arrayBuffer())):(Ca(t),await((n=An(a,t))==null?void 0:n.catch(l=>Bt(l,t)))),(i=t[tr])==null||i.call(t)},Cn=async(e,t,r={})=>{var s;if(e instanceof Promise)if(r.errorHandler)try{e=await e}catch(n){const i=await r.errorHandler(n);if(!i)return;e=i}else e=await e.catch(Sa);if(ue in e)return Pa(e,t);const a=Ea(e.headers);if(e.body){const n=e.body.getReader(),i=[];let l=!1,o;if(a["transfer-encoding"]!=="chunked"){let c=2;for(let d=0;d<c;d++){o||(o=n.read());const h=await bn(o).catch(f=>{console.error(f),l=!0});if(!h){if(d===1){await new Promise(f=>setTimeout(f)),c=3;continue}break}if(o=void 0,h.value&&i.push(h.value),h.done){l=!0;break}}l&&!("content-length"in a)&&(a["content-length"]=i.reduce((d,h)=>d+h.length,0))}t.writeHead(e.status,a),i.forEach(c=>{t.write(c)}),l?t.end():(i.length===0&&Ca(t),await Ra(n,t,o))}else a[Rn]||(t.writeHead(e.status,a),t.end());(s=t[tr])==null||s.call(t)},Pn=(e,t={})=>{const r=t.autoCleanupIncoming??!0;return t.overrideGlobalObjects!==!1&&global.Request!==Be&&(Object.defineProperty(global,"Request",{value:Be}),Object.defineProperty(global,"Response",{value:at})),async(a,s)=>{let n,i;try{i=xn(a,t.hostname);let l=!r||a.method==="GET"||a.method==="HEAD";if(l||(a[Aa]=!0,a.on("end",()=>{l=!0}),a instanceof ot&&(s[tr]=()=>{l||setTimeout(()=>{l||setTimeout(()=>{a.destroy(),s.destroy()})})})),s.on("close",()=>{i[Q]&&(a.errored?i[Q].abort(a.errored.toString()):s.writableFinished||i[Q].abort("Client connection prematurely closed.")),l||setTimeout(()=>{l||setTimeout(()=>{a.destroy()})})}),n=e(i,{incoming:a,outgoing:s}),ue in n)return Pa(n,s)}catch(l){if(n)return Bt(l,s);if(t.errorHandler){if(n=await t.errorHandler(i?l:gn(l)),!n)return}else i?n=Sa(l):n=Sn()}try{return await Cn(n,s,t)}catch(l){return Bt(l,s)}}},In=e=>{const t=e.fetch,r=Pn(t,{hostname:e.hostname,overrideGlobalObjects:e.overrideGlobalObjects,autoCleanupIncoming:e.autoCleanupIncoming});return(e.createServer||ja)(e.serverOptions||{},r)},Tn=(e,t)=>{const r=In(e);return r.listen(e==null?void 0:e.port,e.hostname,()=>{r.address()}),r};const oe=new ua;oe.use("/favicon.ico",rt({root:"./"}));oe.use("/static/*",rt({root:"./"}));oe.use("/_routes.json",rt({root:"./"}));oe.use("/_worker.js",rt({root:"./"}));oe.use("/inline.html",rt({root:"./"}));const kn=Object.assign({"/src/index.tsx":O});let Ia=!1;for(const[,e]of Object.entries(kn))e&&(oe.all("*",t=>{let r;try{r=t.executionCtx}catch{}return e.fetch(t.req.raw,t.env,r)}),oe.notFound(t=>{let r;try{r=t.executionCtx}catch{}return e.fetch(t.req.raw,t.env,r)}),Ia=!0);if(!Ia)throw new Error("Can't import modules from ['/src/index.tsx']");Tn({fetch:oe.fetch,port:3e3});export{oe as default};
