var Za=Object.defineProperty;var Tt=e=>{throw TypeError(e)};var Ya=(e,t,a)=>t in e?Za(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a;var w=(e,t,a)=>Ya(e,typeof t!="symbol"?t+"":t,a),nt=(e,t,a)=>t.has(e)||Tt("Cannot "+a);var u=(e,t,a)=>(nt(e,t,"read from private field"),a?a.call(e):t.get(e)),b=(e,t,a)=>t.has(e)?Tt("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,a),x=(e,t,a,i)=>(nt(e,t,"write to private field"),i?i.call(e,a):t.set(e,a),a),S=(e,t,a)=>(nt(e,t,"access private method"),a);var kt=(e,t,a,i)=>({set _(r){x(e,t,r,a)},get _(){return u(e,t,i)}});var da={Stringify:1},z=(e,t)=>{const a=new String(e);return a.isEscaped=!0,a.callbacks=t,a},Qa=/[&<>'"]/,fa=async(e,t)=>{let a="";t||(t=[]);const i=await Promise.all(e);for(let r=i.length-1;a+=i[r],r--,!(r<0);r--){let s=i[r];typeof s=="object"&&t.push(...s.callbacks||[]);const o=s.isEscaped;if(s=await(typeof s=="object"?s.toString():s),typeof s=="object"&&t.push(...s.callbacks||[]),s.isEscaped??o)a+=s;else{const l=[a];ie(s,l),a=l[0]}}return z(a,t)},ie=(e,t)=>{const a=e.search(Qa);if(a===-1){t[0]+=e;return}let i,r,s=0;for(r=a;r<e.length;r++){switch(e.charCodeAt(r)){case 34:i="&quot;";break;case 39:i="&#39;";break;case 38:i="&amp;";break;case 60:i="&lt;";break;case 62:i="&gt;";break;default:continue}t[0]+=e.substring(s,r)+i,s=r+1}t[0]+=e.substring(s,r)},ua=e=>{const t=e.callbacks;if(!(t!=null&&t.length))return e;const a=[e],i={};return t.forEach(r=>r({phase:da.Stringify,buffer:a,context:i})),a[0]},ha=async(e,t,a,i,r)=>{typeof e=="object"&&!(e instanceof String)&&(e instanceof Promise||(e=e.toString()),e instanceof Promise&&(e=await e));const s=e.callbacks;return s!=null&&s.length?(r?r[0]+=e:r=[e],Promise.all(s.map(l=>l({phase:t,buffer:r,context:i}))).then(l=>Promise.all(l.filter(Boolean).map(n=>ha(n,t,!1,i,r))).then(()=>r[0]))):Promise.resolve(e)},ei=(e,...t)=>{const a=[""];for(let i=0,r=e.length-1;i<r;i++){a[0]+=e[i];const s=Array.isArray(t[i])?t[i].flat(1/0):[t[i]];for(let o=0,l=s.length;o<l;o++){const n=s[o];if(typeof n=="string")ie(n,a);else if(typeof n=="number")a[0]+=n;else{if(typeof n=="boolean"||n===null||n===void 0)continue;if(typeof n=="object"&&n.isEscaped)if(n.callbacks)a.unshift("",n);else{const c=n.toString();c instanceof Promise?a.unshift("",c):a[0]+=c}else n instanceof Promise?a.unshift("",n):ie(n.toString(),a)}}}return a[0]+=e.at(-1),a.length===1?"callbacks"in a?z(ua(z(a[0],a.callbacks))):z(a[0]):fa(a,a.callbacks)},At=Symbol("RENDERER"),yt=Symbol("ERROR_HANDLER"),I=Symbol("STASH"),ga=Symbol("INTERNAL"),ti=Symbol("MEMO"),tt=Symbol("PERMALINK"),Mt=e=>(e[ga]=!0,e),pa=e=>({value:t,children:a})=>{if(!a)return;const i={children:[{tag:Mt(()=>{e.push(t)}),props:{}}]};Array.isArray(a)?i.children.push(...a.flat()):i.children.push(a),i.children.push({tag:Mt(()=>{e.pop()}),props:{}});const r={tag:"",props:i,type:""};return r[yt]=s=>{throw e.pop(),s},r},ya=e=>{const t=[e],a=pa(t);return a.values=t,a.Provider=a,Ee.push(a),a},Ee=[],Et=e=>{const t=[e],a=i=>{t.push(i.value);let r;try{r=i.children?(Array.isArray(i.children)?new xa("",{},i.children):i.children).toString():""}finally{t.pop()}return r instanceof Promise?r.then(s=>z(s,s.callbacks)):z(r)};return a.values=t,a.Provider=a,a[At]=pa(t),Ee.push(a),a},Pe=e=>e.values.at(-1),Ge={title:[],script:["src"],style:["data-href"],link:["href"],meta:["name","httpEquiv","charset","itemProp"]},mt={},Ve="data-precedence",Fe=e=>Array.isArray(e)?e:[e],Ot=new WeakMap,Nt=(e,t,a,i)=>({buffer:r,context:s})=>{if(!r)return;const o=Ot.get(s)||{};Ot.set(s,o);const l=o[e]||(o[e]=[]);let n=!1;const c=Ge[e];if(c.length>0){e:for(const[,d]of l)for(const h of c)if(((d==null?void 0:d[h])??null)===(a==null?void 0:a[h])){n=!0;break e}}if(n?r[0]=r[0].replaceAll(t,""):c.length>0?l.push([t,a,i]):l.unshift([t,a,i]),r[0].indexOf("</head>")!==-1){let d;if(i===void 0)d=l.map(([h])=>h);else{const h=[];d=l.map(([f,,y])=>{let m=h.indexOf(y);return m===-1&&(h.push(y),m=h.length-1),[f,m]}).sort((f,y)=>f[1]-y[1]).map(([f])=>f)}d.forEach(h=>{r[0]=r[0].replaceAll(h,"")}),r[0]=r[0].replace(/(?=<\/head>)/,d.join(""))}},qe=(e,t,a)=>z(new q(e,a,Fe(t??[])).toString()),Ue=(e,t,a,i)=>{if("itemProp"in a)return qe(e,t,a);let{precedence:r,blocking:s,...o}=a;r=i?r??"":void 0,i&&(o[Ve]=r);const l=new q(e,o,Fe(t||[])).toString();return l instanceof Promise?l.then(n=>z(l,[...n.callbacks||[],Nt(e,n,o,r)])):z(l,[Nt(e,l,o,r)])},ai=({children:e,...t})=>{const a=St();if(a){const i=Pe(a);if(i==="svg"||i==="head")return new q("title",t,Fe(e??[]))}return Ue("title",e,t,!1)},ii=({children:e,...t})=>{const a=St();return["src","async"].some(i=>!t[i])||a&&Pe(a)==="head"?qe("script",e,t):Ue("script",e,t,!1)},ri=({children:e,...t})=>["href","precedence"].every(a=>a in t)?(t["data-href"]=t.href,delete t.href,Ue("style",e,t,!0)):qe("style",e,t),si=({children:e,...t})=>["onLoad","onError"].some(a=>a in t)||t.rel==="stylesheet"&&(!("precedence"in t)||"disabled"in t)?qe("link",e,t):Ue("link",e,t,"precedence"in t),ni=({children:e,...t})=>{const a=St();return a&&Pe(a)==="head"?qe("meta",e,t):Ue("meta",e,t,!1)},ma=(e,{children:t,...a})=>new q(e,a,Fe(t??[])),oi=e=>(typeof e.action=="function"&&(e.action=tt in e.action?e.action[tt]:void 0),ma("form",e)),va=(e,t)=>(typeof t.formAction=="function"&&(t.formAction=tt in t.formAction?t.formAction[tt]:void 0),ma(e,t)),li=e=>va("input",e),ci=e=>va("button",e);const ot=Object.freeze(Object.defineProperty({__proto__:null,button:ci,form:oi,input:li,link:si,meta:ni,script:ii,style:ri,title:ai},Symbol.toStringTag,{value:"Module"}));var di=new Map([["className","class"],["htmlFor","for"],["crossOrigin","crossorigin"],["httpEquiv","http-equiv"],["itemProp","itemprop"],["fetchPriority","fetchpriority"],["noModule","nomodule"],["formAction","formaction"]]),at=e=>di.get(e)||e,wa=(e,t)=>{for(const[a,i]of Object.entries(e)){const r=a[0]==="-"||!/[A-Z]/.test(a)?a:a.replace(/[A-Z]/g,s=>`-${s.toLowerCase()}`);t(r,i==null?null:typeof i=="number"?r.match(/^(?:a|border-im|column(?:-c|s)|flex(?:$|-[^b])|grid-(?:ar|[^a])|font-w|li|or|sca|st|ta|wido|z)|ty$/)?`${i}`:`${i}px`:i)}},Oe=void 0,St=()=>Oe,fi=e=>/[A-Z]/.test(e)&&e.match(/^(?:al|basel|clip(?:Path|Rule)$|co|do|fill|fl|fo|gl|let|lig|i|marker[EMS]|o|pai|pointe|sh|st[or]|text[^L]|tr|u|ve|w)/)?e.replace(/([A-Z])/g,"-$1").toLowerCase():e,ui=["area","base","br","col","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],hi=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","defer","disabled","download","formnovalidate","hidden","inert","ismap","itemscope","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"],Ct=(e,t)=>{for(let a=0,i=e.length;a<i;a++){const r=e[a];if(typeof r=="string")ie(r,t);else{if(typeof r=="boolean"||r===null||r===void 0)continue;r instanceof q?r.toStringToBuffer(t):typeof r=="number"||r.isEscaped?t[0]+=r:r instanceof Promise?t.unshift("",r):Ct(r,t)}}},q=class{constructor(e,t,a){w(this,"tag");w(this,"props");w(this,"key");w(this,"children");w(this,"isEscaped",!0);w(this,"localContexts");this.tag=e,this.props=t,this.children=a}get type(){return this.tag}get ref(){return this.props.ref||null}toString(){var t,a;const e=[""];(t=this.localContexts)==null||t.forEach(([i,r])=>{i.values.push(r)});try{this.toStringToBuffer(e)}finally{(a=this.localContexts)==null||a.forEach(([i])=>{i.values.pop()})}return e.length===1?"callbacks"in e?ua(z(e[0],e.callbacks)).toString():e[0]:fa(e,e.callbacks)}toStringToBuffer(e){const t=this.tag,a=this.props;let{children:i}=this;e[0]+=`<${t}`;const r=Oe&&Pe(Oe)==="svg"?s=>fi(at(s)):s=>at(s);for(let[s,o]of Object.entries(a))if(s=r(s),s!=="children"){if(s==="style"&&typeof o=="object"){let l="";wa(o,(n,c)=>{c!=null&&(l+=`${l?";":""}${n}:${c}`)}),e[0]+=' style="',ie(l,e),e[0]+='"'}else if(typeof o=="string")e[0]+=` ${s}="`,ie(o,e),e[0]+='"';else if(o!=null)if(typeof o=="number"||o.isEscaped)e[0]+=` ${s}="${o}"`;else if(typeof o=="boolean"&&hi.includes(s))o&&(e[0]+=` ${s}=""`);else if(s==="dangerouslySetInnerHTML"){if(i.length>0)throw new Error("Can only set one of `children` or `props.dangerouslySetInnerHTML`.");i=[z(o.__html)]}else if(o instanceof Promise)e[0]+=` ${s}="`,e.unshift('"',o);else if(typeof o=="function"){if(!s.startsWith("on")&&s!=="ref")throw new Error(`Invalid prop '${s}' of type 'function' supplied to '${t}'.`)}else e[0]+=` ${s}="`,ie(o.toString(),e),e[0]+='"'}if(ui.includes(t)&&i.length===0){e[0]+="/>";return}e[0]+=">",Ct(i,e),e[0]+=`</${t}>`}},lt=class extends q{toStringToBuffer(e){const{children:t}=this,a=this.tag.call(null,{...this.props,children:t.length<=1?t[0]:t});if(!(typeof a=="boolean"||a==null))if(a instanceof Promise)if(Ee.length===0)e.unshift("",a);else{const i=Ee.map(r=>[r,r.values.at(-1)]);e.unshift("",a.then(r=>(r instanceof q&&(r.localContexts=i),r)))}else a instanceof q?a.toStringToBuffer(e):typeof a=="number"||a.isEscaped?(e[0]+=a,a.callbacks&&(e.callbacks||(e.callbacks=[]),e.callbacks.push(...a.callbacks))):ie(a,e)}},xa=class extends q{toStringToBuffer(e){Ct(this.children,e)}},Dt=(e,t,...a)=>{t??(t={}),a.length&&(t.children=a.length===1?a[0]:a);const i=t.key;delete t.key;const r=Xe(e,t,a);return r.key=i,r},jt=!1,Xe=(e,t,a)=>{if(!jt){for(const i in mt)ot[i][At]=mt[i];jt=!0}return typeof e=="function"?new lt(e,t,a):ot[e]?new lt(ot[e],t,a):e==="svg"||e==="head"?(Oe||(Oe=Et("")),new q(e,t,[new lt(Oe,{value:e},a)])):new q(e,t,a)},gi=({children:e})=>new xa("",{children:e},Array.isArray(e)?e:e?[e]:[]);function k(e,t,a){let i;if(!t||!("children"in t))i=Xe(e,t,[]);else{const r=t.children;i=Array.isArray(r)?Xe(e,t,r):Xe(e,t,[r])}return i.key=a,i}var $t=(e,t,a)=>(i,r)=>{let s=-1;return o(0);async function o(l){if(l<=s)throw new Error("next() called multiple times");s=l;let n,c=!1,d;if(e[l]?(d=e[l][0][0],i.req.routeIndex=l):d=l===e.length&&r||void 0,d)try{n=await d(i,()=>o(l+1))}catch(h){if(h instanceof Error&&t)i.error=h,n=await t(h,i),c=!0;else throw h}else i.finalized===!1&&a&&(n=await a(i));return n&&(i.finalized===!1||c)&&(i.res=n),i}},pi=Symbol(),yi=async(e,t=Object.create(null))=>{const{all:a=!1,dot:i=!1}=t,s=(e instanceof Pa?e.raw.headers:e.headers).get("Content-Type");return s!=null&&s.startsWith("multipart/form-data")||s!=null&&s.startsWith("application/x-www-form-urlencoded")?mi(e,{all:a,dot:i}):{}};async function mi(e,t){const a=await e.formData();return a?vi(a,t):{}}function vi(e,t){const a=Object.create(null);return e.forEach((i,r)=>{t.all||r.endsWith("[]")?wi(a,r,i):a[r]=i}),t.dot&&Object.entries(a).forEach(([i,r])=>{i.includes(".")&&(xi(a,i,r),delete a[i])}),a}var wi=(e,t,a)=>{e[t]!==void 0?Array.isArray(e[t])?e[t].push(a):e[t]=[e[t],a]:t.endsWith("[]")?e[t]=[a]:e[t]=a},xi=(e,t,a)=>{let i=e;const r=t.split(".");r.forEach((s,o)=>{o===r.length-1?i[s]=a:((!i[s]||typeof i[s]!="object"||Array.isArray(i[s])||i[s]instanceof File)&&(i[s]=Object.create(null)),i=i[s])})},ba=e=>{const t=e.split("/");return t[0]===""&&t.shift(),t},bi=e=>{const{groups:t,path:a}=Ai(e),i=ba(a);return Ei(i,t)},Ai=e=>{const t=[];return e=e.replace(/\{[^}]+\}/g,(a,i)=>{const r=`@${i}`;return t.push([r,a]),r}),{groups:t,path:e}},Ei=(e,t)=>{for(let a=t.length-1;a>=0;a--){const[i]=t[a];for(let r=e.length-1;r>=0;r--)if(e[r].includes(i)){e[r]=e[r].replace(i,t[a][1]);break}}return e},Be={},Si=(e,t)=>{if(e==="*")return"*";const a=e.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/);if(a){const i=`${e}#${t}`;return Be[i]||(a[2]?Be[i]=t&&t[0]!==":"&&t[0]!=="*"?[i,a[1],new RegExp(`^${a[2]}(?=/${t})`)]:[e,a[1],new RegExp(`^${a[2]}$`)]:Be[i]=[e,a[1],!0]),Be[i]}return null},Pt=(e,t)=>{try{return t(e)}catch{return e.replace(/(?:%[0-9A-Fa-f]{2})+/g,a=>{try{return t(a)}catch{return a}})}},Ci=e=>Pt(e,decodeURI),Aa=e=>{const t=e.url,a=t.indexOf("/",t.indexOf(":")+4);let i=a;for(;i<t.length;i++){const r=t.charCodeAt(i);if(r===37){const s=t.indexOf("?",i),o=t.slice(a,s===-1?void 0:s);return Ci(o.includes("%25")?o.replace(/%25/g,"%2525"):o)}else if(r===63)break}return t.slice(a,i)},Pi=e=>{const t=Aa(e);return t.length>1&&t.at(-1)==="/"?t.slice(0,-1):t},pe=(e,t,...a)=>(a.length&&(t=pe(t,...a)),`${(e==null?void 0:e[0])==="/"?"":"/"}${e}${t==="/"?"":`${(e==null?void 0:e.at(-1))==="/"?"":"/"}${(t==null?void 0:t[0])==="/"?t.slice(1):t}`}`),Ea=e=>{if(e.charCodeAt(e.length-1)!==63||!e.includes(":"))return null;const t=e.split("/"),a=[];let i="";return t.forEach(r=>{if(r!==""&&!/\:/.test(r))i+="/"+r;else if(/\:/.test(r))if(/\?/.test(r)){a.length===0&&i===""?a.push("/"):a.push(i);const s=r.replace("?","");i+="/"+s,a.push(i)}else i+="/"+r}),a.filter((r,s,o)=>o.indexOf(r)===s)},ct=e=>/[%+]/.test(e)?(e.indexOf("+")!==-1&&(e=e.replace(/\+/g," ")),e.indexOf("%")!==-1?Pt(e,Ca):e):e,Sa=(e,t,a)=>{let i;if(!a&&t&&!/[%+]/.test(t)){let o=e.indexOf(`?${t}`,8);for(o===-1&&(o=e.indexOf(`&${t}`,8));o!==-1;){const l=e.charCodeAt(o+t.length+1);if(l===61){const n=o+t.length+2,c=e.indexOf("&",n);return ct(e.slice(n,c===-1?void 0:c))}else if(l==38||isNaN(l))return"";o=e.indexOf(`&${t}`,o+1)}if(i=/[%+]/.test(e),!i)return}const r={};i??(i=/[%+]/.test(e));let s=e.indexOf("?",8);for(;s!==-1;){const o=e.indexOf("&",s+1);let l=e.indexOf("=",s);l>o&&o!==-1&&(l=-1);let n=e.slice(s+1,l===-1?o===-1?void 0:o:l);if(i&&(n=ct(n)),s=o,n==="")continue;let c;l===-1?c="":(c=e.slice(l+1,o===-1?void 0:o),i&&(c=ct(c))),a?(r[n]&&Array.isArray(r[n])||(r[n]=[]),r[n].push(c)):r[n]??(r[n]=c)}return t?r[t]:r},Ii=Sa,Ri=(e,t)=>Sa(e,t,!0),Ca=decodeURIComponent,_t=e=>Pt(e,Ca),ve,_,X,Ia,Ra,vt,Z,ta,Pa=(ta=class{constructor(e,t="/",a=[[]]){b(this,X);w(this,"raw");b(this,ve);b(this,_);w(this,"routeIndex",0);w(this,"path");w(this,"bodyCache",{});b(this,Z,e=>{const{bodyCache:t,raw:a}=this,i=t[e];if(i)return i;const r=Object.keys(t)[0];return r?t[r].then(s=>(r==="json"&&(s=JSON.stringify(s)),new Response(s)[e]())):t[e]=a[e]()});this.raw=e,this.path=t,x(this,_,a),x(this,ve,{})}param(e){return e?S(this,X,Ia).call(this,e):S(this,X,Ra).call(this)}query(e){return Ii(this.url,e)}queries(e){return Ri(this.url,e)}header(e){if(e)return this.raw.headers.get(e)??void 0;const t={};return this.raw.headers.forEach((a,i)=>{t[i]=a}),t}async parseBody(e){var t;return(t=this.bodyCache).parsedBody??(t.parsedBody=await yi(this,e))}json(){return u(this,Z).call(this,"text").then(e=>JSON.parse(e))}text(){return u(this,Z).call(this,"text")}arrayBuffer(){return u(this,Z).call(this,"arrayBuffer")}blob(){return u(this,Z).call(this,"blob")}formData(){return u(this,Z).call(this,"formData")}addValidatedData(e,t){u(this,ve)[e]=t}valid(e){return u(this,ve)[e]}get url(){return this.raw.url}get method(){return this.raw.method}get[pi](){return u(this,_)}get matchedRoutes(){return u(this,_)[0].map(([[,e]])=>e)}get routePath(){return u(this,_)[0].map(([[,e]])=>e)[this.routeIndex].path}},ve=new WeakMap,_=new WeakMap,X=new WeakSet,Ia=function(e){const t=u(this,_)[0][this.routeIndex][1][e],a=S(this,X,vt).call(this,t);return a?/\%/.test(a)?_t(a):a:void 0},Ra=function(){const e={},t=Object.keys(u(this,_)[0][this.routeIndex][1]);for(const a of t){const i=S(this,X,vt).call(this,u(this,_)[0][this.routeIndex][1][a]);i&&typeof i=="string"&&(e[a]=/\%/.test(i)?_t(i):i)}return e},vt=function(e){return u(this,_)[1]?u(this,_)[1][e]:e},Z=new WeakMap,ta),Ti="text/plain; charset=UTF-8",dt=(e,t)=>({"Content-Type":e,...t}),je,$e,B,we,K,j,_e,xe,be,oe,ze,Le,Y,ye,aa,ki=(aa=class{constructor(e,t){b(this,Y);b(this,je);b(this,$e);w(this,"env",{});b(this,B);w(this,"finalized",!1);w(this,"error");b(this,we);b(this,K);b(this,j);b(this,_e);b(this,xe);b(this,be);b(this,oe);b(this,ze);b(this,Le);w(this,"render",(...e)=>(u(this,xe)??x(this,xe,t=>this.html(t)),u(this,xe).call(this,...e)));w(this,"setLayout",e=>x(this,_e,e));w(this,"getLayout",()=>u(this,_e));w(this,"setRenderer",e=>{x(this,xe,e)});w(this,"header",(e,t,a)=>{this.finalized&&x(this,j,new Response(u(this,j).body,u(this,j)));const i=u(this,j)?u(this,j).headers:u(this,oe)??x(this,oe,new Headers);t===void 0?i.delete(e):a!=null&&a.append?i.append(e,t):i.set(e,t)});w(this,"status",e=>{x(this,we,e)});w(this,"set",(e,t)=>{u(this,B)??x(this,B,new Map),u(this,B).set(e,t)});w(this,"get",e=>u(this,B)?u(this,B).get(e):void 0);w(this,"newResponse",(...e)=>S(this,Y,ye).call(this,...e));w(this,"body",(e,t,a)=>S(this,Y,ye).call(this,e,t,a));w(this,"text",(e,t,a)=>!u(this,oe)&&!u(this,we)&&!t&&!a&&!this.finalized?new Response(e):S(this,Y,ye).call(this,e,t,dt(Ti,a)));w(this,"json",(e,t,a)=>S(this,Y,ye).call(this,JSON.stringify(e),t,dt("application/json",a)));w(this,"html",(e,t,a)=>{const i=r=>S(this,Y,ye).call(this,r,t,dt("text/html; charset=UTF-8",a));return typeof e=="object"?ha(e,da.Stringify,!1,{}).then(i):i(e)});w(this,"redirect",(e,t)=>{const a=String(e);return this.header("Location",/[^\x00-\xFF]/.test(a)?encodeURI(a):a),this.newResponse(null,t??302)});w(this,"notFound",()=>(u(this,be)??x(this,be,()=>new Response),u(this,be).call(this,this)));x(this,je,e),t&&(x(this,K,t.executionCtx),this.env=t.env,x(this,be,t.notFoundHandler),x(this,Le,t.path),x(this,ze,t.matchResult))}get req(){return u(this,$e)??x(this,$e,new Pa(u(this,je),u(this,Le),u(this,ze))),u(this,$e)}get event(){if(u(this,K)&&"respondWith"in u(this,K))return u(this,K);throw Error("This context has no FetchEvent")}get executionCtx(){if(u(this,K))return u(this,K);throw Error("This context has no ExecutionContext")}get res(){return u(this,j)||x(this,j,new Response(null,{headers:u(this,oe)??x(this,oe,new Headers)}))}set res(e){if(u(this,j)&&e){e=new Response(e.body,e);for(const[t,a]of u(this,j).headers.entries())if(t!=="content-type")if(t==="set-cookie"){const i=u(this,j).headers.getSetCookie();e.headers.delete("set-cookie");for(const r of i)e.headers.append("set-cookie",r)}else e.headers.set(t,a)}x(this,j,e),this.finalized=!0}get var(){return u(this,B)?Object.fromEntries(u(this,B)):{}}},je=new WeakMap,$e=new WeakMap,B=new WeakMap,we=new WeakMap,K=new WeakMap,j=new WeakMap,_e=new WeakMap,xe=new WeakMap,be=new WeakMap,oe=new WeakMap,ze=new WeakMap,Le=new WeakMap,Y=new WeakSet,ye=function(e,t,a){const i=u(this,j)?new Headers(u(this,j).headers):u(this,oe)??new Headers;if(typeof t=="object"&&"headers"in t){const s=t.headers instanceof Headers?t.headers:new Headers(t.headers);for(const[o,l]of s)o.toLowerCase()==="set-cookie"?i.append(o,l):i.set(o,l)}if(a)for(const[s,o]of Object.entries(a))if(typeof o=="string")i.set(s,o);else{i.delete(s);for(const l of o)i.append(s,l)}const r=typeof t=="number"?t:(t==null?void 0:t.status)??u(this,we);return new Response(e,{status:r,headers:i})},aa),R="ALL",Mi="all",Oi=["get","post","put","delete","options","patch"],Ta="Can not add a route since the matcher is already built.",ka=class extends Error{},Ni="__COMPOSED_HANDLER",Di=e=>e.text("404 Not Found",404),zt=(e,t)=>{if("getResponse"in e){const a=e.getResponse();return t.newResponse(a.body,a)}return console.error(e),t.text("Internal Server Error",500)},L,T,Oa,H,se,Je,Ze,ia,Ma=(ia=class{constructor(t={}){b(this,T);w(this,"get");w(this,"post");w(this,"put");w(this,"delete");w(this,"options");w(this,"patch");w(this,"all");w(this,"on");w(this,"use");w(this,"router");w(this,"getPath");w(this,"_basePath","/");b(this,L,"/");w(this,"routes",[]);b(this,H,Di);w(this,"errorHandler",zt);w(this,"onError",t=>(this.errorHandler=t,this));w(this,"notFound",t=>(x(this,H,t),this));w(this,"fetch",(t,...a)=>S(this,T,Ze).call(this,t,a[1],a[0],t.method));w(this,"request",(t,a,i,r)=>t instanceof Request?this.fetch(a?new Request(t,a):t,i,r):(t=t.toString(),this.fetch(new Request(/^https?:\/\//.test(t)?t:`http://localhost${pe("/",t)}`,a),i,r)));w(this,"fire",()=>{addEventListener("fetch",t=>{t.respondWith(S(this,T,Ze).call(this,t.request,t,void 0,t.request.method))})});[...Oi,Mi].forEach(s=>{this[s]=(o,...l)=>(typeof o=="string"?x(this,L,o):S(this,T,se).call(this,s,u(this,L),o),l.forEach(n=>{S(this,T,se).call(this,s,u(this,L),n)}),this)}),this.on=(s,o,...l)=>{for(const n of[o].flat()){x(this,L,n);for(const c of[s].flat())l.map(d=>{S(this,T,se).call(this,c.toUpperCase(),u(this,L),d)})}return this},this.use=(s,...o)=>(typeof s=="string"?x(this,L,s):(x(this,L,"*"),o.unshift(s)),o.forEach(l=>{S(this,T,se).call(this,R,u(this,L),l)}),this);const{strict:i,...r}=t;Object.assign(this,r),this.getPath=i??!0?t.getPath??Aa:Pi}route(t,a){const i=this.basePath(t);return a.routes.map(r=>{var o;let s;a.errorHandler===zt?s=r.handler:(s=async(l,n)=>(await $t([],a.errorHandler)(l,()=>r.handler(l,n))).res,s[Ni]=r.handler),S(o=i,T,se).call(o,r.method,r.path,s)}),this}basePath(t){const a=S(this,T,Oa).call(this);return a._basePath=pe(this._basePath,t),a}mount(t,a,i){let r,s;i&&(typeof i=="function"?s=i:(s=i.optionHandler,i.replaceRequest===!1?r=n=>n:r=i.replaceRequest));const o=s?n=>{const c=s(n);return Array.isArray(c)?c:[c]}:n=>{let c;try{c=n.executionCtx}catch{}return[n.env,c]};r||(r=(()=>{const n=pe(this._basePath,t),c=n==="/"?0:n.length;return d=>{const h=new URL(d.url);return h.pathname=h.pathname.slice(c)||"/",new Request(h,d)}})());const l=async(n,c)=>{const d=await a(r(n.req.raw),...o(n));if(d)return d;await c()};return S(this,T,se).call(this,R,pe(t,"*"),l),this}},L=new WeakMap,T=new WeakSet,Oa=function(){const t=new Ma({router:this.router,getPath:this.getPath});return t.errorHandler=this.errorHandler,x(t,H,u(this,H)),t.routes=this.routes,t},H=new WeakMap,se=function(t,a,i){t=t.toUpperCase(),a=pe(this._basePath,a);const r={basePath:this._basePath,path:a,method:t,handler:i};this.router.add(t,a,[i,r]),this.routes.push(r)},Je=function(t,a){if(t instanceof Error)return this.errorHandler(t,a);throw t},Ze=function(t,a,i,r){if(r==="HEAD")return(async()=>new Response(null,await S(this,T,Ze).call(this,t,a,i,"GET")))();const s=this.getPath(t,{env:i}),o=this.router.match(r,s),l=new ki(t,{path:s,matchResult:o,env:i,executionCtx:a,notFoundHandler:u(this,H)});if(o[0].length===1){let c;try{c=o[0][0][0][0](l,async()=>{l.res=await u(this,H).call(this,l)})}catch(d){return S(this,T,Je).call(this,d,l)}return c instanceof Promise?c.then(d=>d||(l.finalized?l.res:u(this,H).call(this,l))).catch(d=>S(this,T,Je).call(this,d,l)):c??u(this,H).call(this,l)}const n=$t(o[0],this.errorHandler,u(this,H));return(async()=>{try{const c=await n(l);if(!c.finalized)throw new Error("Context is not finalized. Did you forget to return a Response object or `await next()`?");return c.res}catch(c){return S(this,T,Je).call(this,c,l)}})()},ia),it="[^/]+",ke=".*",Me="(?:|/.*)",me=Symbol(),ji=new Set(".\\+*[^]$()");function $i(e,t){return e.length===1?t.length===1?e<t?-1:1:-1:t.length===1||e===ke||e===Me?1:t===ke||t===Me?-1:e===it?1:t===it?-1:e.length===t.length?e<t?-1:1:t.length-e.length}var le,ce,F,ra,wt=(ra=class{constructor(){b(this,le);b(this,ce);b(this,F,Object.create(null))}insert(t,a,i,r,s){if(t.length===0){if(u(this,le)!==void 0)throw me;if(s)return;x(this,le,a);return}const[o,...l]=t,n=o==="*"?l.length===0?["","",ke]:["","",it]:o==="/*"?["","",Me]:o.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/);let c;if(n){const d=n[1];let h=n[2]||it;if(d&&n[2]&&(h===".*"||(h=h.replace(/^\((?!\?:)(?=[^)]+\)$)/,"(?:"),/\((?!\?:)/.test(h))))throw me;if(c=u(this,F)[h],!c){if(Object.keys(u(this,F)).some(f=>f!==ke&&f!==Me))throw me;if(s)return;c=u(this,F)[h]=new wt,d!==""&&x(c,ce,r.varIndex++)}!s&&d!==""&&i.push([d,u(c,ce)])}else if(c=u(this,F)[o],!c){if(Object.keys(u(this,F)).some(d=>d.length>1&&d!==ke&&d!==Me))throw me;if(s)return;c=u(this,F)[o]=new wt}c.insert(l,a,i,r,s)}buildRegExpStr(){const a=Object.keys(u(this,F)).sort($i).map(i=>{const r=u(this,F)[i];return(typeof u(r,ce)=="number"?`(${i})@${u(r,ce)}`:ji.has(i)?`\\${i}`:i)+r.buildRegExpStr()});return typeof u(this,le)=="number"&&a.unshift(`#${u(this,le)}`),a.length===0?"":a.length===1?a[0]:"(?:"+a.join("|")+")"}},le=new WeakMap,ce=new WeakMap,F=new WeakMap,ra),rt,He,sa,_i=(sa=class{constructor(){b(this,rt,{varIndex:0});b(this,He,new wt)}insert(e,t,a){const i=[],r=[];for(let o=0;;){let l=!1;if(e=e.replace(/\{[^}]+\}/g,n=>{const c=`@\\${o}`;return r[o]=[c,n],o++,l=!0,c}),!l)break}const s=e.match(/(?::[^\/]+)|(?:\/\*$)|./g)||[];for(let o=r.length-1;o>=0;o--){const[l]=r[o];for(let n=s.length-1;n>=0;n--)if(s[n].indexOf(l)!==-1){s[n]=s[n].replace(l,r[o][1]);break}}return u(this,He).insert(s,t,i,u(this,rt),a),i}buildRegExp(){let e=u(this,He).buildRegExpStr();if(e==="")return[/^$/,[],[]];let t=0;const a=[],i=[];return e=e.replace(/#(\d+)|@(\d+)|\.\*\$/g,(r,s,o)=>s!==void 0?(a[++t]=Number(s),"$()"):(o!==void 0&&(i[Number(o)]=++t),"")),[new RegExp(`^${e}`),a,i]}},rt=new WeakMap,He=new WeakMap,sa),Na=[],zi=[/^$/,[],Object.create(null)],Ye=Object.create(null);function Da(e){return Ye[e]??(Ye[e]=new RegExp(e==="*"?"":`^${e.replace(/\/\*$|([.\\+*[^\]$()])/g,(t,a)=>a?`\\${a}`:"(?:|/.*)")}$`))}function Li(){Ye=Object.create(null)}function Hi(e){var c;const t=new _i,a=[];if(e.length===0)return zi;const i=e.map(d=>[!/\*|\/:/.test(d[0]),...d]).sort(([d,h],[f,y])=>d?1:f?-1:h.length-y.length),r=Object.create(null);for(let d=0,h=-1,f=i.length;d<f;d++){const[y,m,p]=i[d];y?r[m]=[p.map(([v])=>[v,Object.create(null)]),Na]:h++;let g;try{g=t.insert(m,h,y)}catch(v){throw v===me?new ka(m):v}y||(a[h]=p.map(([v,A])=>{const C=Object.create(null);for(A-=1;A>=0;A--){const[E,O]=g[A];C[E]=O}return[v,C]}))}const[s,o,l]=t.buildRegExp();for(let d=0,h=a.length;d<h;d++)for(let f=0,y=a[d].length;f<y;f++){const m=(c=a[d][f])==null?void 0:c[1];if(!m)continue;const p=Object.keys(m);for(let g=0,v=p.length;g<v;g++)m[p[g]]=l[m[p[g]]]}const n=[];for(const d in o)n[d]=a[o[d]];return[s,n,r]}function he(e,t){if(e){for(const a of Object.keys(e).sort((i,r)=>r.length-i.length))if(Da(a).test(t))return[...e[a]]}}var Q,ee,Ce,ja,$a,na,Fi=(na=class{constructor(){b(this,Ce);w(this,"name","RegExpRouter");b(this,Q);b(this,ee);x(this,Q,{[R]:Object.create(null)}),x(this,ee,{[R]:Object.create(null)})}add(e,t,a){var l;const i=u(this,Q),r=u(this,ee);if(!i||!r)throw new Error(Ta);i[e]||[i,r].forEach(n=>{n[e]=Object.create(null),Object.keys(n[R]).forEach(c=>{n[e][c]=[...n[R][c]]})}),t==="/*"&&(t="*");const s=(t.match(/\/:/g)||[]).length;if(/\*$/.test(t)){const n=Da(t);e===R?Object.keys(i).forEach(c=>{var d;(d=i[c])[t]||(d[t]=he(i[c],t)||he(i[R],t)||[])}):(l=i[e])[t]||(l[t]=he(i[e],t)||he(i[R],t)||[]),Object.keys(i).forEach(c=>{(e===R||e===c)&&Object.keys(i[c]).forEach(d=>{n.test(d)&&i[c][d].push([a,s])})}),Object.keys(r).forEach(c=>{(e===R||e===c)&&Object.keys(r[c]).forEach(d=>n.test(d)&&r[c][d].push([a,s]))});return}const o=Ea(t)||[t];for(let n=0,c=o.length;n<c;n++){const d=o[n];Object.keys(r).forEach(h=>{var f;(e===R||e===h)&&((f=r[h])[d]||(f[d]=[...he(i[h],d)||he(i[R],d)||[]]),r[h][d].push([a,s-c+n+1]))})}}match(e,t){Li();const a=S(this,Ce,ja).call(this);return this.match=(i,r)=>{const s=a[i]||a[R],o=s[2][r];if(o)return o;const l=r.match(s[0]);if(!l)return[[],Na];const n=l.indexOf("",1);return[s[1][n],l]},this.match(e,t)}},Q=new WeakMap,ee=new WeakMap,Ce=new WeakSet,ja=function(){const e=Object.create(null);return Object.keys(u(this,ee)).concat(Object.keys(u(this,Q))).forEach(t=>{e[t]||(e[t]=S(this,Ce,$a).call(this,t))}),x(this,Q,x(this,ee,void 0)),e},$a=function(e){const t=[];let a=e===R;return[u(this,Q),u(this,ee)].forEach(i=>{const r=i[e]?Object.keys(i[e]).map(s=>[s,i[e][s]]):[];r.length!==0?(a||(a=!0),t.push(...r)):e!==R&&t.push(...Object.keys(i[R]).map(s=>[s,i[R][s]]))}),a?Hi(t):null},na),te,G,oa,qi=(oa=class{constructor(e){w(this,"name","SmartRouter");b(this,te,[]);b(this,G,[]);x(this,te,e.routers)}add(e,t,a){if(!u(this,G))throw new Error(Ta);u(this,G).push([e,t,a])}match(e,t){if(!u(this,G))throw new Error("Fatal error");const a=u(this,te),i=u(this,G),r=a.length;let s=0,o;for(;s<r;s++){const l=a[s];try{for(let n=0,c=i.length;n<c;n++)l.add(...i[n]);o=l.match(e,t)}catch(n){if(n instanceof ka)continue;throw n}this.match=l.match.bind(l),x(this,te,[l]),x(this,G,void 0);break}if(s===r)throw new Error("Fatal error");return this.name=`SmartRouter + ${this.activeRouter.name}`,o}get activeRouter(){if(u(this,G)||u(this,te).length!==1)throw new Error("No active router has been determined yet.");return u(this,te)[0]}},te=new WeakMap,G=new WeakMap,oa),Ie=Object.create(null),ae,N,de,Ae,M,V,ne,la,_a=(la=class{constructor(e,t,a){b(this,V);b(this,ae);b(this,N);b(this,de);b(this,Ae,0);b(this,M,Ie);if(x(this,N,a||Object.create(null)),x(this,ae,[]),e&&t){const i=Object.create(null);i[e]={handler:t,possibleKeys:[],score:0},x(this,ae,[i])}x(this,de,[])}insert(e,t,a){x(this,Ae,++kt(this,Ae)._);let i=this;const r=bi(t),s=[];for(let o=0,l=r.length;o<l;o++){const n=r[o],c=r[o+1],d=Si(n,c),h=Array.isArray(d)?d[0]:n;if(h in u(i,N)){i=u(i,N)[h],d&&s.push(d[1]);continue}u(i,N)[h]=new _a,d&&(u(i,de).push(d),s.push(d[1])),i=u(i,N)[h]}return u(i,ae).push({[e]:{handler:a,possibleKeys:s.filter((o,l,n)=>n.indexOf(o)===l),score:u(this,Ae)}}),i}search(e,t){var l;const a=[];x(this,M,Ie);let r=[this];const s=ba(t),o=[];for(let n=0,c=s.length;n<c;n++){const d=s[n],h=n===c-1,f=[];for(let y=0,m=r.length;y<m;y++){const p=r[y],g=u(p,N)[d];g&&(x(g,M,u(p,M)),h?(u(g,N)["*"]&&a.push(...S(this,V,ne).call(this,u(g,N)["*"],e,u(p,M))),a.push(...S(this,V,ne).call(this,g,e,u(p,M)))):f.push(g));for(let v=0,A=u(p,de).length;v<A;v++){const C=u(p,de)[v],E=u(p,M)===Ie?{}:{...u(p,M)};if(C==="*"){const J=u(p,N)["*"];J&&(a.push(...S(this,V,ne).call(this,J,e,u(p,M))),x(J,M,E),f.push(J));continue}const[O,ue,re]=C;if(!d&&!(re instanceof RegExp))continue;const U=u(p,N)[O],Ja=s.slice(n).join("/");if(re instanceof RegExp){const J=re.exec(Ja);if(J){if(E[ue]=J[0],a.push(...S(this,V,ne).call(this,U,e,u(p,M),E)),Object.keys(u(U,N)).length){x(U,M,E);const st=((l=J[0].match(/\//))==null?void 0:l.length)??0;(o[st]||(o[st]=[])).push(U)}continue}}(re===!0||re.test(d))&&(E[ue]=d,h?(a.push(...S(this,V,ne).call(this,U,e,E,u(p,M))),u(U,N)["*"]&&a.push(...S(this,V,ne).call(this,u(U,N)["*"],e,E,u(p,M)))):(x(U,M,E),f.push(U)))}}r=f.concat(o.shift()??[])}return a.length>1&&a.sort((n,c)=>n.score-c.score),[a.map(({handler:n,params:c})=>[n,c])]}},ae=new WeakMap,N=new WeakMap,de=new WeakMap,Ae=new WeakMap,M=new WeakMap,V=new WeakSet,ne=function(e,t,a,i){const r=[];for(let s=0,o=u(e,ae).length;s<o;s++){const l=u(e,ae)[s],n=l[t]||l[R],c={};if(n!==void 0&&(n.params=Object.create(null),r.push(n),a!==Ie||i&&i!==Ie))for(let d=0,h=n.possibleKeys.length;d<h;d++){const f=n.possibleKeys[d],y=c[n.score];n.params[f]=i!=null&&i[f]&&!y?i[f]:a[f]??(i==null?void 0:i[f]),c[n.score]=!0}}return r},la),fe,ca,Ui=(ca=class{constructor(){w(this,"name","TrieRouter");b(this,fe);x(this,fe,new _a)}add(e,t,a){const i=Ea(t);if(i){for(let r=0,s=i.length;r<s;r++)u(this,fe).insert(e,i[r],a);return}u(this,fe).insert(e,t,a)}match(e,t){return u(this,fe).search(e,t)}},fe=new WeakMap,ca),za=class extends Ma{constructor(e={}){super(e),this.router=e.router??new qi({routers:[new Fi,new Ui]})}},Wi=e=>{const a={...{origin:"*",allowMethods:["GET","HEAD","PUT","POST","DELETE","PATCH"],allowHeaders:[],exposeHeaders:[]},...e},i=(s=>typeof s=="string"?s==="*"?()=>s:o=>s===o?o:null:typeof s=="function"?s:o=>s.includes(o)?o:null)(a.origin),r=(s=>typeof s=="function"?s:Array.isArray(s)?()=>s:()=>[])(a.allowMethods);return async function(o,l){var d;function n(h,f){o.res.headers.set(h,f)}const c=await i(o.req.header("origin")||"",o);if(c&&n("Access-Control-Allow-Origin",c),a.origin!=="*"){const h=o.req.header("Vary");h?n("Vary",h):n("Vary","Origin")}if(a.credentials&&n("Access-Control-Allow-Credentials","true"),(d=a.exposeHeaders)!=null&&d.length&&n("Access-Control-Expose-Headers",a.exposeHeaders.join(",")),o.req.method==="OPTIONS"){a.maxAge!=null&&n("Access-Control-Max-Age",a.maxAge.toString());const h=await r(o.req.header("origin")||"",o);h.length&&n("Access-Control-Allow-Methods",h.join(","));let f=a.allowHeaders;if(!(f!=null&&f.length)){const y=o.req.header("Access-Control-Request-Headers");y&&(f=y.split(/\s*,\s*/))}return f!=null&&f.length&&(n("Access-Control-Allow-Headers",f.join(",")),o.res.headers.append("Vary","Access-Control-Request-Headers")),o.res.headers.delete("Content-Length"),o.res.headers.delete("Content-Type"),new Response(null,{headers:o.res.headers,status:204,statusText:"No Content"})}await l()}},Bi=/^\s*(?:text\/(?!event-stream(?:[;\s]|$))[^;\s]+|application\/(?:javascript|json|xml|xml-dtd|ecmascript|dart|postscript|rtf|tar|toml|vnd\.dart|vnd\.ms-fontobject|vnd\.ms-opentype|wasm|x-httpd-php|x-javascript|x-ns-proxy-autoconfig|x-sh|x-tar|x-virtualbox-hdd|x-virtualbox-ova|x-virtualbox-ovf|x-virtualbox-vbox|x-virtualbox-vdi|x-virtualbox-vhd|x-virtualbox-vmdk|x-www-form-urlencoded)|font\/(?:otf|ttf)|image\/(?:bmp|vnd\.adobe\.photoshop|vnd\.microsoft\.icon|vnd\.ms-dds|x-icon|x-ms-bmp)|message\/rfc822|model\/gltf-binary|x-shader\/x-fragment|x-shader\/x-vertex|[^;\s]+?\+(?:json|text|xml|yaml))(?:[;\s]|$)/i,Lt=(e,t=Gi)=>{const a=/\.([a-zA-Z0-9]+?)$/,i=e.match(a);if(!i)return;let r=t[i[1]];return r&&r.startsWith("text")&&(r+="; charset=utf-8"),r},Ki={aac:"audio/aac",avi:"video/x-msvideo",avif:"image/avif",av1:"video/av1",bin:"application/octet-stream",bmp:"image/bmp",css:"text/css",csv:"text/csv",eot:"application/vnd.ms-fontobject",epub:"application/epub+zip",gif:"image/gif",gz:"application/gzip",htm:"text/html",html:"text/html",ico:"image/x-icon",ics:"text/calendar",jpeg:"image/jpeg",jpg:"image/jpeg",js:"text/javascript",json:"application/json",jsonld:"application/ld+json",map:"application/json",mid:"audio/x-midi",midi:"audio/x-midi",mjs:"text/javascript",mp3:"audio/mpeg",mp4:"video/mp4",mpeg:"video/mpeg",oga:"audio/ogg",ogv:"video/ogg",ogx:"application/ogg",opus:"audio/opus",otf:"font/otf",pdf:"application/pdf",png:"image/png",rtf:"application/rtf",svg:"image/svg+xml",tif:"image/tiff",tiff:"image/tiff",ts:"video/mp2t",ttf:"font/ttf",txt:"text/plain",wasm:"application/wasm",webm:"video/webm",weba:"audio/webm",webmanifest:"application/manifest+json",webp:"image/webp",woff:"font/woff",woff2:"font/woff2",xhtml:"application/xhtml+xml",xml:"application/xml",zip:"application/zip","3gp":"video/3gpp","3g2":"video/3gpp2",gltf:"model/gltf+json",glb:"model/gltf-binary"},Gi=Ki,Vi=(...e)=>{let t=e.filter(r=>r!=="").join("/");t=t.replace(new RegExp("(?<=\\/)\\/+","g"),"");const a=t.split("/"),i=[];for(const r of a)r===".."&&i.length>0&&i.at(-1)!==".."?i.pop():r!=="."&&i.push(r);return i.join("/")||"."},La={br:".br",zstd:".zst",gzip:".gz"},Xi=Object.keys(La),Ji="index.html",Zi=e=>{const t=e.root??"./",a=e.path,i=e.join??Vi;return async(r,s)=>{var d,h,f,y;if(r.finalized)return s();let o;if(e.path)o=e.path;else try{if(o=decodeURIComponent(r.req.path),/(?:^|[\/\\])\.\.(?:$|[\/\\])/.test(o))throw new Error}catch{return await((d=e.onNotFound)==null?void 0:d.call(e,r.req.path,r)),s()}let l=i(t,!a&&e.rewriteRequestPath?e.rewriteRequestPath(o):o);e.isDir&&await e.isDir(l)&&(l=i(l,Ji));const n=e.getContent;let c=await n(l,r);if(c instanceof Response)return r.newResponse(c.body,c);if(c){const m=e.mimes&&Lt(l,e.mimes)||Lt(l);if(r.header("Content-Type",m||"application/octet-stream"),e.precompressed&&(!m||Bi.test(m))){const p=new Set((h=r.req.header("Accept-Encoding"))==null?void 0:h.split(",").map(g=>g.trim()));for(const g of Xi){if(!p.has(g))continue;const v=await n(l+La[g],r);if(v){c=v,r.header("Content-Encoding",g),r.header("Vary","Accept-Encoding",{append:!0});break}}}return await((f=e.onFound)==null?void 0:f.call(e,l,r)),r.body(c)}await((y=e.onNotFound)==null?void 0:y.call(e,l,r)),await s()}},Yi=async(e,t)=>{let a;t&&t.manifest?typeof t.manifest=="string"?a=JSON.parse(t.manifest):a=t.manifest:typeof __STATIC_CONTENT_MANIFEST=="string"?a=JSON.parse(__STATIC_CONTENT_MANIFEST):a=__STATIC_CONTENT_MANIFEST;let i;t&&t.namespace?i=t.namespace:i=__STATIC_CONTENT;const r=a[e]||e;if(!r)return null;const s=await i.get(r,{type:"stream"});return s||null},Qi=e=>async function(a,i){return Zi({...e,getContent:async s=>Yi(s,{manifest:e.manifest,namespace:e.namespace?e.namespace:a.env?a.env.__STATIC_CONTENT:void 0})})(a,i)},er=e=>Qi(e),Ne="_hp",tr={Change:"Input",DoubleClick:"DblClick"},ar={svg:"2000/svg",math:"1998/Math/MathML"},De=[],xt=new WeakMap,Se=void 0,ir=()=>Se,W=e=>"t"in e,ft={onClick:["click",!1]},Ht=e=>{if(!e.startsWith("on"))return;if(ft[e])return ft[e];const t=e.match(/^on([A-Z][a-zA-Z]+?(?:PointerCapture)?)(Capture)?$/);if(t){const[,a,i]=t;return ft[e]=[(tr[a]||a).toLowerCase(),!!i]}},Ft=(e,t)=>Se&&e instanceof SVGElement&&/[A-Z]/.test(t)&&(t in e.style||t.match(/^(?:o|pai|str|u|ve)/))?t.replace(/([A-Z])/g,"-$1").toLowerCase():t,rr=(e,t,a)=>{var i;t||(t={});for(let r in t){const s=t[r];if(r!=="children"&&(!a||a[r]!==s)){r=at(r);const o=Ht(r);if(o){if((a==null?void 0:a[r])!==s&&(a&&e.removeEventListener(o[0],a[r],o[1]),s!=null)){if(typeof s!="function")throw new Error(`Event handler for "${r}" is not a function`);e.addEventListener(o[0],s,o[1])}}else if(r==="dangerouslySetInnerHTML"&&s)e.innerHTML=s.__html;else if(r==="ref"){let l;typeof s=="function"?l=s(e)||(()=>s(null)):s&&"current"in s&&(s.current=e,l=()=>s.current=null),xt.set(e,l)}else if(r==="style"){const l=e.style;typeof s=="string"?l.cssText=s:(l.cssText="",s!=null&&wa(s,l.setProperty.bind(l)))}else{if(r==="value"){const n=e.nodeName;if(n==="INPUT"||n==="TEXTAREA"||n==="SELECT"){if(e.value=s==null||s===!1?null:s,n==="TEXTAREA"){e.textContent=s;continue}else if(n==="SELECT"){e.selectedIndex===-1&&(e.selectedIndex=0);continue}}}else(r==="checked"&&e.nodeName==="INPUT"||r==="selected"&&e.nodeName==="OPTION")&&(e[r]=s);const l=Ft(e,r);s==null||s===!1?e.removeAttribute(l):s===!0?e.setAttribute(l,""):typeof s=="string"||typeof s=="number"?e.setAttribute(l,s):e.setAttribute(l,s.toString())}}}if(a)for(let r in a){const s=a[r];if(r!=="children"&&!(r in t)){r=at(r);const o=Ht(r);o?e.removeEventListener(o[0],s,o[1]):r==="ref"?(i=xt.get(e))==null||i():e.removeAttribute(Ft(e,r))}}},sr=(e,t)=>{t[I][0]=0,De.push([e,t]);const a=t.tag[At]||t.tag,i=a.defaultProps?{...a.defaultProps,...t.props}:t.props;try{return[a.call(null,i)]}finally{De.pop()}},Ha=(e,t,a,i,r)=>{var s,o;(s=e.vR)!=null&&s.length&&(i.push(...e.vR),delete e.vR),typeof e.tag=="function"&&((o=e[I][1][Wa])==null||o.forEach(l=>r.push(l))),e.vC.forEach(l=>{var n;if(W(l))a.push(l);else if(typeof l.tag=="function"||l.tag===""){l.c=t;const c=a.length;if(Ha(l,t,a,i,r),l.s){for(let d=c;d<a.length;d++)a[d].s=!0;l.s=!1}}else a.push(l),(n=l.vR)!=null&&n.length&&(i.push(...l.vR),delete l.vR)})},nr=e=>{for(;;e=e.tag===Ne||!e.vC||!e.pP?e.nN:e.vC[0]){if(!e)return null;if(e.tag!==Ne&&e.e)return e.e}},Fa=e=>{var t,a,i,r,s,o;W(e)||((a=(t=e[I])==null?void 0:t[1][Wa])==null||a.forEach(l=>{var n;return(n=l[2])==null?void 0:n.call(l)}),(i=xt.get(e.e))==null||i(),e.p===2&&((r=e.vC)==null||r.forEach(l=>l.p=2)),(s=e.vC)==null||s.forEach(Fa)),e.p||((o=e.e)==null||o.remove(),delete e.e),typeof e.tag=="function"&&(Te.delete(e),Qe.delete(e),delete e[I][3],e.a=!0)},qa=(e,t,a)=>{e.c=t,Ua(e,t,a)},qt=(e,t)=>{if(t){for(let a=0,i=e.length;a<i;a++)if(e[a]===t)return a}},Ut=Symbol(),Ua=(e,t,a)=>{var c;const i=[],r=[],s=[];Ha(e,t,i,r,s),r.forEach(Fa);const o=a?void 0:t.childNodes;let l,n=null;if(a)l=-1;else if(!o.length)l=0;else{const d=qt(o,nr(e.nN));d!==void 0?(n=o[d],l=d):l=qt(o,(c=i.find(h=>h.tag!==Ne&&h.e))==null?void 0:c.e)??-1,l===-1&&(a=!0)}for(let d=0,h=i.length;d<h;d++,l++){const f=i[d];let y;if(f.s&&f.e)y=f.e,f.s=!1;else{const m=a||!f.e;W(f)?(f.e&&f.d&&(f.e.textContent=f.t),f.d=!1,y=f.e||(f.e=document.createTextNode(f.t))):(y=f.e||(f.e=f.n?document.createElementNS(f.n,f.tag):document.createElement(f.tag)),rr(y,f.props,f.pP),Ua(f,y,m))}f.tag===Ne?l--:a?y.parentNode||t.appendChild(y):o[l]!==y&&o[l-1]!==y&&(o[l+1]===y?t.appendChild(o[l]):t.insertBefore(y,n||o[l]||null))}if(e.pP&&delete e.pP,s.length){const d=[],h=[];s.forEach(([,f,,y,m])=>{f&&d.push(f),y&&h.push(y),m==null||m()}),d.forEach(f=>f()),h.length&&requestAnimationFrame(()=>{h.forEach(f=>f())})}},or=(e,t)=>!!(e&&e.length===t.length&&e.every((a,i)=>a[1]===t[i][1])),Qe=new WeakMap,bt=(e,t,a)=>{var s,o,l,n,c,d;const i=!a&&t.pC;a&&(t.pC||(t.pC=t.vC));let r;try{a||(a=typeof t.tag=="function"?sr(e,t):Fe(t.props.children)),((s=a[0])==null?void 0:s.tag)===""&&a[0][yt]&&(r=a[0][yt],e[5].push([e,r,t]));const h=i?[...t.pC]:t.vC?[...t.vC]:void 0,f=[];let y;for(let m=0;m<a.length;m++){Array.isArray(a[m])&&a.splice(m,1,...a[m].flat());let p=lr(a[m]);if(p){typeof p.tag=="function"&&!p.tag[ga]&&(Ee.length>0&&(p[I][2]=Ee.map(v=>[v,v.values.at(-1)])),(o=e[5])!=null&&o.length&&(p[I][3]=e[5].at(-1)));let g;if(h&&h.length){const v=h.findIndex(W(p)?A=>W(A):p.key!==void 0?A=>A.key===p.key&&A.tag===p.tag:A=>A.tag===p.tag);v!==-1&&(g=h[v],h.splice(v,1))}if(g)if(W(p))g.t!==p.t&&(g.t=p.t,g.d=!0),p=g;else{const v=g.pP=g.props;if(g.props=p.props,g.f||(g.f=p.f||t.f),typeof p.tag=="function"){const A=g[I][2];g[I][2]=p[I][2]||[],g[I][3]=p[I][3],!g.f&&((g.o||g)===p.o||(n=(l=g.tag)[ti])!=null&&n.call(l,v,g.props))&&or(A,g[I][2])&&(g.s=!0)}p=g}else if(!W(p)&&Se){const v=Pe(Se);v&&(p.n=v)}if(!W(p)&&!p.s&&(bt(e,p),delete p.f),f.push(p),y&&!y.s&&!p.s)for(let v=y;v&&!W(v);v=(c=v.vC)==null?void 0:c.at(-1))v.nN=p;y=p}}t.vR=i?[...t.vC,...h||[]]:h||[],t.vC=f,i&&delete t.pC}catch(h){if(t.f=!0,h===Ut){if(r)return;throw h}const[f,y,m]=((d=t[I])==null?void 0:d[3])||[];if(y){const p=()=>et([0,!1,e[2]],m),g=Qe.get(m)||[];g.push(p),Qe.set(m,g);const v=y(h,()=>{const A=Qe.get(m);if(A){const C=A.indexOf(p);if(C!==-1)return A.splice(C,1),p()}});if(v){if(e[0]===1)e[1]=!0;else if(bt(e,m,[v]),(y.length===1||e!==f)&&m.c){qa(m,m.c,!1);return}throw Ut}}throw h}finally{r&&e[5].pop()}},lr=e=>{if(!(e==null||typeof e=="boolean")){if(typeof e=="string"||typeof e=="number")return{t:e.toString(),d:!0};if("vR"in e&&(e={tag:e.tag,props:e.props,key:e.key,f:e.f,type:e.tag,ref:e.props.ref,o:e.o||e}),typeof e.tag=="function")e[I]=[0,[]];else{const t=ar[e.tag];t&&(Se||(Se=ya("")),e.props.children=[{tag:Se,props:{value:e.n=`http://www.w3.org/${t}`,children:e.props.children}}])}return e}},Wt=(e,t)=>{var a,i;(a=t[I][2])==null||a.forEach(([r,s])=>{r.values.push(s)});try{bt(e,t,void 0)}catch{return}if(t.a){delete t.a;return}(i=t[I][2])==null||i.forEach(([r])=>{r.values.pop()}),(e[0]!==1||!e[1])&&qa(t,t.c,!1)},Te=new WeakMap,Bt=[],et=async(e,t)=>{e[5]||(e[5]=[]);const a=Te.get(t);a&&a[0](void 0);let i;const r=new Promise(s=>i=s);if(Te.set(t,[i,()=>{e[2]?e[2](e,t,s=>{Wt(s,t)}).then(()=>i(t)):(Wt(e,t),i(t))}]),Bt.length)Bt.at(-1).add(t);else{await Promise.resolve();const s=Te.get(t);s&&(Te.delete(t),s[1]())}return r},cr=(e,t,a)=>({tag:Ne,props:{children:e},key:a,e:t,p:1}),ut=0,Wa=1,ht=2,gt=3,pt=new WeakMap,Ba=(e,t)=>!e||!t||e.length!==t.length||t.some((a,i)=>a!==e[i]),dr=void 0,Kt=[],fr=e=>{var o;const t=()=>typeof e=="function"?e():e,a=De.at(-1);if(!a)return[t(),()=>{}];const[,i]=a,r=(o=i[I][1])[ut]||(o[ut]=[]),s=i[I][0]++;return r[s]||(r[s]=[t(),l=>{const n=dr,c=r[s];if(typeof l=="function"&&(l=l(c[0])),!Object.is(l,c[0]))if(c[0]=l,Kt.length){const[d,h]=Kt.at(-1);Promise.all([d===3?i:et([d,!1,n],i),h]).then(([f])=>{if(!f||!(d===2||d===3))return;const y=f.vC;requestAnimationFrame(()=>{setTimeout(()=>{y===f.vC&&et([d===3?1:0,!1,n],f)})})})}else et([0,!1,n],i)}])},It=(e,t)=>{var l;const a=De.at(-1);if(!a)return e;const[,i]=a,r=(l=i[I][1])[ht]||(l[ht]=[]),s=i[I][0]++,o=r[s];return Ba(o==null?void 0:o[1],t)?r[s]=[e,t]:e=r[s][0],e},ur=e=>{const t=pt.get(e);if(t){if(t.length===2)throw t[1];return t[0]}throw e.then(a=>pt.set(e,[a]),a=>pt.set(e,[void 0,a])),e},hr=(e,t)=>{var l;const a=De.at(-1);if(!a)return e();const[,i]=a,r=(l=i[I][1])[gt]||(l[gt]=[]),s=i[I][0]++,o=r[s];return Ba(o==null?void 0:o[1],t)&&(r[s]=[e(),t]),r[s][0]},gr=ya({pending:!1,data:null,method:null,action:null}),Gt=new Set,pr=e=>{Gt.add(e),e.finally(()=>Gt.delete(e))},Rt=(e,t)=>hr(()=>a=>{let i;e&&(typeof e=="function"?i=e(a)||(()=>{e(null)}):e&&"current"in e&&(e.current=a,i=()=>{e.current=null}));const r=t(a);return()=>{r==null||r(),i==null||i()}},[e]),ge=Object.create(null),Ke=Object.create(null),We=(e,t,a,i,r)=>{if(t!=null&&t.itemProp)return{tag:e,props:t,type:e,ref:t.ref};const s=document.head;let{onLoad:o,onError:l,precedence:n,blocking:c,...d}=t,h=null,f=!1;const y=Ge[e];let m;if(y.length>0){const A=s.querySelectorAll(e);e:for(const C of A)for(const E of Ge[e])if(C.getAttribute(E)===t[E]){h=C;break e}if(!h){const C=y.reduce((E,O)=>t[O]===void 0?E:`${E}-${O}-${t[O]}`,e);f=!Ke[C],h=Ke[C]||(Ke[C]=(()=>{const E=document.createElement(e);for(const O of y)t[O]!==void 0&&E.setAttribute(O,t[O]),t.rel&&E.setAttribute("rel",t.rel);return E})())}}else m=s.querySelectorAll(e);n=i?n??"":void 0,i&&(d[Ve]=n);const p=It(A=>{if(y.length>0){let C=!1;for(const E of s.querySelectorAll(e)){if(C&&E.getAttribute(Ve)!==n){s.insertBefore(A,E);return}E.getAttribute(Ve)===n&&(C=!0)}s.appendChild(A)}else if(m){let C=!1;for(const E of m)if(E===A){C=!0;break}C||s.insertBefore(A,s.contains(m[0])?m[0]:s.querySelector(e)),m=void 0}},[n]),g=Rt(t.ref,A=>{var O;const C=y[0];if(a===2&&(A.innerHTML=""),(f||m)&&p(A),!l&&!o)return;let E=ge[O=A.getAttribute(C)]||(ge[O]=new Promise((ue,re)=>{A.addEventListener("load",ue),A.addEventListener("error",re)}));o&&(E=E.then(o)),l&&(E=E.catch(l)),E.catch(()=>{})});if(r&&c==="render"){const A=Ge[e][0];if(t[A]){const C=t[A],E=ge[C]||(ge[C]=new Promise((O,ue)=>{p(h),h.addEventListener("load",O),h.addEventListener("error",ue)}));ur(E)}}const v={tag:e,type:e,props:{...d,ref:g},ref:g};return v.p=a,h&&(v.e=h),cr(v,s)},yr=e=>{const t=ir(),a=t&&Pe(t);return a!=null&&a.endsWith("svg")?{tag:"title",props:e,type:"title",ref:e.ref}:We("title",e,void 0,!1,!1)},mr=e=>!e||["src","async"].some(t=>!e[t])?{tag:"script",props:e,type:"script",ref:e.ref}:We("script",e,1,!1,!0),vr=e=>!e||!["href","precedence"].every(t=>t in e)?{tag:"style",props:e,type:"style",ref:e.ref}:(e["data-href"]=e.href,delete e.href,We("style",e,2,!0,!0)),wr=e=>!e||["onLoad","onError"].some(t=>t in e)||e.rel==="stylesheet"&&(!("precedence"in e)||"disabled"in e)?{tag:"link",props:e,type:"link",ref:e.ref}:We("link",e,1,"precedence"in e,!0),xr=e=>We("meta",e,void 0,!1,!1),Ka=Symbol(),br=e=>{const{action:t,...a}=e;typeof t!="function"&&(a.action=t);const[i,r]=fr([null,!1]),s=It(async c=>{const d=c.isTrusted?t:c.detail[Ka];if(typeof d!="function")return;c.preventDefault();const h=new FormData(c.target);r([h,!0]);const f=d(h);f instanceof Promise&&(pr(f),await f),r([null,!0])},[]),o=Rt(e.ref,c=>(c.addEventListener("submit",s),()=>{c.removeEventListener("submit",s)})),[l,n]=i;return i[1]=!1,{tag:gr,props:{value:{pending:l!==null,data:l,method:l?"post":null,action:l?t:null},children:{tag:"form",props:{...a,ref:o},type:"form",ref:o}},f:n}},Ga=(e,{formAction:t,...a})=>{if(typeof t=="function"){const i=It(r=>{r.preventDefault(),r.currentTarget.form.dispatchEvent(new CustomEvent("submit",{detail:{[Ka]:t}}))},[]);a.ref=Rt(a.ref,r=>(r.addEventListener("click",i),()=>{r.removeEventListener("click",i)}))}return{tag:e,props:a,type:e,ref:a.ref}},Ar=e=>Ga("input",e),Er=e=>Ga("button",e);Object.assign(mt,{title:yr,script:mr,style:vr,link:wr,meta:xr,form:br,input:Ar,button:Er});Et(null);new TextEncoder;var Sr=Et(null),Cr=(e,t,a,i)=>(r,s)=>{const o="<!DOCTYPE html>",l=a?Dt(c=>a(c,e),{Layout:t,...s},r):r,n=ei`${z(o)}${Dt(Sr.Provider,{value:e},l)}`;return e.html(n)},Pr=(e,t)=>function(i,r){const s=i.getLayout()??gi;return e&&i.setLayout(o=>e({...o,Layout:s},i)),i.setRenderer(Cr(i,s,e)),r()};const Ir=Pr(({children:e})=>k("html",{lang:"ko",children:[k("head",{children:[k("meta",{charset:"UTF-8"}),k("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0"}),k("title",{children:"PwC 온톨로지 자동 구축 서비스"}),k("script",{src:"https://cdn.tailwindcss.com"}),k("link",{href:"https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css",rel:"stylesheet"}),k("script",{crossorigin:!0,src:"https://unpkg.com/react@18/umd/react.development.js"}),k("script",{crossorigin:!0,src:"https://unpkg.com/react-dom@18/umd/react-dom.development.js"}),k("script",{src:"https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"}),k("script",{src:"https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"}),k("script",{src:"https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"}),k("link",{href:"/static/styles.css",rel:"stylesheet"}),k("style",{children:`
          body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            overflow: hidden;
          }
          
          .graph-container {
            width: 100vw;
            height: 100vh;
            position: relative;
            background: linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 50%, #16213e 100%);
          }
          
          .control-panel {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
            min-width: 300px;
          }
          
          .insight-panel {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
            min-width: 280px;
            max-height: 60vh;
            overflow-y: auto;
          }
          
          .status-bar {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 10px;
          }
          
          .pulse {
            animation: pulse 2s infinite;
          }
          
          @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
          }
          
          .glow {
            animation: glow 2s ease-in-out infinite alternate;
          }
          
          @keyframes glow {
            from { box-shadow: 0 0 5px #e74c3c; }
            to { box-shadow: 0 0 20px #e74c3c, 0 0 30px #e74c3c; }
          }
          
          .slide-in {
            animation: slideIn 0.5s ease-out;
          }
          
          @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
          }
        `})]}),k("body",{children:[e,k("script",{src:"/static/app.js"})]})]})),Rr=[{id:"pwc-global",label:"PwC Global",type:"organization",category:"global"},{id:"pwc-korea",label:"PwC Korea",type:"organization",category:"country"},{id:"advisory",label:"Advisory",type:"division",category:"business-unit",aliases:["어드바이저리","자문"]},{id:"assurance",label:"Assurance",type:"division",category:"business-unit",aliases:["어슈어런스","보증"]},{id:"tax",label:"Tax & Legal",type:"division",category:"business-unit",aliases:["세무","택스"]},{id:"consulting",label:"Consulting",type:"division",category:"business-unit",aliases:["컨설팅"]},{id:"deals",label:"Deals",type:"practice",category:"service-line",aliases:["딜스","M&A","인수합병"]},{id:"risk",label:"Risk Assurance",type:"practice",category:"service-line",aliases:["리스크","위험관리"]},{id:"forensics",label:"Forensics",type:"practice",category:"service-line",aliases:["포렌식","수사"]},{id:"strategy",label:"Strategy&",type:"practice",category:"service-line",aliases:["전략","스트래티지"]},{id:"technology",label:"Technology Consulting",type:"practice",category:"service-line",aliases:["기술컨설팅","IT컨설팅"]},{id:"operations",label:"Operations",type:"practice",category:"service-line",aliases:["운영","오퍼레이션"]},{id:"people-org",label:"People & Organisation",type:"practice",category:"service-line",aliases:["인사조직","HR"]}],Tr=[{id:"financial-services",label:"Financial Services",type:"industry",category:"sector",aliases:["금융","FS","은행","보험","증권"]},{id:"manufacturing",label:"Manufacturing",type:"industry",category:"sector",aliases:["제조업","제조","생산"]},{id:"retail-consumer",label:"Retail & Consumer",type:"industry",category:"sector",aliases:["소매","유통","소비재","CPG"]},{id:"healthcare",label:"Healthcare",type:"industry",category:"sector",aliases:["헬스케어","의료","제약","바이오"]},{id:"energy",label:"Energy, Utilities & Resources",type:"industry",category:"sector",aliases:["에너지","유틸리티","자원","전력","가스"]},{id:"tmt",label:"Technology, Media & Telecommunications",type:"industry",category:"sector",aliases:["TMT","기술","미디어","통신","IT","테크"]},{id:"automotive",label:"Automotive",type:"industry",category:"sector",aliases:["자동차","모빌리티","완성차","부품"]},{id:"aerospace",label:"Aerospace & Defence",type:"industry",category:"sector",aliases:["항공우주","방산","국방"]},{id:"samsung",label:"Samsung",type:"client",category:"enterprise",aliases:["삼성","삼성그룹"]},{id:"lg",label:"LG",type:"client",category:"enterprise",aliases:["엘지","LG그룹"]},{id:"sk",label:"SK",type:"client",category:"enterprise",aliases:["SK그룹"]},{id:"hyundai",label:"Hyundai Motor",type:"client",category:"enterprise",aliases:["현대자동차","현대차"]}],kr=[{id:"digital-transformation",label:"Digital Transformation",type:"capability",category:"digital",aliases:["디지털전환","DX","디지털혁신"]},{id:"ai-analytics",label:"AI & Analytics",type:"capability",category:"digital",aliases:["AI","인공지능","애널리틱스","데이터분석","ML","머신러닝"]},{id:"cloud",label:"Cloud",type:"capability",category:"digital",aliases:["클라우드","클라우드전환"]},{id:"cybersecurity",label:"Cybersecurity",type:"capability",category:"digital",aliases:["사이버보안","보안","정보보호"]},{id:"corporate-strategy",label:"Corporate Strategy",type:"capability",category:"strategy",aliases:["기업전략","전사전략"]},{id:"digital-strategy",label:"Digital Strategy",type:"capability",category:"strategy",aliases:["디지털전략"]},{id:"innovation",label:"Innovation",type:"capability",category:"strategy",aliases:["혁신","이노베이션"]},{id:"supply-chain",label:"Supply Chain",type:"capability",category:"operations",aliases:["공급망","SCM","S&OP"]},{id:"process-optimization",label:"Process Optimization",type:"capability",category:"operations",aliases:["프로세스최적화","업무개선","BPR"]},{id:"cost-reduction",label:"Cost Reduction",type:"capability",category:"operations",aliases:["비용절감","원가절감"]},{id:"sap",label:"SAP",type:"technology",category:"platform",aliases:["SAP","ERP"]},{id:"salesforce",label:"Salesforce",type:"technology",category:"platform",aliases:["세일즈포스","CRM"]},{id:"palantir",label:"Palantir",type:"technology",category:"platform",aliases:["팔란티어","데이터플랫폼"]},{id:"alteryx",label:"Alteryx",type:"technology",category:"platform",aliases:["알테릭스","데이터분석툴"]}],Mr=[{id:"proposal",label:"Proposal",type:"deliverable",category:"document",aliases:["제안서","프로포절","RFP응답"]},{id:"final-report",label:"Final Report",type:"deliverable",category:"document",aliases:["최종보고서","결과보고서"]},{id:"executive-summary",label:"Executive Summary",type:"deliverable",category:"document",aliases:["경영진요약","임원요약","ExSum"]},{id:"business-case",label:"Business Case",type:"deliverable",category:"document",aliases:["사업타당성","비즈니스케이스"]},{id:"operating-model",label:"Operating Model",type:"deliverable",category:"framework",aliases:["운영모델","조직모델"]},{id:"roadmap",label:"Roadmap",type:"deliverable",category:"framework",aliases:["로드맵","실행계획"]},{id:"kpi-dashboard",label:"KPI Dashboard",type:"deliverable",category:"framework",aliases:["KPI","성과지표","대시보드"]},{id:"data-platform",label:"Data Platform",type:"deliverable",category:"system",aliases:["데이터플랫폼","데이터레이크"]},{id:"analytics-model",label:"Analytics Model",type:"deliverable",category:"system",aliases:["분석모델","예측모델"]}],Or=[{id:"roi",label:"ROI",type:"kpi",category:"financial",aliases:["투자수익률","Return on Investment"]},{id:"cost-saving",label:"Cost Saving",type:"kpi",category:"financial",aliases:["비용절감","원가절감액"]},{id:"revenue-growth",label:"Revenue Growth",type:"kpi",category:"financial",aliases:["매출성장률","수익증가"]},{id:"efficiency",label:"Efficiency",type:"kpi",category:"operational",aliases:["효율성","생산성"]},{id:"time-to-market",label:"Time to Market",type:"kpi",category:"operational",aliases:["출시시간","TTM"]},{id:"customer-satisfaction",label:"Customer Satisfaction",type:"kpi",category:"operational",aliases:["고객만족도","CSAT","NPS"]},{id:"digital-adoption",label:"Digital Adoption",type:"kpi",category:"digital",aliases:["디지털도입률","디지털활용률"]},{id:"automation-rate",label:"Automation Rate",type:"kpi",category:"digital",aliases:["자동화율","RPA효과"]}],Nr=[{source:"pwc-global",target:"pwc-korea",type:"contains",weight:1},{source:"pwc-korea",target:"advisory",type:"contains",weight:1},{source:"pwc-korea",target:"assurance",type:"contains",weight:1},{source:"pwc-korea",target:"tax",type:"contains",weight:1},{source:"pwc-korea",target:"consulting",type:"contains",weight:1},{source:"advisory",target:"deals",type:"contains",weight:1},{source:"advisory",target:"risk",type:"contains",weight:1},{source:"advisory",target:"forensics",type:"contains",weight:1},{source:"consulting",target:"strategy",type:"contains",weight:1},{source:"consulting",target:"technology",type:"contains",weight:1},{source:"consulting",target:"operations",type:"contains",weight:1},{source:"consulting",target:"people-org",type:"contains",weight:1},{source:"technology",target:"digital-transformation",type:"provides",weight:.9},{source:"technology",target:"ai-analytics",type:"provides",weight:.9},{source:"technology",target:"cloud",type:"provides",weight:.8},{source:"technology",target:"cybersecurity",type:"provides",weight:.7},{source:"strategy",target:"corporate-strategy",type:"provides",weight:.9},{source:"strategy",target:"digital-strategy",type:"provides",weight:.8},{source:"strategy",target:"innovation",type:"provides",weight:.7},{source:"operations",target:"supply-chain",type:"provides",weight:.9},{source:"operations",target:"process-optimization",type:"provides",weight:.8},{source:"operations",target:"cost-reduction",type:"provides",weight:.8},{source:"ai-analytics",target:"palantir",type:"uses",weight:.8},{source:"ai-analytics",target:"alteryx",type:"uses",weight:.7},{source:"digital-transformation",target:"sap",type:"uses",weight:.7},{source:"digital-transformation",target:"salesforce",type:"uses",weight:.6},{source:"tmt",target:"samsung",type:"includes",weight:.9},{source:"tmt",target:"lg",type:"includes",weight:.8},{source:"automotive",target:"hyundai",type:"includes",weight:.9},{source:"energy",target:"sk",type:"includes",weight:.8},{source:"corporate-strategy",target:"business-case",type:"generates",weight:.8},{source:"digital-strategy",target:"roadmap",type:"generates",weight:.8},{source:"ai-analytics",target:"data-platform",type:"generates",weight:.8},{source:"ai-analytics",target:"analytics-model",type:"generates",weight:.9},{source:"process-optimization",target:"operating-model",type:"generates",weight:.7},{source:"cost-reduction",target:"cost-saving",type:"measures",weight:.9},{source:"digital-transformation",target:"digital-adoption",type:"measures",weight:.8},{source:"process-optimization",target:"efficiency",type:"measures",weight:.8},{source:"ai-analytics",target:"automation-rate",type:"measures",weight:.7},{source:"samsung",target:"digital-transformation",type:"requests",weight:.8},{source:"samsung",target:"supply-chain",type:"requests",weight:.7},{source:"hyundai",target:"ai-analytics",type:"requests",weight:.8},{source:"lg",target:"cloud",type:"requests",weight:.7}],Vt={entities:[...Rr,...Tr,...kr,...Mr,...Or],relationships:Nr};function Dr(){const e=Vt.entities.map((a,i)=>({id:a.id,label:a.label,type:a.type,category:a.category,x:i%10*80-400,y:Math.floor(i/10)*80-200,z:i%3*50,color:jr(a.type),aliases:a.aliases||[],metadata:a.metadata||{}})),t=Vt.relationships.map(a=>({source:a.source,target:a.target,type:a.type,strength:a.weight}));return{nodes:e,links:t}}function jr(e){return{organization:"#e74c3c",division:"#c0392b",practice:"#e67e22",industry:"#3498db",client:"#2980b9",capability:"#2ecc71",technology:"#9b59b6",deliverable:"#f39c12",kpi:"#1abc9c",document:"#95a5a6"}[e]||"#34495e"}const D=new za;D.use("/api/*",Wi());D.use("/static/*",er({root:"./public"}));D.use(Ir);D.get("/api/health",e=>e.json({status:"healthy",timestamp:new Date().toISOString()}));let P=[],$=[];const Va=()=>{const{nodes:e,links:t}=Dr();return{seedNodes:e,seedLinks:t}};D.get("/api/ontology/nodes",e=>e.json(P));D.get("/api/ontology/links",e=>e.json($));D.post("/api/ontology/reset",async e=>{const t=await e.req.json().catch(()=>({})),{loadSeed:a=!1}=t;if(a){const{seedNodes:i,seedLinks:r}=Va();return P=[...i],$=[...r],e.json({success:!0,message:"PwC 시드 온톨로지로 리셋되었습니다.",nodeCount:P.length,linkCount:$.length})}else return P=[],$=[],e.json({success:!0,message:"빈 그래프로 리셋되었습니다.",nodeCount:0,linkCount:0})});D.get("/api/ontology/status",e=>{const{seedNodes:t,seedLinks:a}=Va();return e.json({totalNodes:P.length,totalLinks:$.length,seedNodes:t.length,seedLinks:a.length,addedNodes:Math.max(0,P.length-(P.length>0?t.length:0)),addedLinks:Math.max(0,$.length-($.length>0?a.length:0)),categories:{organization:P.filter(i=>i.type==="organization").length,industry:P.filter(i=>i.type==="industry").length,capability:P.filter(i=>i.type==="capability").length,technology:P.filter(i=>i.type==="technology").length,deliverable:P.filter(i=>i.type==="deliverable").length,kpi:P.filter(i=>i.type==="kpi").length,pdf_page:P.filter(i=>i.type==="pdf_page").length,pdf_page_image:P.filter(i=>i.type==="pdf_page_image").length}})});D.post("/api/search",async e=>{const{query:t}=await e.req.json(),a={nodes:[{id:"digital",score:.95},{id:"ai",score:.8},{id:"analytics",score:.7}],path:["digital","analytics","ai"],insights:["Found 3 related capabilities","Strong connection between Digital Services and AI","Recommended next step: Explore AI use cases"]};return e.json(a)});D.post("/api/documents/upload",async e=>{var t;try{const a=await e.req.json(),{fileName:i,fileContent:r,fileSize:s,processingMode:o="unified"}=a,l=i.toLowerCase().endsWith(".pdf");if(l&&o==="unified"){const n=Date.now(),c=await Jt(i,r),d=await Qt(c),h=await Yt(i,s),f=await Zt(i,s),y=[],m=[];d.autoApproved.forEach(g=>{if(g.type==="entity"){const v={id:g.data.id,label:g.data.text,type:g.data.type,category:g.data.category,x:Math.random()*400-200,y:Math.random()*400-200,z:Math.random()*200-100,color:Xt(g.data.type),isNew:!0,confidence:g.data.confidence,source:c.id,processingType:"ontology"};P.push(v),y.push(v)}else if(g.type==="relationship"){const v={source:g.data.source,target:g.data.target,type:g.data.type,strength:g.data.confidence,evidence:g.data.evidence,source_doc:c.id,processingType:"ontology"};$.push(v),m.push(v)}}),h.pageNodes.forEach(g=>{const v={...g,processingType:"pages",isNew:!0};P.push(v),y.push(v)}),f.pageImages.forEach(g=>{const v={...g,processingType:"images",isNew:!0};P.push(v),y.push(v)}),h.pageRelationships.forEach(g=>{const v={source:g.source,target:g.target,type:g.type,strength:g.strength,evidence:g.evidence,processingType:"pages"};$.push(v),m.push(v)}),f.pageRelationships.forEach(g=>{const v={source:g.source,target:g.target,type:g.type,strength:g.strength,evidence:g.evidence,processingType:"images"};$.push(v),m.push(v)});const p=Date.now()-n;return e.json({success:!0,processingMode:"unified",processedDocument:{id:c.id,filename:i,title:h.title||c.title,totalPages:h.totalPages,mainTopics:[...new Set([...h.mainTopics,...f.mainTopics])],summary:`통합 처리: ${h.documentSummary}`,aiKeywordCount:f.aiKeywordCount||0,consultingInsightCount:f.consultingInsightCount||0},ontologyAnalysis:{entities:d.autoApproved.filter(g=>g.type==="entity").length,relationships:d.autoApproved.filter(g=>g.type==="relationship").length,needsReview:d.needsReview.length,processingTime:((t=c.metadata)==null?void 0:t.processingTime)||0},pdfAnalysis:{pages:h.totalPages,pageNodes:h.pageNodes.length,pageRelationships:h.pageRelationships.length,mainTopics:h.mainTopics,processingTime:h.metadata.processingTime},pdfImageAnalysis:{pages:f.totalPages,pageImages:f.pageImages.length,pageRelationships:f.pageRelationships.length,mainTopics:f.mainTopics,processingTime:f.metadata.processingTime},needsReview:{count:d.needsReview.length,topCandidates:d.needsReview.slice(0,5).map(g=>({type:g.type,text:g.data.text||`${g.data.source} → ${g.data.target}`,confidence:g.data.confidence,reason:g.reason}))},newNodes:y,newLinks:m,message:`📊 통합 처리 완료!
🧠 온톨로지: ${d.autoApproved.length}개 엔티티/관계
📄 페이지 텍스트: ${h.totalPages}개 페이지
🖼️ 페이지 이미지: ${f.totalPages}개 이미지
⏱️ 총 처리시간: ${p}ms`,totalProcessingTime:p})}else if(l&&o==="pages"){const n=await Yt(i,s);return n.pageNodes.forEach(c=>{P.push(c)}),n.pageRelationships.forEach(c=>{$.push({source:c.source,target:c.target,type:c.type,strength:c.strength,evidence:c.evidence})}),e.json({success:!0,processingMode:"pages",processedDocument:{id:n.id,filename:n.filename,title:n.title,totalPages:n.totalPages,mainTopics:n.mainTopics,summary:n.documentSummary},pdfAnalysis:{pages:n.totalPages,pageNodes:n.pageNodes.length,pageRelationships:n.pageRelationships.length,mainTopics:n.mainTopics,processingTime:n.metadata.processingTime},newNodes:n.pageNodes.map(c=>({...c,isNew:!0})),newLinks:n.pageRelationships,message:`PDF 페이지별 분석 완료: ${n.totalPages}개 페이지, ${n.pageRelationships.length}개 관계 생성`})}else if(l&&o==="images"){const n=await Zt(i,s);return n.pageImages.forEach(c=>{P.push(c)}),n.pageRelationships.forEach(c=>{$.push({source:c.source,target:c.target,type:c.type,strength:c.strength,evidence:c.evidence})}),e.json({success:!0,processingMode:"images",processedDocument:{id:n.id,filename:n.filename,title:n.title,totalPages:n.totalPages,mainTopics:n.mainTopics,summary:n.documentSummary},pdfImageAnalysis:{pages:n.totalPages,pageImages:n.pageImages.length,pageRelationships:n.pageRelationships.length,mainTopics:n.mainTopics,processingTime:n.metadata.processingTime},newNodes:n.pageImages.map(c=>({...c,isNew:!0})),newLinks:n.pageRelationships,message:`PDF 이미지 변환 완료: ${n.totalPages}개 페이지 이미지, ${n.pageRelationships.length}개 관계 생성`})}else{const n=await Jt(i,r),c=await Qt(n),d=[],h=[];return c.autoApproved.forEach(f=>{if(f.type==="entity"){const y={id:f.data.id,label:f.data.text,type:f.data.type,category:f.data.category,x:Math.random()*400-200,y:Math.random()*400-200,z:Math.random()*200-100,color:Xt(f.data.type),isNew:!0,confidence:f.data.confidence,source:n.id};P.push(y),d.push(y)}else if(f.type==="relationship"){const y={source:f.data.source,target:f.data.target,type:f.data.type,strength:f.data.confidence,evidence:f.data.evidence,source_doc:n.id};$.push(y),h.push(y)}}),e.json({success:!0,processingMode:"ontology",processedDocument:{id:n.id,filename:n.filename,confidence:n.confidence,documentType:n.metadata.documentType,client:n.metadata.client,tags:n.metadata.tags},autoApproved:{entities:c.autoApproved.filter(f=>f.type==="entity").length,relationships:c.autoApproved.filter(f=>f.type==="relationship").length},needsReview:{count:c.needsReview.length,topCandidates:c.needsReview.slice(0,5).map(f=>({type:f.type,text:f.data.text||`${f.data.source} → ${f.data.target}`,confidence:f.data.confidence,reason:f.reason}))},newNodes:d,newLinks:h,message:`문서 처리 완료: ${c.autoApproved.length}개 자동 승인, ${c.needsReview.length}개 검토 필요`})}}catch{return e.json({success:!1,error:"문서 처리 중 오류 발생"},500)}});D.get("/api/pdf/page/:pageId",e=>{const t=e.req.param("pageId"),a=P.find(i=>i.id===t&&i.type==="pdf_page");return a?e.json({page:a,relatedPages:$.filter(i=>i.source===t||i.target===t).map(i=>({relationshipType:i.type,relatedPageId:i.source===t?i.target:i.source,strength:i.strength,evidence:i.evidence}))}):e.json({error:"페이지를 찾을 수 없습니다"},404)});D.get("/api/pdf/document/:docId/pages",e=>{const t=e.req.param("docId"),a=P.filter(i=>i.type==="pdf_page"&&i.documentId===t).sort((i,r)=>i.pageNumber-r.pageNumber);return e.json({documentId:t,totalPages:a.length,pages:a.map(i=>{var r,s;return{id:i.id,pageNumber:i.pageNumber,title:i.title,summary:i.summary,keywords:i.keywords,wordCount:i.wordCount,imageCount:((r=i.images)==null?void 0:r.length)||0,tableCount:((s=i.tables)==null?void 0:s.length)||0}})})});D.get("/api/review/pending",e=>{const t=[{id:"review-1",type:"entity",text:"Quantum Computing",confidence:.65,context:"차세대 컴퓨팅 기술인 Quantum Computing을 활용한...",suggestedType:"technology",reason:"새로운 기술 용어, 확신도 검증 필요"},{id:"review-2",type:"relationship",text:"AI → 자동화율",confidence:.58,evidence:"AI 도입으로 자동화율이 90% 향상되었다",suggestedType:"improves",reason:"관계 강도 불분명"}];return e.json(t)});D.post("/api/review/:id/decision",async e=>{const t=e.req.param("id"),{decision:a,feedback:i}=await e.req.json();return e.json({success:!0,reviewId:t,decision:a,feedback:i,message:a==="approve"?"승인되어 온톨로지에 추가되었습니다":"거절되었습니다",learningUpdate:"피드백이 학습 모델에 반영되어 다음 처리 정확도가 향상됩니다"})});function Xt(e){return{organization:"#e74c3c",division:"#c0392b",practice:"#e67e22",industry:"#3498db",client:"#2980b9",capability:"#2ecc71",technology:"#9b59b6",deliverable:"#f39c12",kpi:"#1abc9c",document:"#95a5a6",pdf_page_image:"#ffffff",ai_keyword:"#e74c3c",consulting_insight:"#f39c12",pdf_page:"#3498db"}[e]||"#34495e"}async function Jt(e,t){return{id:`doc-${Date.now()}`,filename:e,title:"삼성DS S&OP 최적화 프로젝트",confidence:.87,metadata:{documentType:"proposal",client:"samsung",tags:["digital","ai","supply-chain"],uploadTime:new Date().toISOString()},extractedEntities:[{id:"extracted-entity-1",text:"Quantum Computing",type:"technology",category:"discovered",confidence:.65},{id:"extracted-entity-2",text:"Edge Computing",type:"technology",category:"discovered",confidence:.82}],extractedRelationships:[{id:"extracted-rel-1",source:"samsung",target:"extracted-entity-2",type:"adopts",confidence:.78,evidence:"삼성은 Edge Computing 기술을 적극 도입하고 있다"}]}}async function Zt(e,t){const a=Date.now(),i=[{id:`page-img-${Date.now()}-1`,documentId:`pdf-doc-${Date.now()}`,pageNumber:1,imageDataUrl:Re(1),width:1920,height:1080,aspectRatio:1920/1080,type:"pdf_page_image",category:"document_page_image",x:Math.cos(0)*250,y:Math.sin(0)*250,z:0,color:"#ffffff",label:"제안서 표지",pageTitle:"삼성전자 DX SCM 생성형 AI 제안서",isNew:!0,metadata:{pageNumber:1,title:"삼성전자 DX SCM 생성형 AI 기반 SCM 데이터 조회 MVP 구축",extractedText:"삼성전자 DX SCM 생성형 AI 기반 SCM 데이터 조회 MVP 구축 Workflow 기반 활용 방안 수립",wordCount:32,hasTitle:!0,hasImages:!0,hasTables:!1,hasCharts:!1,pageType:"cover",keywords:["삼성전자","DX","SCM","생성형 AI","MVP","Workflow","PwC"],summary:"PwC의 삼성전자 DX SCM 생성형 AI 기반 데이터 조회 서비스 PoC 제안서 표지",aiKeywords:["Generative AI","SCM","Data Analytics","Digital Transformation"],consultingInsights:["PoC 구축","업무 프로세스 최적화","AI 도입 전략","사용성 제고"],fonts:[{family:"Arial",sizes:[24,36,48],usage:1}],colors:[{hex:"#0066cc",rgb:[0,102,204],usage:.4,role:"primary"},{hex:"#2c3e50",rgb:[44,62,80],usage:.4,role:"text"},{hex:"#ffffff",rgb:[255,255,255],usage:.2,role:"background"}],textBlocks:[],images:[{id:"img-1-1",type:"logo",description:"PwC 로고"}],confidence:.98}},{id:`page-img-${Date.now()}-2`,documentId:`pdf-doc-${Date.now()}`,pageNumber:2,imageDataUrl:Re(2),width:1920,height:1080,aspectRatio:1920/1080,type:"pdf_page_image",category:"document_page_image",x:Math.cos(1/5*2*Math.PI)*250,y:Math.sin(1/5*2*Math.PI)*250,z:20,color:"#ffffff",label:"Agenda",pageTitle:"Agenda",isNew:!0,metadata:{pageNumber:2,title:"Agenda",extractedText:"I. 제안 개요 II. 수행 범위 III. 사업 관리 IV. 제안사 소개",wordCount:18,hasTitle:!0,hasImages:!1,hasTables:!1,hasCharts:!1,pageType:"agenda",keywords:["제안개요","수행범위","사업관리","제안사소개","Agenda"],summary:"제안서의 전체 구성과 진행 순서를 나타내는 아젠다 페이지",aiKeywords:["Project Scope","Service Delivery","Implementation"],consultingInsights:["프로젝트 구조화","단계별 접근법","체계적 제안"],fonts:[{family:"Arial",sizes:[16,24,36],usage:1}],colors:[{hex:"#0066cc",rgb:[0,102,204],usage:.4,role:"accent"},{hex:"#2c3e50",rgb:[44,62,80],usage:.5,role:"text"}],confidence:.95}},{id:`page-img-${Date.now()}-3`,documentId:`pdf-doc-${Date.now()}`,pageNumber:3,imageDataUrl:Re(3),width:1920,height:1080,aspectRatio:1920/1080,type:"pdf_page_image",category:"document_page_image",x:Math.cos(2/5*2*Math.PI)*250,y:Math.sin(2/5*2*Math.PI)*250,z:40,color:"#ffffff",label:"프로젝트 추진 목표",pageTitle:"I. 제안 개요 - 프로젝트 추진 목표",isNew:!0,metadata:{pageNumber:3,title:"Gen AI 기반 내/외부 데이터 활용 추진 방향성",extractedText:"Gen AI 기반 내/외부 데이터의 업무 활용을 극대화하여 NSCM 시스템의 사용성 제고를 목표로 함. SCM 통합 AI Orchestrator를 통한 Multi Agent 시스템 구축",wordCount:62,hasTitle:!0,hasImages:!0,hasTables:!1,hasCharts:!0,pageType:"strategy",keywords:["Gen AI","NSCM","AI Orchestrator","Multi Agent","SCM","데이터 활용"],summary:"생성형 AI를 활용한 SCM 데이터 조회 서비스의 핵심 목표와 추진 방향성",aiKeywords:["Generative AI","Multi-Agent System","AI Orchestration","Natural Language Processing"],consultingInsights:["시스템 통합 전략","AI 활용 극대화","사용성 중심 설계","업무 효율성 향상"],fonts:[{family:"Arial",sizes:[16,24,36],usage:1}],colors:[{hex:"#2ecc71",rgb:[46,204,113],usage:.3,role:"accent"},{hex:"#3498db",rgb:[52,152,219],usage:.3,role:"primary"},{hex:"#9b59b6",rgb:[155,89,182],usage:.2,role:"accent"}],confidence:.97}},{id:`page-img-${Date.now()}-4`,documentId:`pdf-doc-${Date.now()}`,pageNumber:4,imageDataUrl:Re(4),width:1920,height:1080,aspectRatio:1920/1080,type:"pdf_page_image",category:"document_page_image",x:Math.cos(3/5*2*Math.PI)*250,y:Math.sin(3/5*2*Math.PI)*250,z:60,color:"#ffffff",label:"구현 계획",pageTitle:"구현 계획",isNew:!0,metadata:{pageNumber:4,title:"구현 계획",extractedText:"3. 구현 계획 Phase 1 데이터 플랫폼 Phase 2 AI 모델 Phase 3 전사 적용",wordCount:52,hasTitle:!0,hasImages:!1,hasTables:!0,hasCharts:!1,pageType:"content",keywords:["구현계획","Phase","데이터플랫폼","AI모델","전사적용"],summary:"3단계 Phase별 구현 계획 및 일정",fonts:[{family:"Arial",sizes:[14,16,24],usage:1}],colors:[{hex:"#f39c12",rgb:[243,156,18],usage:.4,role:"accent"}],confidence:.9}},{id:`page-img-${Date.now()}-5`,documentId:`pdf-doc-${Date.now()}`,pageNumber:5,imageDataUrl:Re(5),width:1920,height:1080,aspectRatio:1920/1080,type:"pdf_page_image",category:"document_page_image",x:Math.cos(4/5*2*Math.PI)*250,y:Math.sin(4/5*2*Math.PI)*250,z:80,color:"#ffffff",label:"기대 효과",pageTitle:"기대 효과",isNew:!0,metadata:{pageNumber:5,title:"기대 효과 및 ROI",extractedText:"4. 기대 효과 ROI 150% 연간 50억원 절감 1년차 120% 2년차 180%",wordCount:42,hasTitle:!0,hasImages:!0,hasTables:!0,hasCharts:!0,pageType:"chart",keywords:["ROI","150%","50억원","절감","기대효과"],summary:"ROI 150% 달성과 연간 50억원 절감 효과 분석",fonts:[{family:"Arial",sizes:[16,24,36],usage:1}],colors:[{hex:"#e74c3c",rgb:[231,76,60],usage:.3,role:"accent"},{hex:"#f39c12",rgb:[243,156,18],usage:.2,role:"accent"},{hex:"#2ecc71",rgb:[46,204,113],usage:.2,role:"accent"}],confidence:.96}}],r=[],s=[];i.forEach((c,d)=>{var f,y;const h=350+d*50;(f=c.metadata.aiKeywords)==null||f.forEach((m,p)=>{const g=(d*2+p*.5)*Math.PI/3;r.push({id:`ai-keyword-${Date.now()}-${d}-${p}`,label:m,type:"ai_keyword",category:"ai_concept",x:Math.cos(g)*h,y:Math.sin(g)*h,z:100+p*20,color:"#e74c3c",size:8,isNew:!0,sourcePageId:c.id,confidence:.9+Math.random()*.1,metadata:{keyword:m,category:"AI Technology",relevance:"High",extractedFrom:c.metadata.title}})}),(y=c.metadata.consultingInsights)==null||y.forEach((m,p)=>{const g=(d*2+p*.7+Math.PI)*Math.PI/3;s.push({id:`consulting-${Date.now()}-${d}-${p}`,label:m,type:"consulting_insight",category:"business_insight",x:Math.cos(g)*(h+80),y:Math.sin(g)*(h+80),z:80+p*25,color:"#f39c12",size:10,isNew:!0,sourcePageId:c.id,confidence:.85+Math.random()*.1,metadata:{insight:m,category:"Business Strategy",impact:"Medium",extractedFrom:c.metadata.title}})})});const o=[...i,...r,...s],l=[];for(let c=0;c<i.length-1;c++)l.push({source:i[c].id,target:i[c+1].id,type:"next_page",strength:1,evidence:"순차적 페이지"});r.forEach(c=>{l.push({source:c.sourcePageId,target:c.id,type:"contains_ai_concept",strength:.8,evidence:"AI 개념 추출"})}),s.forEach(c=>{l.push({source:c.sourcePageId,target:c.id,type:"generates_insight",strength:.7,evidence:"컨설팅 인사이트 도출"})}),i.length>=3&&l.push({source:i[1].id,target:i[2].id,type:"leads_to",strength:.9,evidence:"아젠다 → 제안 개요 연결"});const n=Date.now()-a;return{id:`pdf-doc-${Date.now()}`,filename:e,title:e.replace(".pdf",""),totalPages:i.length,pageImages:o,pageRelationships:l,documentSummary:`삼성전자 DX SCM 생성형 AI 제안서: ${i.length}개 페이지, ${r.length}개 AI 키워드, ${s.length}개 컨설팅 인사이트`,mainTopics:["Gen AI","SCM","Multi Agent","NSCM","AI Orchestrator","Digital Transformation"],aiKeywordCount:r.length,consultingInsightCount:s.length,metadata:{fileSize:t,processingTime:n,createdDate:new Date().toISOString(),aiKeywordCount:r.length,consultingInsightCount:s.length}}}function Re(e){const t={1:`data:image/svg+xml;charset=utf-8,${encodeURIComponent(`
      <svg width="400" height="300" xmlns="http://www.w3.org/2000/svg">
        <rect width="400" height="300" fill="white" stroke="#ddd" stroke-width="2"/>
        <rect x="20" y="20" width="60" height="25" fill="#0066cc"/>
        <text x="50" y="37" fill="white" font-family="Arial" font-size="11" text-anchor="middle" font-weight="bold">PwC</text>
        <rect x="320" y="20" width="60" height="25" fill="#1f4e79"/>
        <text x="350" y="37" fill="white" font-family="Arial" font-size="8" text-anchor="middle">삼성전자</text>
        <text x="200" y="80" fill="#0066cc" font-family="Arial" font-size="14" text-anchor="middle" font-weight="bold">추가 Proposal</text>
        <text x="200" y="130" fill="#2c3e50" font-family="Arial" font-size="12" text-anchor="middle" font-weight="bold">삼성전자 DX SCM</text>
        <text x="200" y="150" fill="#2c3e50" font-family="Arial" font-size="12" text-anchor="middle" font-weight="bold">생성형 AI 기반 SCM 데이터 조회</text>
        <text x="200" y="170" fill="#2c3e50" font-family="Arial" font-size="12" text-anchor="middle" font-weight="bold">MVP 구축 Workflow</text>
        <text x="200" y="210" fill="#e74c3c" font-family="Arial" font-size="10" text-anchor="middle">Confidential</text>
        <text x="200" y="260" fill="#7f8c8d" font-family="Arial" font-size="12" text-anchor="middle">2025.2</text>
      </svg>
    `)}`,2:`data:image/svg+xml;charset=utf-8,${encodeURIComponent(`
      <svg width="400" height="300" xmlns="http://www.w3.org/2000/svg">
        <rect width="400" height="300" fill="white" stroke="#ddd" stroke-width="2"/>
        <text x="200" y="40" fill="#0066cc" font-family="Arial" font-size="18" text-anchor="middle" font-weight="bold">Agenda</text>
        <line x1="50" y1="60" x2="350" y2="60" stroke="#0066cc" stroke-width="2"/>
        <circle cx="30" cy="90" r="4" fill="#2c3e50"/>
        <text x="50" y="95" fill="#2c3e50" font-family="Arial" font-size="14" font-weight="bold">I. 제안 개요</text>
        <circle cx="30" cy="130" r="4" fill="#2c3e50"/>
        <text x="50" y="135" fill="#2c3e50" font-family="Arial" font-size="14" font-weight="bold">II. 수행 범위</text>
        <circle cx="30" cy="170" r="4" fill="#2c3e50"/>
        <text x="50" y="175" fill="#2c3e50" font-family="Arial" font-size="14" font-weight="bold">III. 사업 관리</text>
        <circle cx="30" cy="210" r="4" fill="#2c3e50"/>
        <text x="50" y="215" fill="#2c3e50" font-family="Arial" font-size="14" font-weight="bold">IV. 제안사 소개</text>
        <rect x="300" y="250" width="80" height="30" fill="#0066cc" opacity="0.1"/>
        <text x="340" y="270" fill="#0066cc" font-family="Arial" font-size="10" text-anchor="middle">Structure</text>
      </svg>
    `)}`,3:`data:image/svg+xml;charset=utf-8,${encodeURIComponent(`
      <svg width="400" height="300" xmlns="http://www.w3.org/2000/svg">
        <rect width="400" height="300" fill="white" stroke="#ddd" stroke-width="2"/>
        <text x="20" y="30" fill="#0066cc" font-family="Arial" font-size="12" font-weight="bold">I. 제안 개요</text>
        <text x="20" y="50" fill="#2c3e50" font-family="Arial" font-size="14" font-weight="bold">프로젝트 추진 목표</text>
        <rect x="20" y="60" width="360" height="50" fill="#e8f4f8" stroke="#0066cc" stroke-width="1"/>
        <text x="200" y="80" fill="#2c3e50" font-family="Arial" font-size="10" text-anchor="middle">Gen AI 기반 내/외부 데이터의 업무 활용을 극대화하여</text>
        <text x="200" y="95" fill="#2c3e50" font-family="Arial" font-size="10" text-anchor="middle">NSCM 시스템의 사용성 제고를 목표로 함</text>
        <rect x="50" y="130" width="80" height="40" fill="#2ecc71" rx="5"/>
        <text x="90" y="145" fill="white" font-family="Arial" font-size="8" text-anchor="middle">내부 정형</text>
        <text x="90" y="157" fill="white" font-family="Arial" font-size="8" text-anchor="middle">Data Agent</text>
        <rect x="160" y="130" width="80" height="40" fill="#e74c3c" rx="5"/>
        <text x="200" y="145" fill="white" font-family="Arial" font-size="8" text-anchor="middle">외부 비정형</text>
        <text x="200" y="157" fill="white" font-family="Arial" font-size="8" text-anchor="middle">Data Agent</text>
        <rect x="270" y="130" width="80" height="40" fill="#9b59b6" rx="5"/>
        <text x="310" y="145" fill="white" font-family="Arial" font-size="8" text-anchor="middle">SCM Workflow</text>
        <text x="310" y="157" fill="white" font-family="Arial" font-size="8" text-anchor="middle">업무 Agent</text>
        <rect x="120" y="200" width="160" height="30" fill="#f39c12" rx="5"/>
        <text x="200" y="218" fill="white" font-family="Arial" font-size="10" text-anchor="middle" font-weight="bold">SCM 통합 AI Orchestrator</text>
        <text x="200" y="250" fill="#7f8c8d" font-family="Arial" font-size="8" text-anchor="middle">Multi Agent System</text>
      </svg>
    `)}`,4:`data:image/svg+xml;charset=utf-8,${encodeURIComponent(`
      <svg width="400" height="300" xmlns="http://www.w3.org/2000/svg">
        <rect width="400" height="300" fill="white" stroke="#ddd" stroke-width="2"/>
        <text x="20" y="40" fill="#2c3e50" font-family="Arial" font-size="16" font-weight="bold">3. 구현 계획</text>
        <line x1="50" y1="120" x2="350" y2="120" stroke="#f39c12" stroke-width="3"/>
        <circle cx="100" cy="120" r="8" fill="#f39c12"/>
        <circle cx="200" cy="120" r="8" fill="#f39c12"/>
        <circle cx="300" cy="120" r="8" fill="#f39c12"/>
        <text x="85" y="140" fill="#2c3e50" font-family="Arial" font-size="10">Phase 1</text>
        <text x="185" y="140" fill="#2c3e50" font-family="Arial" font-size="10">Phase 2</text>
        <text x="285" y="140" fill="#2c3e50" font-family="Arial" font-size="10">Phase 3</text>
        <text x="75" y="155" fill="#7f8c8d" font-family="Arial" font-size="8">1-3개월</text>
        <text x="175" y="155" fill="#7f8c8d" font-family="Arial" font-size="8">4-6개월</text>
        <text x="275" y="155" fill="#7f8c8d" font-family="Arial" font-size="8">7-9개월</text>
      </svg>
    `)}`,5:`data:image/svg+xml;charset=utf-8,${encodeURIComponent(`
      <svg width="400" height="300" xmlns="http://www.w3.org/2000/svg">
        <rect width="400" height="300" fill="white" stroke="#ddd" stroke-width="2"/>
        <text x="20" y="40" fill="#2c3e50" font-family="Arial" font-size="16" font-weight="bold">4. 기대 효과</text>
        <rect x="50" y="140" width="40" height="60" fill="#e74c3c"/>
        <rect x="130" y="120" width="40" height="80" fill="#f39c12"/>
        <rect x="210" y="100" width="40" height="100" fill="#2ecc71"/>
        <text x="65" y="215" fill="#2c3e50" font-family="Arial" font-size="10" text-anchor="middle">1년차</text>
        <text x="145" y="215" fill="#2c3e50" font-family="Arial" font-size="10" text-anchor="middle">2년차</text>
        <text x="225" y="215" fill="#2c3e50" font-family="Arial" font-size="10" text-anchor="middle">3년차</text>
        <text x="280" y="80" fill="#2c3e50" font-family="Arial" font-size="14" font-weight="bold">ROI: 150%</text>
        <text x="280" y="100" fill="#2c3e50" font-family="Arial" font-size="12">연간 50억원 절감</text>
      </svg>
    `)}`};return t[e]||t[1]}async function Yt(e,t){const a=Date.now(),i=[{id:`page-${Date.now()}-1`,documentId:`pdf-doc-${Date.now()}`,documentTitle:e.replace(".pdf",""),pageNumber:1,title:"삼성DS 사업부 S&OP 최적화 프로젝트 제안서",content:"Executive Summary 내용...",summary:"삼성 DS 사업부의 S&OP 프로세스 최적화를 통한 운영 효율성 증대 방안 제시",keywords:["삼성","DS","S&OP","최적화","Executive Summary"],images:[{id:"img-1-1",description:"PwC 로고",type:"logo"}],tables:[],type:"pdf_page",category:"document_page",x:Math.cos(0)*200,y:Math.sin(0)*200,z:0,color:"#e74c3c",wordCount:89,confidence:.9},{id:`page-${Date.now()}-2`,documentId:`pdf-doc-${Date.now()}`,documentTitle:e.replace(".pdf",""),pageNumber:2,title:"1. 현황 분석",content:"AS-IS 프로세스 분석 및 벤치마킹...",summary:"현재 S&OP 프로세스의 한계점 분석 및 글로벌 벤치마킹 결과",keywords:["현황분석","AS-IS","벤치마킹","한계점","프로세스"],images:[{id:"img-2-1",description:"AS-IS vs TO-BE 비교 차트",type:"chart"}],tables:[{id:"table-2-1",headers:["구분","AS-IS","TO-BE"],rows:[]}],type:"pdf_page",category:"document_page",x:Math.cos(1/5*2*Math.PI)*200,y:Math.sin(1/5*2*Math.PI)*200,z:20,color:"#3498db",wordCount:156,confidence:.9},{id:`page-${Date.now()}-3`,documentId:`pdf-doc-${Date.now()}`,documentTitle:e.replace(".pdf",""),pageNumber:3,title:"2. 제안 솔루션",content:"AI 기반 수요 예측 모델 및 Palantir 플랫폼...",summary:"AI 기반 수요 예측과 Palantir Foundry를 활용한 통합 플랫폼 솔루션",keywords:["AI","예측모델","Palantir","Foundry","솔루션"],images:[{id:"img-3-1",description:"AI 모델 아키텍처",type:"diagram"}],tables:[],type:"pdf_page",category:"document_page",x:Math.cos(2/5*2*Math.PI)*200,y:Math.sin(2/5*2*Math.PI)*200,z:40,color:"#2ecc71",wordCount:134,confidence:.9},{id:`page-${Date.now()}-4`,documentId:`pdf-doc-${Date.now()}`,documentTitle:e.replace(".pdf",""),pageNumber:4,title:"3. 구현 계획 및 일정",content:"3단계 Phase별 구현 계획...",summary:"데이터 플랫폼 구축부터 전사 적용까지 3단계 구현 로드맵",keywords:["구현계획","Phase","일정","로드맵","적용"],images:[],tables:[{id:"table-4-1",headers:["Phase","기간","주요활동"],rows:[]}],type:"pdf_page",category:"document_page",x:Math.cos(3/5*2*Math.PI)*200,y:Math.sin(3/5*2*Math.PI)*200,z:60,color:"#f39c12",wordCount:178,confidence:.9},{id:`page-${Date.now()}-5`,documentId:`pdf-doc-${Date.now()}`,documentTitle:e.replace(".pdf",""),pageNumber:5,title:"4. 기대 효과 및 ROI",content:"연간 50억원 비용 절감, ROI 150%...",summary:"정량적/정성적 효과 분석 및 3년간 ROI 150% 달성 계획",keywords:["ROI","비용절감","50억원","150%","기대효과"],images:[{id:"img-5-1",description:"ROI 추이 그래프",type:"chart"}],tables:[{id:"table-5-1",headers:["구분","1년차","2년차","3년차"],rows:[]}],type:"pdf_page",category:"document_page",x:Math.cos(4/5*2*Math.PI)*200,y:Math.sin(4/5*2*Math.PI)*200,z:80,color:"#9b59b6",wordCount:145,confidence:.9}],r=[];for(let o=0;o<i.length-1;o++)r.push({source:i[o].id,target:i[o+1].id,type:"next_page",strength:1,evidence:"순차적 페이지"});r.push({source:i[1].id,target:i[2].id,type:"similar_topic",strength:.8,evidence:"현황 분석 → 솔루션 연결"}),r.push({source:i[2].id,target:i[4].id,type:"similar_topic",strength:.7,evidence:"솔루션 → 효과 연결"});const s=Date.now()-a;return{id:`pdf-doc-${Date.now()}`,filename:e,title:e.replace(".pdf",""),totalPages:i.length,pageNodes:i,pageRelationships:r,documentSummary:`${i.length}페이지 제안서: S&OP 최적화를 통한 연간 50억원 절감 및 ROI 150% 달성 계획`,mainTopics:["S&OP","AI","Palantir","ROI","최적화"],metadata:{fileSize:t,processingTime:s,createdDate:new Date().toISOString()}}}async function Qt(e){const t=e.extractedEntities.filter(r=>r.confidence>=.75).map(r=>({type:"entity",data:r})),a=e.extractedRelationships.filter(r=>r.confidence>=.75).map(r=>({type:"relationship",data:r})),i=[...e.extractedEntities.filter(r=>r.confidence<.75&&r.confidence>=.5),...e.extractedRelationships.filter(r=>r.confidence<.75&&r.confidence>=.5)].map(r=>({type:r.source?"relationship":"entity",data:r,reason:`신뢰도 ${r.confidence.toFixed(2)} - 검토 필요`}));return{autoApproved:[...t,...a],needsReview:i,rejected:[]}}D.get("/",e=>e.render(k("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900",children:k("div",{id:"root"})})));const ea=new za,$r=Object.assign({"/src/index.tsx":D});let Xa=!1;for(const[,e]of Object.entries($r))e&&(ea.all("*",t=>{let a;try{a=t.executionCtx}catch{}return e.fetch(t.req.raw,t.env,a)}),ea.notFound(t=>{let a;try{a=t.executionCtx}catch{}return e.fetch(t.req.raw,t.env,a)}),Xa=!0);if(!Xa)throw new Error("Can't import modules from ['/src/index.ts','/src/index.tsx','/app/server.ts']");export{ea as default};
